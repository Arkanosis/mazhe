% This is part of Mes notes de mathématique
% Copyright (c) 2011-2013
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

Ici nous utilisons la convention de la transformée de Fourier de \wikipedia{fr}{Transformée_de_Fourier}{wikipedia}, c'est à dire
\begin{subequations}
    \begin{align}
        \hat f(\xi)&=\int_{\eR} e^{-i\xi x}f(x)dx\\
        f(x)&=2\pi\int_{\eR} e^{i\xi x}\hat f(\xi)d\xi.
    \end{align}
\end{subequations}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Espace de Schwartz}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour un multiindice \( \alpha=(\alpha_1,\ldots, \alpha_d)\in \eN^d\), nous notons
\begin{equation}
    \partial^{\alpha}\varphi=\partial_{x_1}^{\alpha_1}\ldots\partial_{x_d}^{\alpha_d}\varphi
\end{equation}
pour peu que la fonction \( \varphi\) soit \( | \alpha |=\alpha_1+\ldots +\alpha_d\) fois dérivable.

\begin{definition}  \label{DefHHyQooK}
    Soit \( \Omega\subset\eR^d\). L'\defe{espace de Schwartz}{espace!de Schwartz} \( \swS(\Omega)\) est le sous-ensemble de \(  C^{\infty}(\Omega)\) des fonctions dont toutes les dérivées décroissent plus vite que tout polynôme :
    \begin{equation}
        \swS(\Omega)=\big\{   \varphi\in C^{\infty}(\Omega)\tq\forall \alpha,\beta\in \eN^d, p_{\alpha,\beta}(\varphi)<\infty   \big\}
    \end{equation}
    où nous avons considéré
    \begin{equation}    \label{EqOWdChCu}
        p_{\alpha,\beta}(\varphi)=\sup_{x\in \Omega}| x^{\beta}(\partial^{\alpha}\varphi)(x) |=\| x^{\beta}\partial^{\alpha}\varphi \|_{\infty}.
    \end{equation}
    Une fonction \( \varphi\in\swS(\Omega)\) est dite à \defe{décroissance rapide}{fonction!à décroissance rapide}.
\end{definition}

Pour simplifier les notations (surtout du côté de Fourier), nous allons parfois écrire \( M_i\varphi\)\nomenclature[Y]{\( M_i\varphi\)}{La fonction \( x\mapsto x_i\varphi(x)\)} pour la fonction \( x\mapsto x_i\varphi(x)\).

\begin{example}
    La fonction \(  e^{-x^2}\) est une fonction à décroissance rapide sur \( \eR\).
\end{example}

\begin{proposition} \label{PropCSmzwGv}
    Une fonction à décroissance rapide décroît plus vite que n'importe quel polynôme\footnote{D'où le nom des fonctions à décroissance rapide.}. Plus précisément, si \( \varphi\in\swS(\eR^d)\), pour tout polynôme \( Q\), il existe un \( r>0\) tel que \(  | \varphi(x) |<\frac{1}{ | Q(x) | } \) pour tout \( \| x \|\geq r\).
\end{proposition}

\begin{proof}
    Nous commençons par considérer un polynôme \( P\) donné par
    \begin{equation}
        P(x)=\sum_kc_kx^{\beta_k}
    \end{equation}
    où les \( \beta_k\) sont des multiindices, les \( c_k\) sont des constantes et la somme est finie. Nous avons la majoration
    \begin{equation}
        \sup_{x\in \eR^d}| \varphi(x)P(x) |\leq\sum_k\sup_x\big| c_k\varphi(x) x^{\beta_k} \big|\leq\sum_k| c_k |p_{0,\beta_k}(\varphi)<\infty.
    \end{equation}
    Nous allons noter \( M_P\) la constante \( \sum_k| c_k |p_{0,\beta_k}(\varphi)\), de sorte que pour tout \( x\in \eR^d\) nous ayons \( | \varphi(x)P(x) |\leq M_P\) et donc
    \begin{equation}
        | \varphi(x) |\leq \frac{ M_P }{ | P(x) | }=\frac{1}{ | \frac{1}{ M_P }P(x) | }.
    \end{equation}
    Notons que cette inégalité est a fortiori correcte pour les \( x\) sur lesquels \( P\) s'annule.

    Soit maintenant un polynôme \( Q\). Nous considérons le polynôme \( P(x)=\| x \|Q(x)\). Étant de plus haut degré, pour toute constante \( C\) il existe un rayon \( r_C\) tel que \( | P(x) |\geq C| Q(x) |\) pour tout \( | x |\geq r_C\). En particulier pour \( | x |\geq r_{M_P}\) nous avons
    \begin{equation}
        | P(x) |\geq M_P| Q(x) |
    \end{equation}
    et donc, pour ces \( x\), 
    \begin{equation}
        | \varphi(x) |\leq \frac{1}{ | \frac{1}{ M_P }P(x) | }\leq \frac{1}{ | Q(x) | }.
    \end{equation}
    La première inégalité est valable pour tout \( x\), et la seconde pour \( \| x \|\geq r_{M_P}\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Produit de convolution}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[\cite{CXCQJIt}]
    Si \( \varphi\in L^1(\eR)\) et \( \psi\in\swS(\eR)\), alors \( \varphi * \psi\in \swS(\eR)\).
\end{proposition}

\begin{proof}
    Nous devons prouver que
    \begin{equation}
        p_{\alpha,\beta}(\varphi*\psi)=\sup_{x\in \eR^d}| x^{\beta}(\partial^{\alpha}(\varphi*\psi))(x) |
    \end{equation}
    est borné pour tout multiindices \( \alpha\) et \( \beta\). En appliquant \( | \alpha |\) fois la proposition \ref{PropHNbdMQe}, nous mettons toutes les dérivées sur \( \psi\) : \( \partial^{\alpha}(\varphi*\psi)=(\varphi*\partial^{\alpha}\psi)\). Cela étant fait, nous majorons
    \begin{subequations}
        \begin{align}
            \big| x^{\beta}(\varphi*\partial^{\alpha}\psi)(x) \big|&\leq| x^{\beta} |\int_{\eR^d} |\varphi(y)|\underbrace{\big| (\partial^{\alpha}\psi)(x-y)\big|}_{\leq\| \partial^{\alpha}\psi \|_{\infty}} dy \big|\\
            &\leq | x^{\beta} |  \| \partial^{\alpha}\psi \|_{\infty}\int_{\eR^d}| \varphi(y) |dy\\
            &\leq p_{\alpha,\beta}(\psi)\| \varphi \|_{_{L^1}}.
        \end{align}
    \end{subequations}
    Par conséquent, \( p_{\alpha,\beta}(\varphi*\psi)\leq \| \varphi \|_{L^1}p_{\alpha,\beta}(\psi)<\infty\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Topologie}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}
    Les \( p_{\alpha,\beta}\) donnés par l'équation \eqref{EqOWdChCu} ci-dessus sont des semi-normes\footnote{Définition \ref{DefPNXlwmi}.}.
\end{lemma}
%TODO : une preuve pour égayer la galerie.

\begin{lemma}[\cite{OEVAuEz}]   \label{LemRJhCbkO}
    La topologie sur \( \swS(\eR^d)\) est donnée aussi par les semi-normes
    \begin{equation}
        q_{n,m}=\max_{| \alpha |\leq n}\sup_{x\in \eR^d}\big( 1+\| x \| \big)^m\big| \partial^{\alpha}\varphi(x) \big|.
    \end{equation}
    Autrement dit, une suite \( \varphi_n\stackrel{\swS(\eR^d)}{\to}0\) si et seulement si \( q_{n,m(\varphi)}\to 0\) pour tout \( n\) et \( m\).
\end{lemma}
Le fait que les \( q_{n,m}(\varphi)\) restent bornés est la proposition \ref{PropCSmzwGv}. Cependant ce lemme est plus précis parce qu'en disant seulement que \( \varphi\) est majoré par des polynôme, nous ne disons pas que les polynômes correspondants aux \( \varphi_n\) tendent vers zéro si \( \varphi_n\stackrel{\swS}{\to}0\). Et d'ailleurs on ne sait pas très bien ce que signifierait \( P_n\to 0\) pour une suite de polynômes.

\begin{proposition}     \label{PropGNXBeME}
    Pour \( p\in\mathopen[ 1 , \infty \mathclose]\), l'espace \( \swS(\eR^d)\) s'injecte continument dans \( L^p(\eR^d)\). 
\end{proposition}

\begin{proof}
    L'injection dont nous parlons est l'identité ou plus précisément l'identité suivie de la prise de classe. Il faut vérifier que cela est correct et continu, c'est à dire d'abord qu'une fonction à décroissance rapide est bien dans \( L^p\) et ensuite que si \( f_n\stackrel{\swS}{\to}0\), alors \( f_n\stackrel{L^p}{\to}0\).
    
    Commençons par \( p=\infty\). Alors \( \| f_n \|_{\infty}=p_{0,0}(f_n)\to 0\) parce que si \( f_n\stackrel{\swS}{\to}0\), alors en particulier \( p_{0,0}(f_n)\to 0\).

    Au tour de \( p<\infty\) maintenant. Nous savons qu'en dimension \( d\), la fonction
    \begin{equation}
        x\mapsto \frac{1}{ (1+\| x \|)^s }
    \end{equation}
    est intégrable dès que \( s>d\).
    %TODO : il faudrait une petite preuve de ça.
    Pour toute valeur de \( m\) nous avons
    \begin{equation}
        \| \varphi \|_p^p=\int_{\eR^d}| \varphi(x) |^pdx=\int_{\eR^d}\frac{ \big|    (1+\| x \|)^m\varphi(x)   \big|^p }{ \big( 1+\| x \| \big)^{mp} }\leq\int_{\eR^d}\frac{q_{0,m}(\varphi)^p}{ \big( 1+\| x \| \big)^{mp} }.
    \end{equation}
    En choisissant \( m\) de telle sorte que \( mp>d\), nous avons convergence de l'intégrale et donc \( \| \varphi \|_p<\infty\). Nous retenons que
    \begin{equation}    \label{EqVWfEFMk}
        \| \varphi \|_p^p\leq Cq_{0,m}(\varphi)^p
    \end{equation}
    pour une certaine constance \( C\) et un bon choix de \( m\).

    Ceci prouve que \( \swS(\eR^d)\subset L^p(\eR^d)\). Nous devons encore vérifier que l'inclusion est continue. Si \( \varphi_n\stackrel{\swS}{\to}0\), alors en particulier nous avons \( q_{0,m}(\varphi_n)\to 0\) par le lemme \ref{LemRJhCbkO}. Par conséquent la majoration \eqref{EqVWfEFMk} nous dit que \( \| \varphi_n \|_p\to 0\) également.

\end{proof}
En résumé, si \( \varphi_n\stackrel{\swS(\eR^d)}{\to}\varphi\) alors \( \varphi_n\stackrel{L^p}{\to}\varphi\).

%Ceci est supprimé le 24 octobre 2013 parce que la définition de S est déjà ailleurs.

%L'\defe{espace de Schwartz}{Schwartz!espace}\index{espace!de Schwartz} \( \swS(\eR^n,\eC)\)\nomenclature[Y]{\( \swS(\eR^n,\eC)\)}{fonctions Schwartz} est l'ensemble des fonctions dont toutes les dérivées décroissent plus vite que l'inverse de tout polynôme, c'est à dire
%\begin{equation}
%    \swS(\eR^n,\eC)=\{ f\in C^{\infty}(\eR^n,\eC)\tq \forall \alpha,\beta\in \eN^n,\sup_{x\in \eR^n}\big| (x)^{\alpha}D^{\beta}f(x) \big|<\infty \}
%\end{equation}
%où nous utilisons les notations \( x^{\alpha}=(x_1)^{\alpha_1}\ldots (x_n)^{\alpha_n}\) et \( D^{\beta}=\frac{ \partial^n  }{ \partial \beta_1\ldots\partial \beta_n }\).

\begin{theorem}[\cite{MesIntProbb}]      \label{ThoRWEoqY}
    Soit \( \mu\) une mesure sur les boréliens de \( \eR^n\) finie sur les compacts. Alors \( \swD(\eR^n)\) est dense dans \( L^1(\eR^n,\Borelien(\eR^n),\mu)\).
\end{theorem}
\index{densité!de \( \swD(\eR^n)\) dans \( L^1(\eR^n)\)}

\begin{proposition}     \label{PropfqvLOl}
    La transformée de Fourier est un morphisme vis-à-vis de la convolution\index{produit!de convolution!et Fourier} sur \( L^1(\eR^n)\) :
    \begin{equation}
        \widehat{f*g}=\hat f\hat g.
    \end{equation}
\end{proposition}

\begin{proof}
    Nous devons étudier l'intégrale
    \begin{equation}
        \widehat{f*g}(\xi)=\int_{\eR}\left[ \int_{\eR} f(y)g(t-y)\right] e^{-it\xi} dt.
    \end{equation}
    Ici nous avons choisit des représentants \( f\) et \( g\) dans les classes de \( L^1\). Montrons que \( f\) est borélienne. D'abord \( f(x)=f_+(x)-f_-(x)\) où \( f_+\) et \( f_-\) sont des fonctions positives. Afin d'alléger les notations nous supposons un instant que \( f\) est positive et nous posons
    \begin{equation}
        f_n(x)=\sum_{k=1}^{2^n} \frac{ k }{ n }\mtu_{f(x)\in\mathopen[ \frac{ k }{ n } , \frac{ k+1 }{ n } [}.
    \end{equation}
    Le fait que \( f\) soit dans \( L^1\) implique que chacune des fonctions \( f_n\) est borélienne et donc que \( f\) l'est aussi en tant que limite ponctuelle de fonctions boréliennes\footnote{Le fait que \( f\) soit borélienne est une conséquence du théorème \ref{ThoRWEoqY}.}.
    
    Nous allons appliquer le théorème de Fubini \ref{CorTKZKwP} à la fonction
    \begin{equation}
        \phi(x,y)=f(x)g(y) e^{-i\xi(x+y)}
    \end{equation}
    qui est borélienne en tant que produit et composé de fonctions boréliennes. Nous avons
    \begin{subequations}
        \begin{align}
            \int_{\eR}\left( \int_{\eR}| f(x) e^{-i\xi x} | |g(y) e^{-i\xi y} |dy \right)dx&=\int_{\eR}\left( | f(x) |\int_{\eR}| g(y) |dy \right)dx\\
            &=\int_{\eR}| f(x) |\| g \|_1\\
            &=\| f \|_1\| g \|_1<\infty.
        \end{align}
    \end{subequations}
    Le théorème est donc applicable. D'abord nous avons :
    \begin{subequations}
        \begin{align}
            \hat f(\xi)\hat g(\xi)&=\left(\int_{\eR}f(x) e^{-i\xi x}dx\right)\left(\int_{\eR}g(y) e^{-i\xi y}dy\right)\\
            &=\int_{\eR}\left( \int_{\eR}f(x)g(y) e^{-i\xi(x+y)}dy \right)dx\\
            &=\int_{\eR}\left( \int_{\eR}f(x)g(t-x) e^{-i\xi t} \right)dx.
        \end{align}
    \end{subequations}
    Jusqu'ici nous n'avons pas utilisé Fubini. Nous avons seulement introduit le nombre \( \int_{\eR}g(y) e^{-i\xi y}dy\) dans l'intégrale par rapport à \( x\) et effectué le changement de variables \( y\mapsto t=x+y\). Maintenant nous appliquons le théorème de Fubini pour inverser l'ordre des intégrales :
    \begin{subequations}
        \begin{align}
            \hat f(\xi)\hat g(\xi)&=\int_{\eR}\left( \int_{\eR}f(x)g(t-x) e^{-it\xi}dx \right)dy\\
            &=\int_{\eR} e^{-it\xi}\left( \int_{\eR}f(x)g(t-x)dx \right)dt\\
            &=\int_{\eR} e^{-it\xi}(f*g)(t)dt\\
            &=\widehat{f*g}(\xi).
        \end{align}
    \end{subequations}
\end{proof}

\begin{proposition}       \label{PropJvNfj}
    Soit une fonction \( f\in L^1(\eR^d)\). Alors sa transformée de Fourier est continue\index{transformée!de Fourier!continuité}.
\end{proposition}

\begin{proof}
    Nous considérons une fonction \( f\) définie sur \( \eR^d\) et à valeurs dans \( \eR\) ou \( \eC\). Sa transformée de Fourier est donnée par
    \begin{equation}
        \hat f(\xi)=\int_{\eR^d} e^{-i\xi x}f(x)dx.
    \end{equation}
    Pour montrer que cette fonction \( \hat f\) est continue en \( \xi_0\) nous considérons une suite \( (\xi_n)\to \xi_0\) et nous voulons montrer que \( \hat f(\xi_n)\to\hat f(\xi_0)\). Pour cela nous considérons les fonctions
\begin{equation}
    g_n(x)= e^{-i\xi_nx}f(x)
\end{equation}
qui convergent simplement vers \( g(x)= e^{-i\xi x}f(x)\). Étant donné que
\begin{equation}
    | g_n(x) |<| f(x) |,
\end{equation}
le théorème de la convergence dominée donne alors
\begin{equation}
    \lim_{n\to \infty} \int g_n(x)=\int\lim_{n\to \infty } g_n(x),
\end{equation}
c'est à dire \( \lim_{n\to \infty} \hat f(\xi_n)=\hat f(\xi)\). La fonction \( \hat f\) est donc continue.
\end{proof}

\begin{lemma}
    Soit \( f\in L^1(\eR)\). Alors \( \| \hat f \|_{\infty}\leq \| f \|_1\).
\end{lemma}

\begin{proof}
    Cela est un simple calcul : étant donné que
    \begin{equation}
        \hat f(\xi)=\int_{\eR}f(x) e^{-ix\xi}dx,
    \end{equation}
    nous avons, pour tout \( \xi\),
    \begin{equation}
        | \hat f(\xi) |\leq\int_{\eR}| f(x) |dx,
    \end{equation}
    ce qui signifie exactement \( \| \hat f \|_{\infty}\leq \| f \|_1\).
\end{proof}

\begin{lemma}[Lemme de Riemann-Lebesgue\cite{MaureyHilbertFourier}]     \label{LesmRLaxXkQV}
    Si \( f\) est une fonction \( L^1(\eR)\) alors \( \lim_{\xi\to\pm\infty} \hat f(\xi)=0\).
\end{lemma}

\begin{proof}
    Nous commençons par prouver le résultat dans le cas d'une fonction \( g\) en escalier, et plus précisément par une fonction caractéristique d'un compact \( K=\mathopen[ a , b \mathclose]\). Au niveau de la transformée de Fourier nous avons
    \begin{equation}
        \hat\mtu_{K}(\xi)=\int_a^b e^{-i\xi x}dx=-\frac{1}{ i\xi }( e^{-ib\xi}- e^{-ia\xi}).
    \end{equation}
    Par conséquent
    \begin{equation}
        | \hat\mtu_K(\xi) |\leq \frac{ 2 }{ | \xi | }.
    \end{equation}
    Plus généralement si \( g=\sum_{i=1}^Nc_i\mtu_{K_i}\), alors
    \begin{equation}
        | \hat g(\xi) |\leq \frac{ 2 }{ | \xi | }\sum_{i=1}^N| c_i |,
    \end{equation}
    et donc nous avons effectivement \( \lim_{\xi\to\pm\infty}| \hat g(\xi) |=0\).

    Nous passons maintenant au cas général \( f\in L^1(\eR)\). Étant donné que les fonctions \( L^1\) en escalier sont denses dans \( L^1\), nous considérons une fonction \( g\in L^1(\eR)\) en escalier telle que \( \| f-g \|_1<\epsilon\). Nous avons donc
    \begin{equation}
        \| \hat f-\hat g \|_{\infty}\leq \| f-g \|_1<\epsilon.
    \end{equation}
    Donc
    \begin{equation}
        \| \hat f(\xi) \|\leq \| \hat f(\xi)-\hat g(\xi) \|_| \hat g(\xi) |.
    \end{equation}
    Le premier terme est plus petit que \( \epsilon\). Il nous reste à voir que 
    \begin{equation}
        \lim_{\xi\to \infty} | \hat g(\xi) |=0,
    \end{equation}
    mais cela est le résultat de la première partie de la preuve.    
\end{proof}

\begin{corollary}
    La transformée de Fourier d'une fonction \( L^1(\eR)\) est bornée.
\end{corollary}

\begin{proof}
    Par le corollaire \ref{PropJvNfj}, la transformée de Fourier d'une fonction \( L^1\) est continue. Le lemme de Riemann-Lebesgue \ref{LesmRLaxXkQV} impliquant qu'elle tend vers zéro en \( \pm\infty\), elle doit être bornée.    
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Transformée de Fourier d'une fonction Schwartz}
%---------------------------------------------------------------------------------------------------------------------------

La définition de la transformée de Fourier de \( \varphi\in\swS(\eR^d)\) est 
\begin{equation}
    \hat  \varphi(\xi)=\int_{\eR^n}\varphi(x) e^{-ix\cdot \xi}.
\end{equation}

\begin{lemma}   \label{LemQPVQjCx}
    Si \( \varphi\in\swS(\eR^d)\) et si \( \alpha\) est un multiindice, alors
    \begin{equation}
        \partial^{\alpha}\hat\varphi=(-i)^{| \alpha |}\widehat{M_{\alpha}\varphi}.
    \end{equation}
    et
    \begin{equation}
        \widehat{\partial^{\alpha}\varphi}(\xi)=(-i)^{| \alpha |}\xi^{\alpha}\hat\varphi(\xi).
    \end{equation}
\end{lemma}

\begin{proof}
    Nous considérons la fonction \( h(x,\xi)=\varphi(x) e^{-ix\cdot \xi}\) dont la dérivée par rapport à \( \xi_i\) est donnée par \( -i(M_{i}\varphi)(x) e^{x\cdot \xi}\). Cette fonction est majorée en norme par
    \begin{equation}
        G(x)=M_i\varphi(x),
    \end{equation}
    qui est encore une fonction à décroissance rapide et donc parfaitement intégrable sur \( \eR^d\). Le théorème \ref{ThoMWpRKYp} nous dit donc que la dérivée de \( \hat \varphi\) par rapport à \( \xi_i\) existe et vaut
    \begin{equation}
        \frac{ \partial \hat\varphi }{ \partial \xi_i }(\xi)=-i\int_{\eR^n}x_i\varphi(x) e^{-i\xi\cdot x}=-i\widehat{M_i\varphi}(\xi).
    \end{equation}
    En appliquant ce résultat en chaîne, nous trouvons la première formule annoncée.

    Nous passons à la seconde formule annoncée. Étant donné que \( \varphi\in\swS\), ses dérivées le sont aussi et par conséquent, il n'y a pas de problèmes pour écrire
    \begin{equation}    \label{EqTYizlnia}
        \widehat{\partial_{x_k}\varphi}(\xi)=\int_{\eR^d}\frac{ \partial \varphi }{ \partial x_k }(x) e^{-ix\cdot \xi}dx.
    \end{equation}
    Étant donné que
    \begin{equation}    \label{EqZAeYaCB}
        \frac{ \partial  }{ \partial x_k }\left( \varphi(x) e^{-ix\cdot\xi} \right)=\frac{ \partial \varphi }{ \partial x_k }(x) e^{-ix\cdot\xi}-i\xi_k\varphi(x) e^{-ix\cdot \xi},
    \end{equation}
    notre tâche sera de prouver que
    \begin{equation}    \label{EqVGvYBNK}
        \int_{\eR^d}\frac{ \partial  }{ \partial x_k }\left( \varphi(x) e^{-ix\cdot \xi} \right)dx=0.
    \end{equation}
    Autrement dit, nous voulons montrer que le terme au bord d'une intégration par partie s'annule. D'abord le fait que \( \varphi\) soit à décroissance rapide nous assure que l'intégrale \eqref{EqVGvYBNK} converge. Pour chaque \( \xi\), la fonction
    \begin{equation}
        f(x,\xi)=\frac{ \partial}{\partial x_k }\left( \varphi(x) e^{-ix\cdot \xi} \right)
    \end{equation}
    est intégrable par rapport à \( x\). De plus, \( f\) est dans \( \swS(\eR)\) pour chacune de ses variables (les autres étant fixées). Le théorème de Fubini \ref{ThoFubinioYLtPI} nous permet alors de décomposer l'intégrale en
    \begin{equation}
        \int_{\eR^d}f(x,\xi)dx=\int_{\eR}\ldots\int_{\eR} f(x_1,\ldots, x_d)dx_1\ldots dx_d.
    \end{equation}
    De plus nous pouvons intégrer dans l'ordre de notre choix et nous choisissons évidemment d'intégrer d'abord par rapport à \( x_k\).  Étudions donc l'intégrale
    \begin{equation}
        \int_{\eR}\frac{ \partial  }{ \partial x }\left( \varphi(x) e^{-ix\xi} \right)dx=\lim_{A\to\infty}\int_{-A}^A\frac{ \partial  }{ \partial x }\left( \varphi(x) e^{-ix\xi} \right)dx
    \end{equation}
    dans laquelle nous avons un peu allégé les notations. Une primitive de ce qui est intégré est toute trouvée : c'est \( \varphi(x) e^{-ix\xi}\), et nous pouvons utiliser le théorème fondamental du calcul intégral pour écrire que
    \begin{equation}
        \int_{-A}^A\left( \varphi(x) e^{-ix\xi} \right)'dx=\left[ \varphi(x) e^{-ix\xi} \right]_{x=-A}^{x=A}.
    \end{equation}
    Vu que \( \varphi\) est dans \( \swS\), la limite \( A\to\infty\) donne zéro.

    En substituant maintenant \eqref{EqZAeYaCB} dans \eqref{EqTYizlnia} et en tenant compte du terme que nous venons de montrer s'annuler, nous avons
    \begin{equation}
        \widehat{\partial_k\varphi}(\xi)=-i\xi_k\int_{\eR^d}\varphi(x) e^{-ix\cdot \xi}=-i\xi_k\hat\varphi(\xi).
    \end{equation}
    En recommençant la procédure \( | \alpha |\) fois nous trouvons la seconde formule annoncée.
\end{proof}

\begin{proposition}[\cite{MesIntProbb}] \label{PropKPsjyzT}
    L'espace de Schwartz est stable par transformée de Fourier. De plus l'application
    \begin{equation}
        \TF\colon \swS(\eR^d)\to \swS(\eR^d)
    \end{equation}
    est une bijection linéaire et continue.
\end{proposition}

\begin{proof}
    La linéarité découle de celle de l'intégrale. La difficulté est de prouver que pour \( \varphi\in\swS(\eR^d)\) nous avons bien que \( \hat\varphi\in\swS(\eR^d)\) et que cette association est continue\footnote{Pour rappel, en dimension infinie, il n'est pas garanti qu'une application linéaire soit continue.}.
    \begin{subproof}
        \item[Stabilité]
            Nous devons prouver que pour tout multiindices \( \alpha\) et \( \beta\), nous avons \( p_{\alpha,\beta}(\hat\varphi)<\infty\). Nous avons
            \begin{equation}
                \xi^{\beta}\partial^{\alpha}\hat\varphi(\xi)=\xi^{\beta}(-i)^{| \alpha |}\widehat{M_{\alpha}\varphi}(\xi)=(-i)^{| \alpha |+| \beta |}\widehat{\partial^{\beta}M_{\alpha}\varphi}(\xi).
            \end{equation}
            Ensuite nous nous souvenons que \( \| \hat f \|_{\infty}\leq \| f \|_1\) parce que
            \begin{equation}
                | \hat f(\xi) |\leq\int_{\eR^d}\big| f(x) e^{-ix\cdot \xi} \big|=\int_{\eR^d}| f(x) |dx=\| f \|_1.
            \end{equation}
            Donc 
            \begin{equation}
                p_{\alpha,\beta}(\hat\varphi)=\| \widehat{\partial^{\beta}M_{\alpha}\varphi} \|_{\infty}\leq \| \partial^{\beta}M_{\alpha}\varphi \|_1.
            \end{equation}
            Du fait que \( \varphi\) soit dans \( \swS\), la dernière expression est finie. Cela prouve déjà que
            \begin{equation}
                \TF\big( \swS(\eR^d) \big)\subset\swS(\eR^d).
            \end{equation}
            
        \item[Continuité]

            Nous supposons avoir une suite \( \varphi_n\stackrel{\swS}{\to}\varphi\), et nous devons prouver que \( \hat\varphi_n\stackrel{\swS}{\to}\hat\varphi\). Pour alléger les notations, nous posons \( f_n=\varphi_n-\varphi\). Nous avons
            \begin{subequations}    \label{subEqsSGsGGih}
                \begin{align}
                    \| \hat f \|_{\alpha,\beta}&=\| \xi^{\beta}\partial^{\alpha}\hat f \|_{\infty}\\
                    &=\| \widehat{  \partial^{\beta}M_{\alpha}f  } \|_{\infty}\,\text{lemme \ref{LemQPVQjCx}.}\\
                    &\leq \| \partial^{\beta}M_{\alpha}f \|_1
                \end{align}
            \end{subequations}
            La convergence \(f_n\stackrel{\swS}{\to}0\) nous dit ente autres que \( \partial^{\beta}M_{\alpha}f_n\stackrel{\swS}{\to}0\); en particulier la proposition \ref{PropGNXBeME} nous dit que \( \partial^{\beta}M_{\alpha}f_n\stackrel{L^1}{\to}0\), ce qui signifie, par les majorations \eqref{subEqsSGsGGih} que
            \begin{equation}
                \| \hat f_n \|_{\alpha,\beta}\leq \| \partial^{\beta}M_{\alpha}f_n \|_1\to0,
            \end{equation}
            ce qui prouve la continuité de transformée de Fourier dans \( \swS(\eR^d)\).
        \item[Bijection]
            Une preuve peut être trouvée dans \cite{BMoNzTY} et aussi dans \cite{ThoVDDBnVn}.
    \end{subproof}
    % Faire le dernier morceau de cette preuve.
\end{proof}

\begin{lemma}   \label{LemYYjFZSa}
    Si \( \phi\in\swS(\eR\times \eR^n)\), alors
    \begin{equation}
        \partial_t\hat\phi=\widehat{\partial_t\phi}
    \end{equation}
    où le chapeau dénote la transformée de Fourier par rapport à la variable dans \( \eR^n\) et non par rapport à celle dans \( \eR\). Le \( t\) par contre est la variable dans \( \eR\).
\end{lemma}

\begin{proof}
    Par définition de la transformée de Fourier nous avons
    \begin{equation}
        (\partial_t\hat\phi)(t,\xi)=\frac{ \partial  }{ \partial t }\int_{\eR^n}\phi(t,x) e^{-i x\xi}dx.
    \end{equation}
    Notre but est de permuter l'intégrale et la dérivée en utilisant le théorème \ref{ThoMWpRKYp}. Il nous faut une fonction \( G\colon \eR^n\to \eR\) qui soit intégrable sur \( \eR^n\) et telle que
    \begin{equation}
        \left| \frac{ \partial \phi }{ \partial t }\phi(t,x) \right| \leq G(x)
    \end{equation}
    pour tout \( t\in B(t_0,\delta)\). Étant donné que la fonction \( \partial_t\phi\) est tout autant Schwartz que \( \phi\) elle-même nous pouvons alléger les notations et chercher une fonction \( G\) qui convient pour toute fonction \( \varphi\in\swS(\eR\times \eR^n)\). Soit la fonction
    \begin{equation}
        G(x)=\sup_{t\in B(t_0,\delta)}| \varphi(t,x) |.
    \end{equation}
    Pour tout multiindice \( \alpha\) nous avons alors
    \begin{equation}
        \sup_{x\in \eR^n}\big| x^{\alpha}G(x) \big|\leq \sup_{(t,x)\in \eR\times \eR^n}\big| x^{\alpha}\varphi(t,x) \big|\leq M_{\alpha}\in \eR.
    \end{equation}
    Grâce à la proposition \ref{PropCSmzwGv}, cela signifie que \( \varphi\) décroît plus vite que n'importe quel polynôme; \( G\) est donc intégrable sur \( \eR^n\).
\end{proof}

\begin{theorem}
    Nous avons la formule d'inversion
    \begin{equation}
        f(x)=\frac{1}{ (2\pi)^n }\int_{\eR^n}\hat f(\xi) e^{ix\cdot \xi}d\xi.
    \end{equation}
\end{theorem}
%TODO : à préciser


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Formule sommatoire de Poisson}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{proposition}[Formule sommatoire de Poisson]   \label{ProprPbkoQ}
    Soit \( f\colon \eR\to \eC\) une fonction continue et \( L^1(\eR)\). Nous supposons que
    \begin{enumerate}
        \item
    il existe \( M>0\) et \( \alpha>1\) tels que
    \begin{equation}
        | f(x) |\leq\frac{ M }{ (1+| x |)^{\alpha} },
    \end{equation}
        \item
            \( \sum_{n=-\infty}^{\infty}| \hat f(2\pi n) |<\infty\).

    \end{enumerate}
    Alors nous avons
    \begin{equation}
        \sum_{n=-\infty}^{\infty}f(n)=\sum_{n=-\infty}^{\infty}\hat f(2\pi n).
    \end{equation}
\end{proposition}
\index{convergence!rapidité}
\index{série!fonctions}
\index{transformation!Fourier}
\index{Fourier}
\index{série!entière}
\index{série!de Fourier}
\index{Poisson!formule sommatoire}
\index{formule!sommatoire de Poisson}

%TODO : Exprimer ce théorème comme truc sur les distributions et sur les machins tempérées, espace de Schwartz.

\begin{proof}
    \begin{subproof}
        \item[Convergence normale]
    
    Nous commençons par montrer qu'il y a convergence normale sur tout compact séparément des séries sur les \( n\geq 0\) et sur les \( n<0\).
    
    Soit \( K\) un compact de \( \eR\) contenu dans \( \mathopen[ -A , A \mathclose]\) et \( n\in \eZ\) tel que \( | n |\geq 2A\). Pour \( x\in K\) nous avons
    \begin{equation}
        | x+n |\geq | n |-| x |\geq | n |-A\geq \frac{ | n | }{ 2 }.
    \end{equation}
    Du coup nous avons un \( \alpha>1\) tel que
    \begin{equation}
        | f(x+n) |\leq \frac{ M }{ \big( 1+| x+n | \big)^{\alpha} }\leq \frac{ M }{ \left( 1+\frac{ | n | }{2} \right)^{\alpha} }.
    \end{equation}
    Lorsque \( n\) est grand, cela a le comportement de \( M/| n |^{\alpha}\) et donc la série
    \begin{equation}
        \sum_{n=0}^{\infty}f(x+n)
    \end{equation}
    est une série convergent normalement. Les deux séries (usuelles) 
    \begin{subequations}
        \begin{align}
            a_-=\sum_{n\leq 0}f(x+n)\\
            a_-=\sum_{n> 0}f(x+n)
        \end{align}
    \end{subequations}
    convergent normalement.
    
\item[Convergence commutative]
    Au sens de la définition \ref{DefIkoheE} nous avons
    \begin{equation}
        \sum_{n\in \eZ}f(x+n)=a_++a_-.
    \end{equation}
    En effet si nous prenons \( J'_0\subset\eN\) fini tel que \( |\sum_{\eN\setminus J_0}f(x+n)-a_+|\leq \epsilon\) et \( J'_1\in -\eN\) tel que \( |\sum_{n\in -\eN\setminus J'_1}f(x+n)|-a_-<\epsilon\), et si nous posons \( J_0=J'_0\cup J'_1\) alors si \( K\) est un ensemble fini de \( \eZ\) contenant \( J_0\) nous avons
    \begin{equation}
        | \sum_{n\in K}f(n+x)-(a_++a_-) |\leq | \sum_{n\in \e^+}f(n+x)-a_+ |+| \sum_{n\in K^-}f(n+x)-a_- |\leq 2\epsilon
    \end{equation}
    où $K^+$ sont les éléments positifs de \(K\) et \( K^-\) sont les \emph{strictement} négatifs. Maintenant que la famille \( \{ f(n+x) \}_{n\in \eZ}\) est une famille sommable, nous savons qu'elle est commutativement sommable et que la proposition \ref{PropoWHdjw} nous permet de sommer dans l'ordre que l'on veut. Nous pouvons donc écrire sans ambigüité l'expression \( \sum_{n\in \eZ}f(x+n)\) ou \( \sum_{n=-\infty}^{\infty}f(x+n)\).
    
    \item[re-convergence normale]

        Nous posons donc sans complexes la série
        \begin{equation}
            F(x)=\sum_{n\in \eZ}f(x+n)
        \end{equation}
        qui converge tant commutativement que normalement. Notons que nous pouvons maintenant dire que la série sur \( \eZ\) converge normalement; pas seulement les deux séries séparément.

    \item[Continuité, périodicité]
        Étant donné que chacune des fonctions \( f(x+n)\) est continue, la convergence normale nous assure que \( F\) est continue.

        De plus \( F\) est périodique parce que
        \begin{equation}
            F(x+1)=\sum_{n=-\infty}^{\infty}f(x+1+n)=\sum_{p=-\infty}^{\infty}f(x+p)
        \end{equation}
        où nous avons posé \( p=1+n\).
        
    \item[Coefficients de Fourier]

        En vertu de la définition \eqref{EqhIPoPH} et de la périodicité de \( F\),
        \begin{subequations}
            \begin{align}
                c_n(F)&=\int_{-1/2}^{1/2}F(t) e^{-2\pi int}dt\\
                &=\int_0^1F(t) e^{-2\pi int}dt\\
                &=\int_0^1\sum_{n\in \eZ}f(t+n) e^{-2 i\pi nt}dt\\
                &=\sum_{n\in \eZ}\int_n^{n+1}f(u) e^{-2\pi i (u-n)t}du\\
                &=\int_{-\infty}^{\infty}f(u) e^{-2\pi inu}du\\
                &=\hat f(2\pi n).
            \end{align}
        \end{subequations}
        où nous avons effectué le changement de variables \( u=t+n\), et permuté l'intégrale et la somme en vertu du fait que la somme converge normalement.

    \item[Conclusion]

        Étant donné l'hypothèse \( \sum_{n\in \eZ}| \hat f(n) |<\infty\) la proposition \ref{PropSgvPab} nous dit que
        \begin{equation}
            F(x)=\sum_{n\in \eZ}c_n(F) e^{2\pi inx},
        \end{equation}
        c'est à dire que
        \begin{equation}
            \sum_{n-\infty}^{\infty}f(x+n)=\sum_{n=-\infty}^{\infty}\hat f(2\pi n) e^{2\pi i nx}.
        \end{equation}
        En écrivant cette égalité en \( x=0\) nous trouvons le résultat :
        \begin{equation}
            \sum_{n\in \eZ}f(n)=\sum_{n\in \eZ}\hat f(2\pi n).
        \end{equation}
    \end{subproof}
\end{proof}

\begin{example}\label{ExDLjesf}
\index{convergence!rapidité}
    La formule sommatoire de Poisson peut être utilisée pour calculer des sommes dans l'espace de Fourier plutôt que dans l'espace direct. Nous allons montrer dans cet exemple l'égalité
    \begin{equation}
        \sum_{n=-\infty}^{\infty} e^{-\alpha n^2}=\sum_{n=-\infty}^{\infty}\sqrt{\frac{ \pi }{ \alpha }} e^{-\pi^2 n^2/\alpha}.
    \end{equation}
    Si \( \alpha\) est grand, alors la somme de gauche est plus rapide, tandis que si \( \alpha\) est petit, c'est le contraire.

    Nous appliquons la formule sommatoire de Poisson à la fonction
    \begin{equation}
        f(x)= e^{-\alpha x^2}.
    \end{equation}
    Nous avons
    \begin{subequations}        \label{EqCDeLht}
        \begin{align}
            \hat f(x)&=\int_{\eR} e^{-\alpha t^2-ixt}dt\\
            &= e^{-x^2/4\alpha}\int_{\eR}e^{ -(\sqrt{\alpha}t+\frac{ ix }{ 2\sqrt{\alpha} })^2 }\\
            &= e^{-x^2/4\alpha}\frac{1}{ \sqrt{\alpha} }\int_{\eR+\frac{ ix }{ 2\sqrt{\alpha} }} e^{-u^2}du.
        \end{align}
    \end{subequations}
    Pour traiter cette intégrale nous utilisons la proposition \ref{PrpopwQSbJg} en considérant le chemin rectangulaire fermé qui joint les points \( -R\), \( R\), \( R+ai\), \( -R+ai\) et \( f(z)= e^{-z^2}\). Calculons l'intégrale sur les deux côtés verticaux. Nous posons
    \begin{equation}
        \gamma_R(t)=R+tia
    \end{equation}
    avec \( t\colon 0\to 1\). Nous avons
    \begin{subequations}
        \begin{align}
            \int_{\gamma_R}f&=\int_0^1f\big( \gamma_R(t) \big)\| \gamma_R'(t) \|dt\\
            &=a e^{-R^2}\int_0^1 e^{-2tRia+at^2}dt,
        \end{align}
    \end{subequations}
    donc en module nous avons
    \begin{equation}
        | \int_{\gamma_R}f |\leq a e^{-R^2}\int_0^1 e^{at^2}dt\leq M e^{-R^2},
    \end{equation}
    où \( M\) est une constante ne dépendant pas de \( R\). Lorsque \( R\to \infty\), la contribution des chemins verticaux s'annule et nous trouvons que
    \begin{equation}    \label{EqjrNxLr}
        \int_{\eR+ai} e^{-u^2}du=\int_{\eR} e^{-u^2}du,
    \end{equation}
    que nous pouvons utiliser pour continuer le calcul \eqref{EqCDeLht}. Nous avons
    \begin{equation}
        \hat f(x)= \frac{ e^{-x^2/4\alpha}}{\sqrt{\alpha}}\int_{R} e^{-u^2}du\\
            =\sqrt{\frac{ \pi }{ \alpha }} e^{-x^2/4\alpha}
    \end{equation}
    où nous avons utilisé la formule \eqref{EqFDvHTg}. Par conséquent ce qui rentre dans la formule sommatoire de Poisson est
    \begin{equation}
        \hat f(2\pi n)=\sqrt{\frac{ \pi }{ \alpha }} e^{-\pi^2 n^2/\alpha}.
    \end{equation}
\end{example}

%AFAIRE : lire l'agenda.
