% This is part of Mes notes de mathématique
% Copyright (c) 2011-2016
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Espaces de Sobolev}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sur un intervalle de \( \eR\)}
%---------------------------------------------------------------------------------------------------------------------------

Sauf mention du contraire dans cette section \( I\) est un intervalle borné ouvert \( I=\mathopen] a , b \mathclose[\) de \( \eR\).

\begin{definition}
Soit \( f\in L^p(I)\) où \( I\) est l'intervalle ouvert \( \mathopen] a , b \mathclose[\). Sa \defe{dérivée au sens des distributions}{dérivée!au sens de distributions} est une fonction\footnote{En réalité, c'est une classe au sens de l'égalité presque partout.} \( g\) telle que
        \begin{equation}
            \int_If\varphi'=-\int_Ig\varphi
        \end{equation}
        pour tout \( \varphi\in C^{\infty}_c(I)\).
\end{definition}

\begin{lemma}
    Lorsqu'une fonction admet une dérivée au sens des distributions, cette dernière est unique (et justifie le singulier dans la définition).
\end{lemma}

\begin{proof}
    Soient \( g,h\in L^2\) tels que 
    \begin{equation}
        \int_Iu\varphi'=-\int_Ig\varphi=-\int_Ih\varphi
    \end{equation}
    pour tout \( \varphi\in C^{\infty}_c(I)\). Nous avons alors
    \begin{equation}
        \int_I(g-h)\varphi=0.
    \end{equation}
    Cela implique que \( g-h=0\) presque partout par la proposition \ref{PropUKLZZZh}\footnote{Ou alors par le lemme \ref{LemDQEKNNf} qui est moins général mais tout aussi bien pour ici.}.
\end{proof}

\begin{definition}
    Soit \( I=\mathopen] a , b \mathclose[\) un ouvert borné de \( \eR\). L'\defe{espace de Sobolev}{espace!de Sobolev} \( H^1(I)\)\nomenclature[Y]{\( H^1(I)\)}{espace de Sobolev} est l'ensemble
    \begin{equation}
        H^1(I)=\Big\{   u\in L^2(I)\tq\exists g\in L^2(I)\tq\forall \varphi\in  C^{\infty}_c(I),\int_Iu\varphi'=-\int_Ig\varphi   \Big\}.
    \end{equation}
\end{definition}
 
L'unique élément \( g\) de \( L^2(I)\) vérifiant \( \int_Iu\varphi'=-\int_Ig\varphi\) est noté \( u'\) est est nommé \defe{dérivée}{dérivée!dans Sobolev $ H^1(I)$}; nous verrons dans les prochaines pages pourquoi.

L'espace \( H^1\) accepte le produit scalaire suivant :
\begin{equation}
    \langle u, v\rangle =\int_Iuv+\int_Iu'v',
\end{equation}
et nous notons \( \| . \|_{H^1}\) la norme correspondante qui n'est autre que
\begin{equation}
    \| u \|_{H^1}=\langle u, u\rangle =\| u \|^2_{L^2}+\| u' \|_{L^2}.
\end{equation}

Nous introduisons l'espace \( L^1_{loc}(I)\)\nomenclature[Y]{\( L^1_{loc}(I)\)}{fonctions intégrables sur les compacts de \( I\)} des fonctions étant \( L^1\) sur tout compact de \( I\). 

\begin{proposition} \label{PropLGoLtcS}
    Si \( f\in L^1_{loc}(I)\) est telle que
    \begin{equation}
        \int_If\varphi'=0
    \end{equation}
    pour tout \( \varphi\in  C^{\infty}_c(I)\), alors il existe une constante \( C\) telle que \( f=C\) presque partout.
\end{proposition}

\begin{proof}
    Soit \( \psi\in C^{\infty}_c(I)\) une fonction d'intégrale \( 1\) sur \( I\). Si \( w\in C^{\infty}_c(I)\) alors nous considérons la fonction
    \begin{equation}
        h=w-\psi\int_Iw,
    \end{equation}
    qui est dans \(  C^{\infty}_c(I)\) et dont l'intégrale sur \( I\) est nulle. Par la proposition \ref{PropHFWNpRb}, la fonction \( h\) admet une primitive dans \(  C^{\infty}_c(I)\); et nous notons \( \varphi\) cette primitive. L'hypothèse appliquée à \( \varphi\) donne
    \begin{equation}
        0=\int_If\varphi'=\int_If\left( w-\psi\int_Iw \right)=\int_Ifw-\underbrace{\left( \int_If(x)\psi(x)dx \right)}_C\left( \int_Iw(y)dy \right)=\int_Iw(f-C).
    \end{equation}
    L'annulation de la dernière intégrale implique par la proposition \ref{PropUKLZZZh} que \( f-C=0\) dans \( L^2\), c'est à dire \( f=C\) presque partout.
\end{proof}

\begin{corollary}   \label{CorEVJYihj}
    Si \( u\in H^1(I)\) et si \( u'=0\) alors il existe une constant \( C\) telle que \( u=C\) presque partout.
\end{corollary}

\begin{proof}
    L'hypothèse \( u'=0\) signifie que pour tout fonction \( \varphi\in C^{\infty}_c(I)\),
    \begin{equation}
        \int_Iu\varphi'=\int_Iu'\varphi=0.
    \end{equation}
    La proposition \ref{PropLGoLtcS} nous dit alors qu'il existe une constante \( C\) telle que \( u=C\) presque partout.
\end{proof}

\begin{lemma}   \label{LemMPkbZxX}
    Tout élément de \( H^1(I)\) admet un unique représentant continu.
\end{lemma}
Nous verrons dans le corollaire \ref{CorCEPJGAu} que ce représentant pourra être prolongé par continuité sur \( \bar I\).

\begin{proof}
    Soit \( y_0\in I\) et \( u\in H^1(I)\). Nous considérons la fonction
    \begin{equation}
        \bar u(x)=\int_{y_0}^xu'(t)dt.
    \end{equation}
    Notons que par définition, \( u'\in L^2\) donc l'intégrale ne pose pas de problèmes. Montrons que \( \bar u\) est continue sur \( \bar I\). Pour cela nous considérons \( x\in\bar I\) et \( h\) tel que \( x+h\in \bar I\). Alors
    \begin{equation}
        \big| \bar u(x+h)-\bar u(x) \big|=\big| \int_x^{x+h}u' \big|\leq \int_x^{x+h}| u' |.
    \end{equation}
    Mais la fonction \( | u' |\) est dans \( L^1_{loc}(I)\) par le lemme \ref{LemTLHwYzD}; elle est en particulier intégrable sur un ouvert contenant \( x\) et par conséquent la dernière intégrale tend vers zéro lorsque \( h\) tend vers \( 0\).

    Nous prouvons à présent que \( \bar u\) est dans \( H^1(I)\) et que sa dérivée est égale à \( u'\); pour cela nous allons montrer que pour tout \( \varphi\in  C^{\infty}_c(I)\),
    \begin{equation}
        \int_I\bar u\varphi'=-\int_Iu'\varphi.
    \end{equation}
    Nous avons
    \begin{equation}
            \int_I\bar u\varphi'=\int_I\left( \int_{y_0}^xu'(t)dt\right)\varphi'(x)dx
            =\int_{a}^{y_0}\left( \int_{y_0}^xu'(t)dt\right)\varphi'(x)dx+\int_{y_0}^b\left( \int_{y_0}^xu'(t)dt\right)\varphi'(x)dx.
    \end{equation}
    Pour faire plus court, nous notons \( f(t,x)=u'(t)\varphi'(x)\). La première intégrale vaut
    \begin{subequations}
        \begin{align}
            \int_a^{y_0}\left( \int_{y_0}^x u'(t)\varphi'(x) \right)&=\int_a^{y_0}\left(\int_{y_0}^af(t,x)\mtu_{t<x}(t,x)dt\right)dx\\
            &=\int_{y_0}^a\int_a^{y_0}f(t,x)\mtu_{t>x}dxdt  \label{subeqBVyBPLp}\\
            &=\int_{y_0}^a\int_a^tf(t,x)dxdt\\
            &=-\int_a^{y_0}\int_a^tu'(t)\varphi'(x)dx\,dt
        \end{align}
    \end{subequations}
    La permutation d'intégrales pour obtenir \eqref{subeqBVyBPLp} est due au théorème de Fubini \ref{ThoFubinioYLtPI}\ref{ItemQMWiolgiii}. Par le même petit jeu, la seconde intégrale vaut
    \begin{equation}
        \int_{y_0}^b\int_t^b u'(t)\varphi'(x)dx\,dt.
    \end{equation}
    En refaisant la somme,
    \begin{subequations}
        \begin{align}
            \int_I\bar u\varphi'
            &=-\int_a^{y_0}u'(t)\left( \int_a^t\varphi'(x)dx \right)dt+\int_{y_0}^bu'(t)\left( \int_t^b\varphi'(x)dx \right)dt\\
            &=-\int_a^{y_0}u'(t)\big( \varphi(t)-\varphi(a) \big)dt+\int_{y_0}^bu'(t)\big( \varphi(b)-\varphi(t) \big)\\
            &=-\int_a^bu'\varphi\\
            &=-\int_Iu'\varphi.
        \end{align}
    \end{subequations}
    Notons que \( \varphi(a)=\varphi(b)=0\) parce que \( \varphi\) est à support compact dans \( \mathopen] a , b \mathclose[\). Nous avons donc prouvé que \( \bar u\) est dans \( H^1(I)\) et que \( \bar u'=u'\). Par le corollaire \ref{CorEVJYihj}, nous avons une constante \( C\) telle que \( \bar u=u+C\) presque partout, c'est à dire \( u=\bar u +C\) dans \( H^1(I)\). 

        En résumé, \( \tilde u\tilde u=\bar u+C\) est un représentant continu de \( u\) dans \( L^2(I)\).

        L'unicité du représentant continu est simplement le fait que deux fonctions continues égales presque partout sont égales (proposition  \ref{PropNCMToWI}).
    
\end{proof}

\begin{proposition}     \label{PropGWOIoDg}
    Si \( u\in H^1(I)\), alors
    \begin{equation}
        u(x)-u(y)=\int_y^xu'
    \end{equation}
    pour tout \( x,y\in I\).
\end{proposition}

\begin{proof}
    Pour fixer les idées, nous supposons \( x<y\). Nous considérons une suite \( \varphi_n\in C^{\infty}_c(I)\) convergeant uniformément sur \( I\) vers \( \mtu_{\mathopen[ x , y \mathclose]}\). Nous exigeons de plus que 
    \begin{itemize}
        \item 
        \( \varphi_n'\) est positive sur \( \mathopen[ a , x+\frac{1}{ n } \mathclose]\)
    \item
        \( \varphi_n'\) est négative sur \( \mathopen[ y-\frac{1}{ n } , b \mathclose]\) 
    \item
        \( \varphi_n=1\) sur \( \mathopen[ x+\frac{1}{ n } , y-\frac{1}{ n } \mathclose]\).
    \item
        \( \varphi_n=0\) sur \( \mathopen[ a , x-1/n \mathclose]\) et sur \( \mathopen[ y+1/n , b \mathclose]\).
    \end{itemize}
    Pour chaque \( n\), nous découpons l'intégrale comme
    \begin{equation}        \label{EqRPwqpve}
        -\int_Iu'\varphi_n=\int_Iu\varphi'_n=\int_a^{a-1/n}u\varphi'_n+\int_{x-1/n}^{x+1/n}u\varphi'_n+\int_{x+1/n}^{y-1/n}u\varphi'_n+\int_{y-1/n}^{y+1/n}u\varphi'_n+\int_{y+1/n}^{b}u\varphi'_n.
    \end{equation}
    Par construction de \( \varphi_n\), de ces \( 5\) morceaux, il n'en reste que deux de non nulles :
    \begin{equation}
        \int_Iu\varphi'=\underbrace{\int_{x-1/n}^{x+1/n}u(t)\varphi'_n(t)dt}_A+\underbrace{\int_{y-1/n}^{y+1/n}u(t)\varphi'_n(t)dt}_B
    \end{equation}

    Soit \( \epsilon>0\) et \( n\) suffisamment grand pour avoir \( u(t)\in B\big( u(x),\epsilon \big)\) pour tout \( t\in B(x,\frac{1}{ n })\) et (en même temps) \( u(t)\in B\big( u(y),\epsilon \big)\) pour tout \( t\in B(y,\frac{1}{ n })\). C'est la continuité de \( u\) qui permet de trouver un tel \( n\). Pour cette valeur de \( n\), en tenant compte des hypothèses sur la positivité de \( \varphi_n'\) nous avons
    \begin{equation}
        \int_{x-1/n}^{x+1/n}\big( u(x)-\epsilon \big)\varphi'_n(t)dt\leq\int_{x-1/n}^{x+1/n}u(t)\varphi'_n(t)dt\leq\int_{x-1/n}^{x+1/n}\big( u(x)+\epsilon \big)\varphi'_n(t)dt,
    \end{equation}
    mais par hypothèse sur \( \varphi_n\) nous trouvons
    \begin{equation}
        \int_{x-1/n}^{x+1/n}\varphi'_n(t)dt=\varphi_n(x+\frac{1}{ n })-\varphi(x+\frac{1}{ n })=1.
    \end{equation}
    donc
    \begin{equation}    \label{EqLYrpEdb}
        u(x)-\epsilon\leq\int_{x-1/n}^{x+1/n}u(t)\varphi'_n(t)dt\leq u(x)+\epsilon.
    \end{equation}
    Pour encadrer la seconde, il faut être plus prudent avec les signes parce que \( \varphi'_n\) y est négative. En posant \( \psi_n=-\varphi_n\) nous avons
    \begin{equation}
        -B=\int_{y-1/n}^{y+1/n}u(t)\psi_n(t)dt,
    \end{equation}
    et donc
    \begin{equation}
        u(y)-\epsilon\leq -B\leq u(y)+\epsilon
    \end{equation}
    ou encore
    \begin{equation}
        -\epsilon-u(y)\leq B\leq \epsilon-u(y).
    \end{equation}
    En additionnant avec \eqref{EqLYrpEdb} nous voyons que pour tout \( \epsilon>0\) il existe un \( N(\epsilon)\) tel que nous ayons
    \begin{equation}    \label{EqEBwWUxm}
        u(x)-u(y)-2\epsilon\leq\int_Iu'\varphi_{n}\leq u(x)-u(y)+2\epsilon
    \end{equation}
    pour tout \( n\geq N\). Nous voulons évidemment prendre la limite \( \epsilon\to 0\), c'est à dire \( n\to \infty\). Étant donné que \( \varphi_n(t)<1\) pour tout \( t\) et pour tout \( n\), la fonction \( t\mapsto u'(t)\varphi_n(t)\) est dominée par \( u'\), qui est dans \( L^1(I)\) par le lemme \ref{LemTLHwYzD}. Le théorème de la convergence dominée nous permet donc d'affirmer que
    \begin{equation}
        \lim_{n\to \infty} \int_Iu'\varphi_n=\int_Iu'\mtu_{[x,y]}=\int_x^yu',
    \end{equation}
    et donc les inégalités \eqref{EqEBwWUxm} donnent le résultat, grâce au signe dans \eqref{EqRPwqpve}.
\end{proof}

\begin{corollary}   \label{CorCEPJGAu}
    Si \( [u]\in H^1(I)\), le représentant continu \( u\in C^0(I)\) peut être prolongé par continuité en \( u\in C^0(\bar I)\).
\end{corollary}

\begin{proof}
    Soit \( (x_n)\) une suite strictement croissante dans \( \mathopen] a , b \mathclose[\) convergeant vers \( b\). Nous voulons montrer que la suite \( \big( u(x_n) \big)\) est de Cauchy dans \( \eR\), ce qui nous permettra de définir
        \begin{equation}
            u(b)=\lim_{n\to \infty} u(x_n).
        \end{equation}
        qui sera évidemment continue. Cette construction ne dépendra pas du choix de la suite \( (x_n)\) parce que deux fonctions continues sur \( \bar I\) et égales sur \( I\) sont égales sur \( \bar I\).

        En notant \( u'\) la dérivée de \( u\) dans \( H^1\), nous avons par construction du représentant continu : \( u(x)=\int_{y_0}^xu'(t)dt\). Et donc
        \begin{equation}
            \big| u(x_n)-u(x_{n+p}) \big|=\left| \int_{y_0}^{x_n}u'-\int_{y_0}^{x_{n+p}}u' \right| =\left| \int_{x_n}^{x_{n+p}}u' \right| .
        \end{equation}
        Vu que la suite \( (x_n)\) est de Cauchy et que \( u'\) est intégrable (même sur \( \bar I\)), la limite \( n\to\infty\) de cela est zéro, quelle que soit la valeur de \( p\). Donc \( \big( u(x_n) \big)\) est ce Cauchy dans \( \eR\) et est donc convergente.
\end{proof}
\index{prolongement!par continuité!dans \( H^1(I)\)}

\begin{proposition}[\cite{KXjFWKA}]     \label{ThoESIyxfU}
    Quelques propriétés de l'espace de Sobolev \( H^1(I)\) où \( I=\mathopen] a , b \mathclose[\) est un ouvert borné de \( \eR\).
    \begin{enumerate}
        \item
            \( H^1(I)\) est un espace de Hilbert.
        \item
            \( H^1(I)\) s'injecte de façon compacte dans \( C^0(\bar I)\).
        \item
            \( H^1(I)\) s'injecte de façon continue dans \( L^2(I)\).
    \end{enumerate}
\end{proposition}
\index{espace!de fonctions!Sobolev \( H^1\)}
\index{espace!de Hilbert!espace de Sobolev \( H^1\)}
\index{espace!\( L^2\)!Sobolev}
\index{dérivation!au sens des distribution!Sobolev}


\begin{proof}
    Nous prouvons point par point.
    \begin{enumerate}
        \item
            Le seul critère à vérifier est la complétude. Pour cela nous considérons une suite de Cauchy \( (u_n)\) dans \( H^1(I)\). Si \( \epsilon>0\), alors il existe \( N>0\) tel que pour tout \( p\geq 0\) nous ayons \( \| u_{n+p}-u_n \|_{H^1}^2\leq \epsilon\), c'est à dire
            \begin{equation}
                \| u_{n+p}-u_n \|^2_{L^2}+\| u'_{n+p}-u'_n \|^2_{L^2}+
            \end{equation}
            En particulier les suites \( (u_n)\) et \( (u'_n)\) sont de Cauchy dans \( L^2\) qui est complet par le théorème de Fischer-Riesz \ref{ThoGVmqOro}. Nous notons donc
            \begin{subequations}
                \begin{align}
                    u_n\stackrel{L^2}{\to}u\\
                    u'_n\stackrel{L^2}{\to}v.
                \end{align}
            \end{subequations}
            Nous allons démontrer les points suivants\quext{C'est le moment de lire l'énoncé du problème \ref{ProbTOElufz} et de m'écrire si vous avez une réponse.}
            \begin{itemize}
                \item \( u\in H^1(I)\) avec \( u'=v\).
                \item \( u_n\stackrel{H^1}{\to}u\).
            \end{itemize}
            Pour cela nous introduisons la dérivée faible de \( u\) dans \( L^2\), c'est à dire la forme linéaire continue \( \partial u\) sur \(  C^{\infty}_c(I)\) :
            \begin{equation}
                \begin{aligned}
                    \partial u\colon  C^{\infty}_c(I)&\to \eR \\
                    \varphi&\mapsto \langle \partial u, \varphi\rangle =-\int_Iu\varphi'. 
                \end{aligned}
            \end{equation}
            Pour tout \( \varphi\in C^{\infty}_c(I)\) nous avons
            \begin{subequations}
                \begin{align}
                \big| \langle \partial u, \varphi\rangle -\langle u_n', \varphi\rangle  \big|&=\left| -\int_Iu\varphi'-\int_Iu'_n\varphi \right| \\
                &=\left| -\int_Iu\varphi'-\int_Iu_n\varphi' \right| \\
            &\leq \int_I| u-u_n | |\varphi' |\\
            &\leq\| u-u_n \|_{L^2}\| \varphi' \|_{L^2}\,\text{Cauchy-Schwartz dans \( L^2\)}\\
            &\to 0.
                \end{align}
            \end{subequations}
            À la première ligne, la première intégrale est la définition de l'action de la forme \( \partial u\) sur \( \varphi\) alors que la seconde est seulement un produit scalaire dans \( L^2\). Tout deux sont notés avec les crochets. En tant que limite dans \( \eR\) nous avons
            \begin{equation}
                \lim_{n\to \infty} \langle u'_n, \varphi\rangle =\langle \partial u, \varphi\rangle .
            \end{equation}
            Dans le calcul suivant, les deux crochets sont des produits scalaires dans \( L^2\) :
            \begin{subequations}
                \begin{align}
                \big| \langle u_n', \varphi\rangle -\langle v, \varphi\rangle  \big|&=\left| -\int_Iu'_n\varphi-\int_Iv\varphi \right| \\
            &\leq \int_I| u'_n-v| |\varphi |\\
            &\leq\| u'_n-v \|_{L^2}\| \varphi \|_{L^2}\\
            &\to 0.
                \end{align}
            \end{subequations}
            Donc en tant que limite dans \( \eR\),
            \begin{equation}
                \lim_{n\to \infty} \langle u'_n, \varphi\rangle =\langle v, \varphi\rangle .
            \end{equation}
            Par unicité de la limite nous en déduisons que pour tout \( \varphi\in C^{\infty}_c(I)\),
            \begin{equation}
                \langle \partial u, \varphi\rangle =\langle v, \varphi\rangle .
            \end{equation}
            Encore une fois nous répétons qu'à gauche le crochet est l'application de la forme \( \partial u\) sur \( \varphi\) tandis qu'à droite c'est le produit scalaire dans \( L^2\). 

            Nous sommes maintenant à même de prouver que \( u\in H^1(I)\) et que sa dérivée (au sens de \( H^1\)) est \( v\). En effet
            \begin{equation}
                \int_Iu\varphi'=-\langle \partial u, \varphi\rangle =-\langle v, \varphi\rangle =-\int_Iv\varphi.
            \end{equation}
            Par conséquent nous avons \( u'=v\) dans \( H^1\) et aussi \( u'=v\) presque partout au sens des fonctions.

            Nous pouvons alors prouver que \( u_n\to u\) dans \( H^1(I)\) :
            \begin{equation}
                \| u_n-u \|^2_{H^1(I)}=\| u_n-u \|^2_{L^2}+\| u'_n-u' \|_{L^2}^2.
            \end{equation}
            Mais nous savons déjà que \( u_n\to u\) dans \( L^2\) (d'ailleurs c'est la définition de \( u\)) et que \( u'=v\) alors que par définition de \( v\), nous avons \( u'_n\to v\) dans \( L^2\). Tout cela donne que \( u_n\to u\) dans \( H^1(I)\) et donc que \( H^1(I)\) est un espace complet.

        \item

            L'application que nous allons prouver être compacte entre \( H^1(I)\) et \( C^0(\bar I)\) est
            \begin{equation}
                \begin{aligned}
                    \psi\colon H^1(I)&\to C^0(\bar I) \\
                    [u]&\mapsto \tilde u 
                \end{aligned}
            \end{equation}
            où \( [u]\) désigne une classe de fonction dans \( H^1(I)\) et \( \tilde u\) est son représentant continu prolongé par continuité à \( \bar I\)\footnote{Encore que par soucis d'économie d'encre nous n'allons pas écrire toujours les tildes et noter \( u\) le représentant continu prolongé à \( \bar I\) par le corollaire \ref{CorCEPJGAu}.}, qui existe par le lemme \ref{LemMPkbZxX} et le corollaire \ref{CorCEPJGAu}. Cette application est une injection par l'unicité du représentant continu. Nous allons prouver que c'est une application compacte en utilisant le critère \ref{ItemJIkpUbLii} de la proposition \ref{PropDGsPtpU}. Pour cela nous allons commencer par utiliser le théorème d'Ascoli sur l'ensemble \( \tilde \mB\) des représentants continus des éléments de \( \mB\), prolongés par continuité sur \( \bar I\); c'est à dire \( \tilde B\subset C^0(\bar I)\).

            Soit \( u\in \tilde \mB\); par la proposition \ref{PropGWOIoDg}, nous avons
            \begin{subequations}
                \begin{align}
                    \big| u(x)-u(y) \big|&=\big| \int_y^xu'(t)dt \big|\\
                    &=\left| \int_I\mtu_{[x,y]}(t)u'(t)dt \right| \\
                    &\leq\| \mtu_{\mathopen[ x , y \mathclose]} \|_{L^2}\| u' \|_{L^2}\\
                    &\leq\sqrt{| x-y |}\| u' \|_{H^1}\\
                    &\leq\sqrt{| x-y |}.
                \end{align}
            \end{subequations}
            où nous insistons sur le fait que la continuité n'impliquant pas la dérivabilité, le \( u'\) ici est la dérivé au sens de \( H^1\), et non la dérivée usuelle. Quoi qu'il en soit, l'ensemble \(\tilde  \mB\) est équicontinu\footnote{Définition \ref{DefUWmVBcZ}}. Nous montrons à présent qu'il est également borné pour la norme uniforme. Soit \( u\in\tilde \mB\); vu la construction du représentant continu au lemme \ref{LemMPkbZxX}, nous avons
            \begin{subequations}
                \begin{align}
                \big| u(x) \big|&=\left| \frac{1}{ b-a }\int_a^bu(x)dy \right| \\
                &=\left| \frac{1}{ b-a }\int_a^b\left( \int_y^xu'(t)dt-u(y) \right)dy \right| \\
                &=\left| \frac{1}{ b-a }\int_a\int_y^xu'(t)dtdy-\frac{1}{ b-a }\int_a^b u(y)dy \right| \\
                &\leq\frac{1}{ b-a }\int_a^b\int_a^b| u'(t) |dt\,dy+\frac{1}{ b-a }\int_a^b| u(y) |dy \label{EqCFwSOxh}.
                \end{align}
            \end{subequations}
            À ce niveau, il faut remarquer que dans la première intégrale, le passage de la valeur absolue à l'intérieur de l'intégrale en même temps que l'élargissement des bornes n'a rien d'innocent. Si \( x<y\), les bornes ne sont pas «dans le bon ordre» et nous ne pouvons pas faire la majoration usuelle en entrant simplement la valeur absolue. Ici nous tenons compte de cela en élargissant les bornes, et en les mettant dans le bon ordre. Le passage exact est le suivant : si \( x,y\in\mathopen] a , b \mathclose[\), nous avons
                \begin{equation}
                \left| \int_y^xf(t)dt \right| \leq\left| \int_y^x| f(t) |dt \right| \leq\left| \int_a^b| f(t) |dt \right| =\int_a^b| f(t) |dt.
                \end{equation}
                Notons en particulier que dans le cas du passage vers l'équation \eqref{EqCFwSOxh}, le nombre \( x\) est fixé alors que \( y\) est une variable d'intégration. Donc l'ordre des deux est certainement de temps en temps le «mauvais».

                Quoi qu'il en soit, la première intégrale se réduit à une multiplication par \( b-a\) et le calcul continue :
                \begin{subequations}
                    \begin{align}
                        \big| u(x) \big|&\leq \int_I| u'(t) |dt+\frac{1}{ b-a }\int_I| u |\\
                        &\leq \sqrt{b-a}\| u' \|_{L^2}+\frac{1}{ \sqrt{b-a} }\| u \|_{L^2}\\
                        &\leq\left( \sqrt{b-a}+\frac{1}{ \sqrt{b-a} } \right)\big( \| u' \|_{L^2}+\| u \|_{L^2} \big)\\
                        &\leq\left( \sqrt{b-a}+\frac{1}{ \sqrt{b-a} } \right) \| u \|_{H^1}\\
                        &= \sqrt{b-a}+\frac{1}{ \sqrt{b-a} }.
                    \end{align}
                \end{subequations}
                Donc \( \tilde \mB\) est borné pour la norme \( L^{\infty}\). Et c'est même borné par un nombre facilement calculable connaissant \( I\). En particulier l'ensemble
                \begin{equation}
                    \{ u(x)\tq u\in H^1 \}
                \end{equation}
                est pour, tout \( x\), contenu dans la boule de rayon \( \sqrt{a-b}+\frac{1}{ \sqrt{a-b} }\) et donc est relativement compact dans \( \eR\). Par conséquent le théorème d'Ascoli \ref{ThoKRbtpah} nous dit que l'ensemble \( \tilde B\) est relativement compact dans \( C^0(I)\).

                Par conséquent nous avons montré que l'image par \( \psi\) de la boule unité fermée \( \mB\) de \( H^1(I)\) est relativement compacte dans \( C^0(\bar I)\), ce qui signifie que \( \psi\) est une application compacte.


            \item

                Les éléments de \( H^1(I)\) sont des éléments de \( L^2(I)\); donc l'identité est une injection. Nous devons seulement étudier la continuité. Si \( (u_n)\) est une suite dans \( H^1\) convergeant dans \( H^1\) vers \( u\), alors
                \begin{equation}
                    \| u_n-u \|_{L^2}\leq\| u_n-u \|_{L^2}+\| u'_n-u' \|_{L^2}=\| u_n-u \|_{H^1}\to 0.
                \end{equation}
                Donc la suite des images (par l'identité) converge dans \( L^2\). L'identité est donc continue.

    \end{enumerate}
    
\end{proof}

\begin{probleme}    \label{ProbTOElufz}
    Au point de la preuve auquel vous devriez être si vous lisez ceci, vous pourriez avoir envie de démontrer \( u'=v\) de la façon suivante :
    \begin{equation}
        \int_I u\varphi'=\lim_{n\to \infty} \int_Iu_n\varphi=-\lim_{n\to \infty} \int_Iu'_n\varphi=-\int_Iv\varphi.
    \end{equation}
    J'avoue ne pas trouver d'exemples pour lesquels ça ne marche pas. Est-ce qu'on peut inverser la limite et l'intégrale dans \( L^2\) ?

    Ceci n'invalide pas la preuve donnée, mais ça suggère un sacré raccourcis.
\end{probleme}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sur un ouvert de \( \eR^n\)}
%---------------------------------------------------------------------------------------------------------------------------

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Dérivée partielle au sens faible}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Soit \( \Omega\), un ouvert de \( \eR^n\) et \( v\in L^2(\Omega)\) (définition \ref{DEFooSVCHooIwwuIx}). Les fonctions considérées sont à valeurs réelles.

\begin{definition}      \label{DEFooBRFCooPncSCE}
    Si \( i=1,\ldots, n\), la \defe{dérivée faible}{dérivée!faible} de \( v\) dans la direction \( e_i\) est l'application\footnote{En fait c'est une classe au sens de l'égalité presque partout.} notée \( \partial_iv\) définie par
    \begin{equation}        \label{EQooMRZUooFoqPqv}
        \langle \partial_iv, \phi\rangle =-\langle v, \partial_i\phi\rangle 
    \end{equation}
    pour tout \( \phi\in  C^{\infty}_c(\Omega)\).
\end{definition}

\begin{lemma}
    Si \( v\in L^2\) admet une dérivée faible, alors cette dernière est unique.
\end{lemma}

\begin{proof}
    Supposons \( f,g\) telles que \( \langle g, \phi\rangle \) et \( \langle f, \phi\rangle \) soient tous deux égaux à \( -\langle v, \partial_i\phi\rangle \). En particulier pour tout \( \phi\in  \swD(\Omega)\) nous avons \( \langle (f-g), \phi\rangle =0\). 

    Cela donne \( f-g=0\) par la proposition \ref{PropUKLZZZh}.
\end{proof}

Test : \cite{ooKDRBooDFsyfV}

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Définition}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{definition}[Espace de Sobolev \( H^1(\Omega)\)]
    Soit \( \Omega\) une partie de \( \eR^n\). L'espace de \defe{Sobolev}{Espace!de Sobolev} \( H^1(\Omega)\)\nomenclature[Y]{\( H^1(\Omega)\)}{espace de Sobolev sur \( \Omega\)} est:
    \begin{equation}
        H^1(\Omega)=\{ v\in L^2(\Omega)\tq \forall i=1,\ldots, n, \partial_iv\in L^2(\Omega) \}.
    \end{equation}
    Nous munissons cet espace d'un produit scalaire
    \begin{equation}
        (u,v)_{H^1}=\langle u, v\rangle_{L^2}+\langle \nabla u, \nabla v\rangle_{L^2},
    \end{equation}
    où \( \nabla u=\sum_i\partial_iu\in L^2\).
\end{definition}
L'existence des intégrales dans le produit scalaire est assurée par le fait que \( u\), \( v\), \( \nabla u\) et \( \nabla v\) sont dans \( L^2(\Omega)\). La définition du produit scalaire dans \( L^2\) est la définition \ref{DefProdScalLubrgTj} (mais sans la conjugaison complexe).

Pour la même raison, \( (u,u)_{H^1}=0\) demande que chacun des deux termes est séparément nul, et nous avons \( u=0\) dans \( L^2\), et donc aussi dans \( H^1\).

\begin{theorem}[\cite{ooYWZMooXnzOQp}]
    L'espace \( H^1(\Omega)\) est un espace de Hilbert\footnote{Définition \ref{DefORuBdBN}.}.
\end{theorem}

\begin{proof}
    Nous devons nous assurer que l'espace \( H^1\) est complet. Pour cela nous considérons une suite de Cauchy \( (u_n)\) dans \( H^1\). Soit \( \epsilon>0\); il existe \( N>0\) tel que si \( n,m>N\) alors \( \| u_n-u_m \|_{H^1}<\epsilon\). Dans ce cas nous avons en particulier
    \begin{equation}
        \| u_m-u_n \|_{H^1}^2=(u,u)_{H^1}=\langle u, u\rangle +\langle \nabla u, \nabla u\rangle =\| u \|_{L^2}^2+\| \nabla u \|_{L^2}^2,
    \end{equation}
    et en particulier les suites \( (u_n)\) et \( (\nabla u_n)\) sont de Cauchy dans \( L^2\). Vu que \( L^2\), lui, est complet (théorème \ref{ThoUYBDWQX}), il existe \( u\in L^2\) et \( v_i\in L^2\) tels que
    \begin{subequations}
        \begin{align}
            u_n\stackrel{L^2}{\longrightarrow}u\\
            \partial_iu_n\stackrel{L^2}{\longrightarrow}v_i.
        \end{align}
    \end{subequations}
    Nous savons que l'injection \( i\colon L^2\to \swD'\) est continue par la proposition \ref{PROPooYAJSooMSwVOm}. Nous avons donc aussi les limites
    \begin{subequations}
        \begin{align}
            T_{u_n}\stackrel{\swD'}{\longrightarrow}T_u\\
            T_{\partial_i u_n}\stackrel{\swD'}{\longrightarrow}T_{v_i}.     \label{SUBEQooMWLIooWakTkx}
        \end{align}
    \end{subequations}
    La dérivée étant une opération continue sur \( \swD'\) nous avons de plus
    \begin{equation}
        \partial_i(T_{u_n})\stackrel{\swD'}{\longrightarrow}\partial_i(T_u)
    \end{equation}
    En utilisant le lemme \ref{LEMooQRUOooWVjCAV} nous avons alors
    \begin{equation}
        T_{\partial_iu_n}=\partial_i(T_{u_n})\stackrel{\swD}{\longrightarrow}\partial_i(T_u)=T_{\partial_iu}.
    \end{equation}
    En comparant avec \eqref{SUBEQooMWLIooWakTkx} et par l'unicité de la limite, nous avons \( T_{v_i}=T_{\partial_iu}\). Cela implique \( v_i=\partial_iu\).

    Vu que \( v_i\in L^2\) nous avons aussi \( \partial_iu\in L^2\). Par conséquent \( u\in H^1(\Omega)\) parce que ses dérivées sont dans \( L^2\).

    Nous devons maintenant prouver que \( u_n\stackrel{H^1}{\longrightarrow}u\). Nous avons
    \begin{equation}
        \| u_n-u \|_{H^1}=\| u_n -u\|_{L^2}+\| \nabla u_n-\nabla u \|_{L^2}
    \end{equation}
    Le premier terme tend vers zéro parce que \( u_n\stackrel{L^2}{\longrightarrow}u\) et le second parce que \( \partial_iu_n\stackrel{L^2}{\longrightarrow}\partial_iu\).
\end{proof}
