% This is part of Mes notes de mathématique
% Copyright (c) 2011-2013
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Espaces de Sobolev}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Sauf mention du contraire dans cette section \( I\) est un intervalle borné ouvert \( I=\mathopen] a , b \mathclose[\) de \( \eR\).

\begin{proposition} \label{PropHFWNpRb}
    Une fonction \( h\in C^{\infty}_c(I)\) admet une primitive dans \(  C^{\infty}_c(I)\) si et seulement si \( \int_Ih=0\).
\end{proposition}

\begin{proof}
    Si une primitive \( H\) de \( h\) est à support compact, alors
    \begin{equation}
        \int_Ih=H(b)-H(a)=0-0=0.
    \end{equation}
    Pas de problèmes dans ce sens.

    Supposons maintenant que \( \int_Ih=0\). Le fait que \( h\) admette une primitive dans \(  C^{\infty}(I)\) est évident : toute fonction continue admet une primitive. Soit \( H\) une telle primitive et \( \tilde H=H-H(b)\). Alors \( \tilde H(b)=0\) et 
    \begin{equation}
        \tilde H(a)=H(a)-H(b)=-\int_Ih=0.
    \end{equation}
    Nous rappelons que le support d'une fonction est \emph{la fermeture} de l'ensemble des points de non-annulation.

    Supposons que le support de \( h\) soit inclus dans \( \mathopen[ m , M \mathclose]\subset\mathopen] a , b \mathclose[\). En prenant des nombres \( m'\) et \( M'\) tels que \( a<m'<m\) et \( M<M'<b\) (nous insistons sur le caractère strict de ces inégalités), la fonction \( h\) est nulle sur \( \mathopen[ a , m' \mathclose]\) et sur \( \mathopen[ M' , b \mathclose]\); la fonction \( \tilde H\) doit donc y être constante. Mais nous avons déjà vu que \( \tilde H(a)=\tilde H(b)=0\). Donc l'ensemble des points sur lesquels \( \tilde H\) n'est pas nul est inclus à \( \mathopen] m' , M' \mathclose[\) et donc est strictement (des deux côtés) inclus à \( I\).
\end{proof}


\begin{definition}
    Soit \( f\in L^p(\Omega)\) où \( I\) est l'intervalle ouvert \( \mathopen] a , b \mathclose[\). Sa \defe{dérivée au sens des distributions}{dérivée!au sens de distributions} est une fonction \( g\) telle que
        \begin{equation}
            \int_If\varphi'=-\int_Ig\varphi
        \end{equation}
        pour tout \( \varphi\in C^{\infty}_c(I)\).
\end{definition}

\begin{lemma}
    Lorsqu'une fonction admet une dérivée au sens des distributions, cette dernière est unique (et justifie le singulier dans la définition).
\end{lemma}

\begin{proof}
    Soient \( g,h\in L^2\) tels que 
    \begin{equation}
        \int_Iu\varphi'=-\int_Ig\varphi=-\int_Ih\varphi
    \end{equation}
    pour tout \( \varphi\in C^{\infty}_c(I)\). Nous avons alors
    \begin{equation}
        \int_I(g-h)\varphi=0.
    \end{equation}
    Cela implique que \( g-h=0\) presque partout par la proposition \ref{PropUKLZZZh}\footnote{Ou alors par le lemme \ref{LemDQEKNNf} qui est moins général mais tout aussi bien pour ici.}.
\end{proof}

\begin{definition}
    Soit \( I=\mathopen] a , b \mathclose[\) un ouvert borné de \( \eR\). L'\defe{espace de Sobolev}{espace!de Sobolev} \( H^1(I)\)\nomenclature[Y]{\( H^1(I)\)}{espace de Sobolev} est l'ensemble
    \begin{equation}
        H^1(I)=\Big\{   u\in L^2(I)\tq\exists g\in L^2(I)\tq\forall \varphi\in  C^{\infty}_c(I),\int_Iu\varphi'=-\int_Ig\varphi   \Big\}.
    \end{equation}
\end{definition}
 
L'unique élément \( g\) de \( L^2(I)\) vérifiant \( \int_Iu\varphi'=-\int_Ig\varphi\) est noté \( u'\) est est nommé \defe{dérivée}{dérivée!dans Sobolev $ H^1(I)$}; nous verrons dans les prochaines pages pourquoi.

L'espace \( H^1\) accepte le produit scalaire suivant :
\begin{equation}
    \langle u, v\rangle =\int_Iuv+\int_Iu'v',
\end{equation}
et nous notons \( \| . \|_{H^1}\) la norme correspondante qui n'est autre que
\begin{equation}
    \| u \|_{H^1}=\langle u, u\rangle =\| u \|^2_{L^2}+\| u' \|_{L^2}.
\end{equation}

Nous introduisons l'espace \( L^1_{loc}(I)\)\nomenclature[Y]{\( L^1_{loc}(I)\)}{fonctions intégrables sur les compacts de \( I\)} des fonctions étant \( L^1\) sur tout compact de \( I\). 

\begin{proposition} \label{PropLGoLtcS}
    Si \( f\in L^1_{loc}(I)\) est telle que
    \begin{equation}
        \int_If\varphi'=0
    \end{equation}
    pour tout \( \varphi\in  C^{\infty}_c(I)\), alors il existe une constante \( C\) telle que \( f=C\) presque partout.
\end{proposition}

\begin{proof}
    Soit \( \psi\in C^{\infty}_c(I)\) une fonction d'intégrale \( 1\) sur \( I\). Si \( w\in C^{\infty}_c(I)\) alors nous considérons la fonction
    \begin{equation}
        h=w-\psi\int_Iw,
    \end{equation}
    qui est dans \(  C^{\infty}_c(I)\) et dont l'intégrale sur \( I\) est nulle. Par la proposition \ref{PropHFWNpRb}, la fonction \( h\) admet une primitive dans \(  C^{\infty}_c(I)\); et nous notons \( \varphi\) cette primitive. L'hypothèse appliquée à \( \varphi\) donne
    \begin{equation}
        0=\int_If\varphi'=\int_If\left( w-\psi\int_Iw \right)=\int_Ifw-\underbrace{\left( \int_If(x)\psi(x)dx \right)}_C\left( \int_Iw(y)dy \right)=\int_Iw(f-C).
    \end{equation}
    L'annulation de la dernière intégrale implique par la proposition \ref{PropUKLZZZh} que \( f-C=0\) dans \( L^2\), c'est à dire \( f=C\) presque partout.
\end{proof}

\begin{corollary}   \label{CorEVJYihj}
    Si \( u\in H^1(I)\) et si \( u'=0\) alors il existe une constant \( C\) telle que \( u=C\) presque partout.
\end{corollary}

\begin{proof}
    L'hypothèse \( u'=0\) signifie que pour tout fonction \( \varphi\in C^{\infty}_c(I)\),
    \begin{equation}
        \int_Iu\varphi'=\int_Iu'\varphi=0.
    \end{equation}
    La proposition \ref{PropLGoLtcS} nous dit alors qu'il existe une constante \( C\) telle que \( u=C\) presque partout.
\end{proof}

\begin{lemma}   \label{LemMPkbZxX}
    Tout élément de \( H^1(I)\) admet un unique représentant continu.
\end{lemma}
Nous verrons dans le corollaire \ref{CorCEPJGAu} que ce représentant pourra être prolongé par continuité sur \( \bar I\).

\begin{proof}
    Soit \( y_0\in I\) et \( u\in H^1(I)\). Nous considérons la fonction
    \begin{equation}
        \bar u(x)=\int_{y_0}^xu'(t)dt.
    \end{equation}
    Notons que par définition, \( u'\in L^2\) donc l'intégrale ne pose pas de problèmes. Montrons que \( \bar u\) est continue sur \( \bar I\). Pour cela nous considérons \( x\in\bar I\) et \( h\) tel que \( x+h\in \bar I\). Alors
    \begin{equation}
        \big| \bar u(x+h)-\bar u(x) \big|=\big| \int_x^{x+h}u' \big|\leq \int_x^{x+h}| u' |.
    \end{equation}
    Mais la fonction \( | u' |\) est dans \( L^1_{loc}(I)\) par le lemme \ref{LemTLHwYzD}; elle est en particulier intégrable sur un ouvert contenant \( x\) et par conséquent la dernière intégrale tend vers zéro lorsque \( h\) tend vers \( 0\).

    Nous prouvons à présent que \( \bar u\) est dans \( H^1(I)\) et que sa dérivée est égale à \( u'\); pour cela nous allons montrer que pour tout \( \varphi\in  C^{\infty}_c(I)\),
    \begin{equation}
        \int_I\bar u\varphi'=-\int_Iu'\varphi.
    \end{equation}
    Nous avons
    \begin{equation}
            \int_I\bar u\varphi'=\int_I\left( \int_{y_0}^xu'(t)dt\right)\varphi'(x)dx
            =\int_{a}^{y_0}\left( \int_{y_0}^xu'(t)dt\right)\varphi'(x)dx+\int_{y_0}^b\left( \int_{y_0}^xu'(t)dt\right)\varphi'(x)dx.
    \end{equation}
    Pour faire plus court, nous notons \( f(t,x)=u'(t)\varphi'(x)\). La première intégrale vaut
    \begin{subequations}
        \begin{align}
            \int_a^{y_0}\left( \int_{y_0}^x u'(t)\varphi'(x) \right)&=\int_a^{y_0}\left(\int_{y_0}^af(t,x)\mtu_{t<x}(t,x)dt\right)dx\\
            &=\int_{y_0}^a\int_a^{y_0}f(t,x)\mtu_{t>x}dxdt  \label{subeqBVyBPLp}\\
            &=\int_{y_0}^a\int_a^tf(t,x)dxdt\\
            &=-\int_a^{y_0}\int_a^tu'(t)\varphi'(x)dx\,dt
        \end{align}
    \end{subequations}
    La permutation d'intégrales pour obtenir \eqref{subeqBVyBPLp} est due au théorème de Fubini \ref{ThoFubinioYLtPI}\ref{ItemQMWiolgiii}. Par le même petit jeu, la seconde intégrale vaut
    \begin{equation}
        \int_{y_0}^b\int_t^b u'(t)\varphi'(x)dx\,dt.
    \end{equation}
    En refaisant la somme,
    \begin{subequations}
        \begin{align}
            \int_I\bar u\varphi'
            &=-\int_a^{y_0}u'(t)\left( \int_a^t\varphi'(x)dx \right)dt+\int_{y_0}^bu'(t)\left( \int_t^b\varphi'(x)dx \right)dt\\
            &=-\int_a^{y_0}u'(t)\big( \varphi(t)-\varphi(a) \big)dt+\int_{y_0}^bu'(t)\big( \varphi(b)-\varphi(t) \big)\\
            &=-\int_a^bu'\varphi\\
            &=-\int_Iu'\varphi.
        \end{align}
    \end{subequations}
    Notons que \( \varphi(a)=\varphi(b)=0\) parce que \( \varphi\) est à support compact dans \( \mathopen] a , b \mathclose[\). Nous avons donc prouvé que \( \bar u\) est dans \( H^1(I)\) et que \( \bar u'=u'\). Par le corollaire \ref{CorEVJYihj}, nous avons une constante \( C\) telle que \( \bar u=u+C\) presque partout, c'est à dire \( u=\bar u +C\) dans \( H^1(I)\). 

        En résumé, \( \tilde u\tilde u==\bar u+C\) est un représentant continu de \( u\) dans \( L^2(I)\).

        L'unicité du représentant continu est simplement le fait que deux fonctions continues égales presque partout sont égales (proposition  \ref{PropNCMToWI}).
    
\end{proof}

\begin{proposition}     \label{PropGWOIoDg}
    Si \( u\in H^1(I)\), alors
    \begin{equation}
        u(x)-u(y)=\int_y^xu'
    \end{equation}
    pour tout \( x,y\in I\).
\end{proposition}

\begin{proof}
    Pour fixer les idées, nous supposons \( x<y\). Nous considérons une suite \( \varphi_n\in C^{\infty}_c(I)\) convergeant uniformément sur \( I\) vers \( \mtu_{\mathopen[ x , y \mathclose]}\). Nous exigeons de plus que 
    \begin{itemize}
        \item 
        \( \varphi_n'\) est positive sur \( \mathopen[ a , x+\frac{1}{ n } \mathclose]\)
    \item
        \( \varphi_n'\) est négative sur \( \mathopen[ y-\frac{1}{ n } , b \mathclose]\) 
    \item
        \( \varphi_n=1\) sur \( \mathopen[ x+\frac{1}{ n } , y-\frac{1}{ n } \mathclose]\).
    \item
        \( \varphi_n=0\) sur \( \mathopen[ a , x-1/n \mathclose]\) et sur \( \mathopen[ y+1/n , b \mathclose]\).
    \end{itemize}
    Pour chaque \( n\), nous découpons l'intégrale comme
    \begin{equation}        \label{EqRPwqpve}
        -\int_Iu'\varphi_n=\int_Iu\varphi'_n=\int_a^{a-1/n}u\varphi'_n+\int_{x-1/n}^{x+1/n}u\varphi'_n+\int_{x+1/n}^{y-1/n}u\varphi'_n+\int_{y-1/n}^{y+1/n}u\varphi'_n+\int_{y+1/n}^{b}u\varphi'_n.
    \end{equation}
    Par construction de \( \varphi_n\), de ces \( 5\) morceaux, il n'en reste que deux de non nulles :
    \begin{equation}
        \int_Iu\varphi'=\underbrace{\int_{x-1/n}^{x+1/n}u(t)\varphi'_n(t)dt}_A+\underbrace{\int_{y-1/n}^{y+1/n}u(t)\varphi'_n(t)dt}_B
    \end{equation}

    Soit \( \epsilon>0\) et \( n\) suffisamment grand pour avoir \( u(t)\in B\big( u(x),\epsilon \big)\) pour tout \( t\in B(x,\frac{1}{ n })\) et (en même temps) \( u(t)\in B\big( u(y),\epsilon \big)\) pour tout \( t\in B(y,\frac{1}{ n })\). C'est la continuité de \( u\) qui permet de trouver un tel \( n\). Pour cette valeur de \( n\), en tenant compte des hypothèses sur la positivité de \( \varphi_n'\) nous avons
    \begin{equation}
        \int_{x-1/n}^{x+1/n}\big( u(x)-\epsilon \big)\varphi'_n(t)dt\leq\int_{x-1/n}^{x+1/n}u(t)\varphi'_n(t)dt\leq\int_{x-1/n}^{x+1/n}\big( u(x)+\epsilon \big)\varphi'_n(t)dt,
    \end{equation}
    mais par hypothèse sur \( \varphi_n\) nous trouvons
    \begin{equation}
        \int_{x-1/n}^{x+1/n}\varphi'_n(t)dt=\varphi_n(x+\frac{1}{ n })-\varphi(x+\frac{1}{ n })=1.
    \end{equation}
    donc
    \begin{equation}    \label{EqLYrpEdb}
        u(x)-\epsilon\leq\int_{x-1/n}^{x+1/n}u(t)\varphi'_n(t)dt\leq u(x)+\epsilon.
    \end{equation}
    Pour encadrer la seconde, il faut être plus prudent avec les signes parce que \( \varphi'_n\) y est négative. En posant \( \psi_n=-\varphi_n\) nous avons
    \begin{equation}
        -B=\int_{y-1/n}^{y+1/n}u(t)\psi_n(t)dt,
    \end{equation}
    et donc
    \begin{equation}
        u(y)-\epsilon\leq -B\leq u(y)+\epsilon
    \end{equation}
    ou encore
    \begin{equation}
        -\epsilon-u(y)\leq B\leq \epsilon-u(y).
    \end{equation}
    En additionnant avec \eqref{EqLYrpEdb} nous voyons que pour tout \( \epsilon>0\) il existe un \( N(\epsilon)\) tel que nous ayons
    \begin{equation}    \label{EqEBwWUxm}
        u(x)-u(y)-2\epsilon\leq\int_Iu'\varphi_{n}\leq u(x)-u(y)+2\epsilon
    \end{equation}
    pour tout \( n\geq N\). Nous voulons évidemment prendre la limite \( \epsilon\to 0\), c'est à dire \( n\to \infty\). Étant donné que \( \varphi_n(t)<1\) pour tout \( t\) et pour tout \( n\), la fonction \( t\mapsto u'(t)\varphi_n(t)\) est dominée par \( u'\), qui est dans \( L^1(I)\) par le lemme \ref{LemTLHwYzD}. Le théorème de la convergence dominée nous permet donc d'affirmer que
    \begin{equation}
        \lim_{n\to \infty} \int_Iu'\varphi_n=\int_Iu'\mtu_{[x,y]}=\int_x^yu',
    \end{equation}
    et donc les inégalités \eqref{EqEBwWUxm} donnent le résultat, grâce au signe dans \eqref{EqRPwqpve}.
\end{proof}

\begin{corollary}   \label{CorCEPJGAu}
    Si \( [u]\in H^1(I)\), le représentant continu \( u\in C^0(I)\) peut être prolongé par continuité en \( u\in C^0(\bar I)\).
\end{corollary}

\begin{proof}
    Soit \( (x_n)\) une suite strictement croissante dans \( \mathopen] a , b \mathclose[\) convergeant vers \( b\). Nous voulons montrer que la suite \( \big( u(x_n) \big)\) est de Cauchy dans \( \eR\), ce qui nous permettra de définir
        \begin{equation}
            u(b)=\lim_{n\to \infty} u(x_n).
        \end{equation}
        qui sera évidemment continue. Cette construction ne dépendra pas du choix de la suite \( (x_n)\) parce que deux fonctions continues sur \( \bar I\) et égales sur \( I\) sont égales sur \( \bar I\).

        En notant \( u'\) la dérivée de \( u\) dans \( H^1\), nous avons par construction du représentant continu : \( u(x)=\int_{y_0}^xu'(t)dt\). Et donc
        \begin{equation}
            \big| u(x_n)-u(x_{n+p}) \big|=\left| \int_{y_0}^{x_n}u'-\int_{y_0}^{x_{n+p}}u' \right| =\left| \int_{x_n}^{x_{n+p}}u' \right| .
        \end{equation}
        Vu que la suite \( (x_n)\) est de Cauchy et que \( u'\) est intégrable (même sur \( \bar I\)), la limite \( n\to\infty\) de cela est zéro, quelle que soit la valeur de \( p\). Donc \( \big( u(x_n) \big)\) est ce Cauchy dans \( \eR\) et est donc convergente.
\end{proof}
\index{prolongement!par continuité!dans \( H^1(I)\)}

\begin{proposition}[\cite{KXjFWKA}]     \label{ThoESIyxfU}
    Quelque propriétés de l'espace de Sobolev \( H^1(I)\) où \( I=\mathopen] a , b \mathclose[\) est un ouvert borné de \( \eR\).
    \begin{enumerate}
        \item
            \( H^1(I)\) est un espace de Hilbert.
        \item
            \( H^1(I)\) s'injecte de façon compacte dans \( C^0(\bar I)\).
        \item
            \( H^1(I)\) s'injecte de façon continue dans \( L^2(I)\).
    \end{enumerate}
\end{proposition}
\index{espace!de fonctions!Sobolev \( H^1\)}
\index{espace!de Hilbert!espace de Sobolev \( H^1\)}
\index{espace!\( L^2\)!Sobolev}
\index{dérivation!au sens des distribution!Sobolev}


\begin{proof}
    Nous prouvons point par point.
    \begin{enumerate}
        \item
            Le seul critère à vérifier est la complétude. Pour cela nous considérons une suite de Cauchy \( (u_n)\) dans \( H^1(I)\). Si \( \epsilon>0\), alors il existe \( N>0\) tel que pour tout \( p\geq 0\) nous ayons \( \| u_{n+p}-u_n \|_{H^1}^2\leq \epsilon\), c'est à dire
            \begin{equation}
                \| u_{n+p}-u_n \|^2_{L^2}+\| u'_{n+p}-u'_n \|^2_{L^2}+
            \end{equation}
            En particulier les suites \( (u_n)\) et \( (u'_n)\) sont de Cauchy dans \( L^2\) qui est complet par le théorème de Fischer-Riesz \ref{ThoGVmqOro}. Nous notons donc
            \begin{subequations}
                \begin{align}
                    u_n\stackrel{L^2}{\to}u\\
                    u'_n\stackrel{L^2}{\to}v.
                \end{align}
            \end{subequations}
            Nous allons démontrer les points suivants\quext{C'est le moment de lire l'énoncé du problème \ref{ProbTOElufz} et de m'écrire si vous avez une réponse.}
            \begin{itemize}
                \item \( u\in H^1(I)\) avec \( u'=v\).
                \item \( u_n\stackrel{H^1}{\to}u\).
            \end{itemize}
            Pour cela nous introduisons la dérivée faible de \( u\) dans \( L^2\), c'est à dire la forme linéaire continue \( \partial u\) sur \(  C^{\infty}_c(I)\) :
            \begin{equation}
                \begin{aligned}
                    \partial u\colon  C^{\infty}_c(I)&\to \eR \\
                    \varphi&\mapsto \langle \partial u, \varphi\rangle =-\int_Iu\varphi'. 
                \end{aligned}
            \end{equation}
            Pour tout \( \varphi\in C^{\infty}_c(I)\) nous avons
            \begin{subequations}
                \begin{align}
                \big| \langle \partial u, \varphi\rangle -\langle u_n', \varphi\rangle  \big|&=\left| -\int_Iu\varphi'-\int_Iu'_n\varphi \right| \\
                &=\left| -\int_Iu\varphi'-\int_Iu_n\varphi' \right| \\
            &\leq \int_I| u-u_n | |\varphi' |\\
            &\leq\| u-u_n \|_{L^2}\| \varphi' \|_{L^2}\,\text{Cauchy-Schwartz dans \( L^2\)}\\
            &\to 0.
                \end{align}
            \end{subequations}
            À la première ligne, la première intégrale est la définition de l'action de la forme \( \partial u\) sur \( \varphi\) alors que la seconde est seulement un produit scalaire dans \( L^2\). Tout deux sont notés avec les crochets. En tant que limite dans \( \eR\) nous avons
            \begin{equation}
                \lim_{n\to \infty} \langle u'_n, \varphi\rangle =\langle \partial u, \varphi\rangle .
            \end{equation}
            Dans le calcul suivant, les deux crochets sont des produits scalaires dans \( L^2\) :
            \begin{subequations}
                \begin{align}
                \big| \langle u_n', \varphi\rangle -\langle v, \varphi\rangle  \big|&=\left| -\int_Iu'_n\varphi-\int_Iv\varphi \right| \\
            &\leq \int_I| u'_n-v| |\varphi |\\
            &\leq\| u'_n-v \|_{L^2}\| \varphi \|_{L^2}\\
            &\to 0.
                \end{align}
            \end{subequations}
            Donc en tant que limite dans \( \eR\),
            \begin{equation}
                \lim_{n\to \infty} \langle u'_n, \varphi\rangle =\langle v, \varphi\rangle .
            \end{equation}
            Par unicité de la limite nous en déduisons que pour tout \( \varphi\in C^{\infty}_c(I)\),
            \begin{equation}
                \langle \partial u, \varphi\rangle =\langle v, \varphi\rangle .
            \end{equation}
            Encore une fois nous répétons qu'à gauche le crochet est l'application de la forme \( \partial u\) sur \( \varphi\) tandis qu'à droite c'est le produit scalaire dans \( L^2\). 

            Nous sommes maintenant à même de prouver que \( u\in H^1(I)\) et que sa dérivée (au sens de \( H^1\)) est \( v\). En effet
            \begin{equation}
                \int_Iu\varphi'=-\langle \partial u, \varphi\rangle =-\langle v, \varphi\rangle =-\int_Iv\varphi.
            \end{equation}
            Par conséquent nous avons \( u'=v\) dans \( H^1\) et aussi \( u'=v\) presque partout au sens des fonctions.

            Nous pouvons alors prouver que \( u_n\to u\) dans \( H^1(I)\) :
            \begin{equation}
                \| u_n-u \|^2_{H^1(I)}=\| u_n-u \|^2_{L^2}+\| u'_n-u' \|_{L^2}^2.
            \end{equation}
            Mais nous savons déjà que \( u_n\to u\) dans \( L^2\) (d'ailleurs c'est la définition de \( u\)) et que \( u'=v\) alors que par définition de \( v\), nous avons \( u'_n\to v\) dans \( L^2\). Tout cela donne que \( u_n\to u\) dans \( H^1(I)\) et donc que \( H^1(I)\) est un espace complet.

        \item

            L'application que nous allons prouver être compacte entre \( H^1(I)\) et \( C^0(\bar I)\) est
            \begin{equation}
                \begin{aligned}
                    \psi\colon H^1(I)&\to C^0(\bar I) \\
                    [u]&\mapsto \tilde u 
                \end{aligned}
            \end{equation}
            où \( [u]\) désigne une classe de fonction dans \( H^1(I)\) et \( \tilde u\) est son représentant continu prolongé par continuité à \( \bar I\)\footnote{Encore que par soucis d'économie d'encre nous n'allons pas écrire toujours les tildes et noter \( u\) le représentant continu prolongé à \( \bar I\) par le corollaire \ref{CorCEPJGAu}.}, qui existe par le lemme \ref{LemMPkbZxX} et le corollaire \ref{CorCEPJGAu}. Cette application est une injection par l'unicité du représentant continu. Nous allons prouver que c'est une application compacte en utilisant le critère \ref{ItemJIkpUbLii} de la proposition \ref{PropDGsPtpU}. Pour cela nous allons commencer par utiliser le théorème d'Ascoli sur l'ensemble \( \tilde \mB\) des représentants continus des éléments de \( \mB\), prolongés par continuité sur \( \bar I\); c'est à dire \( \tilde B\subset C^0(\bar I)\).

            Soit \( u\in \tilde \mB\); par la proposition \ref{PropGWOIoDg}, nous avons
            \begin{subequations}
                \begin{align}
                    \big| u(x)-u(y) \big|&=\big| \int_y^xu'(t)dt \big|\\
                    &=\left| \int_I\mtu_{[x,y]}(t)u'(t)dt \right| \\
                    &\leq\| \mtu_{\mathopen[ x , y \mathclose]} \|_{L^2}\| u' \|_{L^2}\\
                    &\leq\sqrt{| x-y |}\| u' \|_{H^1}\\
                    &\leq\sqrt{| x-y |}.
                \end{align}
            \end{subequations}
            où nous insistons sur le fait que la continuité n'impliquant pas la dérivabilité, le \( u'\) ici est la dérivé au sens de \( H^1\), et non la dérivée usuelle. Quoi qu'il en soit, l'ensemble \(\tilde  \mB\) est équicontinu\footnote{Définition \ref{DefUWmVBcZ}}. Nous montrons à présent qu'il est également borné pour la norme uniforme. Soit \( u\in\tilde \mB\); vu la construction du représentant continu au lemme \ref{LemMPkbZxX}, nous avons
            \begin{subequations}
                \begin{align}
                \big| u(x) \big|&=\left| \frac{1}{ b-a }\int_a^bu(x)dy \right| \\
                &=\left| \frac{1}{ b-a }\int_a^b\left( \int_y^xu'(t)dt-u(y) \right)dy \right| \\
                &=\left| \frac{1}{ b-a }\int_a\int_y^xu'(t)dtdy-\frac{1}{ b-a }\int_a^b u(y)dy \right| \\
                &\leq\frac{1}{ b-a }\int_a^b\int_a^b| u'(t) |dt\,dy+\frac{1}{ b-a }\int_a^b| u(y) |dy \label{EqCFwSOxh}.
                \end{align}
            \end{subequations}
            À ce niveau, il faut remarquer que dans la première intégrale, le passage de la valeur absolue à l'intérieur de l'intégrale en même temps que l'élargissement des bornes n'a rien d'innocent. Si \( x<y\), les bornes ne sont pas «dans le bon ordre» et nous ne pouvons pas faire la majoration usuelle en entrant simplement la valeur absolue. Ici nous tenons compte de cela en élargissant les bornes, et en les mettant dans le bon ordre. Le passage exact est le suivant : si \( x,y\in\mathopen] a , b \mathclose[\), nous avons
                \begin{equation}
                \left| \int_y^xf(t)dt \right| \leq\left| \int_y^x| f(t) |dt \right| \leq\left| \int_a^b| f(t) |dt \right| =\int_a^b| f(t) |dt.
                \end{equation}
                Notons en particulier que dans le cas du passage vers l'équation \eqref{EqCFwSOxh}, le nombre \( x\) est fixé alors que \( y\) est une variable d'intégration. Donc l'ordre des deux est certainement de temps en temps le «mauvais».

                Quoi qu'il en soit, la première intégrale se réduit à une multiplication par \( b-a\) et le calcul continue :
                \begin{subequations}
                    \begin{align}
                        \big| u(x) \big|&\leq \int_I| u'(t) |dt+\frac{1}{ b-a }\int_I| u |\\
                        &\leq \sqrt{b-a}\| u' \|_{L^2}+\frac{1}{ \sqrt{b-a} }\| u \|_{L^2}\\
                        &\leq\left( \sqrt{b-a}+\frac{1}{ \sqrt{b-a} } \right)\big( \| u' \|_{L^2}+\| u \|_{L^2} \big)\\
                        &\leq\left( \sqrt{b-a}+\frac{1}{ \sqrt{b-a} } \right) \| u \|_{H^1}\\
                        &= \sqrt{b-a}+\frac{1}{ \sqrt{b-a} }.
                    \end{align}
                \end{subequations}
                Donc \( \tilde \mB\) est borné pour la norme \( L^{\infty}\). Et c'est même borné par un nombre facilement calculable connaissant \( I\). En particulier l'ensemble
                \begin{equation}
                    \{ u(x)\tq u\in H^1 \}
                \end{equation}
                est pour, tout \( x\), contenu dans la boule de rayon \( \sqrt{a-b}+\frac{1}{ \sqrt{a-b} }\) et donc est relativement compact dans \( \eR\). Par conséquent le théorème d'Ascoli \ref{ThoKRbtpah} nous dit que l'ensemble \( \tilde B\) est relativement compact dans \( C^0(I)\).

                Par conséquent nous avons montré que l'image par \( \psi\) de la boule unité fermée \( \mB\) de \( H^1(I)\) est relativement compacte dans \( C^0(\bar I)\), ce qui signifie que \( \psi\) est une application compacte.


            \item

                Les éléments de \( H^1(I)\) sont des éléments de \( L^2(I)\); donc l'identité est une injection. Nous devons seulement étudier la continuité. Si \( (u_n)\) est une suite dans \( H^1\) convergeant dans \( H^1\) vers \( u\), alors
                \begin{equation}
                    \| u_n-u \|_{L^2}\leq\| u_n-u \|_{L^2}+\| u'_n-u' \|_{L^2}=\| u_n-u \|_{H^1}\to 0.
                \end{equation}
                Donc la suite des images (par l'identité) converge dans \( L^2\). L'identité est donc continue.

    \end{enumerate}
    
\end{proof}

\begin{probleme}    \label{ProbTOElufz}
    Au point de la preuve auquel vous devriez être si vous lisez ceci, vous pourriez avoir envie de démontrer \( u'=v\) de la façon suivante :
    \begin{equation}
        \int_I u\varphi'=\lim_{n\to \infty} \int_Iu_n\varphi=-\lim_{n\to \infty} \int_Iu'_n\varphi=-\int_Iv\varphi.
    \end{equation}
    J'avoue ne pas trouver d'exemples pour lesquels ça ne marche pas. Est-ce qu'on peut inverser la limite et l'intégrale dans \( L^2\) ?

    Ceci n'invalide pas la preuve donnée, mais ça suggère un sacré raccourcis.
\end{probleme}


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Théorèmes de Hahn-Banach}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



\begin{theorem}[Hahn-Banach\cite{brezis,TQSWRiz}]
    Soit \( E\), un espace vectoriel réel et une application \( p\colon E\to \eR\) satisfaisant
    \begin{enumerate}
        \item
            \( p(\lambda x)=\lambda p(x)\) pour tout \( x\in E\) et pour tout \( \lambda>0\),
        \item
            \( p(x+y)\leq p(x)+p(y)\) pour tout \( x,y\in E\).
    \end{enumerate}
    Soit de plus \( G\subset E\) un sous-espace vectoriel muni d'une application \( g\colon G\to \eR\) vérifiant \( g(x)\leq p(x)\) pour tout \( x\in G\). Alors il existe \( f\in\aL(E,\eR)\) telle que \( f(x)=g(x)\) pour tout \( x\in G\) et \( f(x)\leq p(x)\) pour tout \( x\in E\).
\end{theorem}
\index{théorème!Hahn-Banach}

\begin{proof}
    Si \( h\) une application linéaire définie sur un sous-espace de \( E\), nous notons \( D_h\) ledit sous-espace. 
    
    \begin{subproof}
    \item[Un ensemble inductif]

        Nous considérons \( P\), l'ensemble des fonctions linéaires suivant 
        \begin{equation}
            P=\Big\{  h\colon D_h\to \eR\tq
            \begin{cases}
                G\subset D_h\\
                h(x)=g(x)&\forall x\in G\\
                h(x)\leq p(x)&\forall x\in D_h
            \end{cases}
        \Big\}
        \end{equation}
        Cet ensemble est non vide parce que \( g\) est dedans. Nous le munissons de la relation d'ordre \( h_1\leq h_2\) si et seulement si \( D_{h_1}\subset D_{h_2}\) et \( h_2\) prolonge \( h_1\). Nous montrons à présent que \( P\) est un ensemble inductif. Soit un sous-ensemble totalement ordonné \( Q\subset P\); nous définissons une fonction \( h\) de la façon suivante. D'abord \( D_h=\sup_{l\in Q}D_l\) et ensuite
        \begin{equation}
            \begin{aligned}
                h\colon D_h&\to \eR \\
                x&\mapsto l(x)&\text{si \( x\in D_l\)}
            \end{aligned}
        \end{equation}
        Cela est bien définit parce que si \( x\in D_l\cap D_{l'}\) alors, vu que \( Q\) on a obligatoirement \( D_l\subset D_{l'}\) et \( l'\) qui prolonge \( l\) (ou le contraire) parce que \( Q\) est totalement ordonné (i.e. \( l\leq l'\) ou \( l'\leq l\)). Donc \( h\) est un majorant de \( Q\) dans \( P\) parce que \( h\geq l\) pour tout \( l\in Q\). Cela montre que \( P\) est inductif (définition \ref{DefGHDfyyz}). Le lemme de Zorn \ref{LemUEGjJBc} nous dit alors que \( P\) possède un maximum \( f\) qui va être la réponse à notre théorème.

    \item[Le support de \( f\)]

        La fonction \( f\) est dans \( P\); donc \( f(x)\leq p(x)\) pour tout \( x\in D_h\) et \( f(x)=g(x)\) pour tout \( x\in G\). Pour terminer nous devons montrer que \( D_f=E\). Supposons donc que \( D_f\neq E\) et prenons \( x_0\notin D_f\). Nous allons contredire la maximalité de \( f\) en considérant la fonction \( h\) donnée par \( D_h=D_f+\eR x_0 \) et
        \begin{equation}
            h(x+tx_0)=f(x)+t\alpha
        \end{equation}
        où \( \alpha\) est une constante que nous allons fixer plus tard.

        Nous commençons par prouver que \( f\) est dans \( P\). Nous devons prouver que
        \begin{equation}    \label{EqOIXrlFe}
            h(x+tx_0)=f(x)+t\alpha\leq p(x+tx_0)
        \end{equation}
        Pour cela nous allons commencer par fixer \( \alpha\) pour avoir les relations suivantes :
        \begin{subequations}    \label{EqMDNkcQk}
            \begin{numcases}{}
                f(x)+\alpha\leq p(x+x_0)    \label{EqDYmRWEY}\\
                f(x)-\alpha\leq p(x-x_0)
            \end{numcases}
        \end{subequations}
        pour tout \( x\in D_f\). Ces relations sont équivalentes à demander \( \alpha \) tel que
        \begin{subequations}
            \begin{numcases}{}
                \alpha\leq p(x+x_0)-f(x)\\
                \alpha\geq f(x)-p(x-x_0)
            \end{numcases}
        \end{subequations}
        Nous nous demandons donc si il existe un \( \alpha\) qui satisfasse
        \begin{equation}
            \sup_{y\in D_f}\big( f(y)-p(y-x_0) \big)\leq \alpha\leq \inf_{z\in D_f}\big( p(z+x_0)-f(z) \big).
        \end{equation}
        Ou encore nous devons prouver que pour tout \( y,z\in D_f\),
        \begin{equation}
            p(z+x_0)-f(x)\geq f(y)-p(y-x_0)\geq 0.
        \end{equation}
        Par les propriétés de \( p\) et de \( f\),
        \begin{equation}
        p(z+x_0)+p(y-x_0)-f(z)-f(y)\geq p(z+y)-f(z+y)\geq 0.
        \end{equation}
        La dernière inégalité est le fait que \( f\in P\). Un choix de \( \alpha\) donnant les inéquations \eqref{EqMDNkcQk} est donc possible.
        
        À partir des inéquations \eqref{EqMDNkcQk} nous obtenons la relation \eqref{EqOIXrlFe} de la façon suivante. Si \( t>0\) nous multiplions l'équation \eqref{EqDYmRWEY} par \( t\) :
        \begin{equation}
            tf(x)+t\alpha\leq tp(x+x_0).
        \end{equation}
        Et nous écrivons cette relation avec \( x/t\) au lieu de \( x \) en tenant compte de la linéarité de \( f\) :
        \begin{equation}
            f(x)+t\alpha\leq  tp\big( \frac{ x }{ t }+x_0 \big)=p(x+tx_0).
        \end{equation}
        Avec \( t<0\), c'est similaire, en faisant attention au sens des inégalités.
        
        Nous avons donc construit \( h\colon D_h\to \eR\) avec \( h\in P\), \( D_f\subset D_h\) et \( h(x)=f(x)\) pour tout \( x\in D_f\). Cela pour dire que \( h>f\), ce qui contredit la maximalité de \( f\). Le domaine de \( f\) est donc \( E\) tout entier.

        La fonction \( f\) est donc une fonction qui remplit les conditions.

    \end{subproof}
\end{proof}

\begin{definition}  \label{DefPJokvAa}
    Un espace topologique est \defe{localement convexe}{convexe!localement} si tout point possède un système fondamental de voisinages formé de convexes.
\end{definition}
%TODO : il faudrait parler de système fondamental de voisinages.

\begin{definition}[Hyperplan qui sépare]
    Soit \( E\) un espace vectoriel topologique ainsi que \( A\), \( B\) des sous-ensembles de \( E\). Nous disons que l'hyperplan d'équation \( f=\alpha\) \defe{sépare au sens large}{hyperplan!séparer!au sens large} les parties \( A\) et \( B\) si \( f(x)\leq \alpha\) pour tout \( x\in A\) et \( f(x)\geq \alpha\) pour tout \( x\in B\).

    La séparation est \defe{au sens strict}{hyperplan!sépare!au sens strict} su il existe \( \epsilon>0\) tel que 
    \begin{subequations}
        \begin{align}
            f(x)\leq \alpha-\epsilon&&\text{pour tout \( x\in A\)}\\
            f(x)\geq \alpha+\epsilon&&\text{pour tout \( x\in B\)}.
        \end{align}
    \end{subequations}
\end{definition}

\begin{theorem}[Haha-Banach, première forme géométrique\cite{TQSWRiz}]  \label{ThoSAJjdZc}
    Soit \( E\) un espace vectoriel topologique et \( A\), \( B\) deux convexes non vides disjoints de \( E\). Si \( A\) est ouvert, il existe un hyperplan fermé qui sépare \( A\) et \( B\) au sens large.
\end{theorem}

\begin{theorem}[Hahn-Banach, seconde forme géométrique] \label{ThoACuKgtW}
    Soit un espace vectoriel topologique localement convexe\footnote{Définition \ref{DefPJokvAa}.} ainsi que des convexes non vides disjoints \( A\) et \( B\) tels que \( A\) soit compact et \( B\) soit fermé. Alors il existe un hyperplan fermé qui sépare strictement \( A\) et \( B\).
\end{theorem}

\begin{proof}
    Vu que \( B\) est fermé, \( A\) est dans l'ouvert \( E\setminus B\). Donc si \( a\in A\), il existe un voisinage ouvert convexe de \( a\) inclus à \( A\). Soit \( U_a\) un voisinage ouvert et convexe de \( 0\) tel que \( (a+U_a)\cap B=\emptyset\).

    Vu que la fonction \( (x,y)\mapsto x+y\) est continue, nous pouvons trouver un ouvert convexe \( V_a\) tel que \( V_a+V_a\subset U_a\). L'ensemble \( a+V_a\) est alors un voisinage ouvert de \( a\) et bien entendu \( \bigcup_a(a+V_a)\) recouvre \( A\) qui est compact. Nous en extrayons un sous-recouvrement fini, c'est à dire que nous considérons \( a_1,\ldots, a_n\in A\) tels que
    \begin{equation}
        A\subset \bigcup_{i=1}^n(a_i+V_{a_i}).
    \end{equation}
    Nous posons alors 
    \begin{equation}
        V=\bigcap_{i=1}^nV_{a_i}.
    \end{equation}
    Cet ensemble est non vide parce et il contient un voisinage de zéro parce que c'est une intersection finie de voisinages de zéro. Soit \( x\in A+V\). Il existe \( i\) tel que 
    \begin{equation}
        x\in a_i+U_{a_i}+V\subset a_i+V_{a_i}+V_{a_i}\subset a_i+U_{a_i}\subset E\setminus B.
    \end{equation}
    Donc \( (A+V)\cap B=\emptyset\). L'ensemble \( A+V\) est alors un ouvert convexe disjoint de \( B\). Par la première forme géométrique du théorème de Hahn-Banach \ref{ThoSAJjdZc} nous avons un hyperplan qui sépare \( A+V\) de \( B\) au sens large : il existe \( f\in E'\setminus\{ 0 \}\) tel que \( f(a)+f(v)\leq f(b)\) pour tout \( a\in A\), \( v\in V\) et \( b\in B\). 
    
    Il suffit donc de trouver un \( v\in V\) tel que \( f(v)\neq 0\) pour avoir la séparation au sens strict. Cela est facile : \( V\) étant un voisinage de zéro et \( f\) étant linéaire, si elle était nulle sur \( V\), elle serait nulle sur \( E\).
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Distributions}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Topologie}
%---------------------------------------------------------------------------------------------------------------------------

Soit \( \Omega\) un ouvert de \( \eR^d\). Le but de notre histoire est de définir une distribution comme étant un élément de l'espace dual (topologique, voir définition \ref{DefJPGSHpn}) de l'espace \( \swD(\Omega)\) des fonctions \( C^{\infty}\) à support compact dans \( \Omega\). Pour ce faire nous devons voir un peu de topologie sur différents espaces de fonctions. Notons que cet espace n'est pas réduit à la fonction nulle comme en témoigne l'exemple donné par l'équation \eqref{EqOBYNEMu}.

Pour chaque \( K\) compact dans \( \Omega\) et \( m\in \eN\) nous considérons sur \(  C^{\infty}(\Omega)\) la semi-norme suivante :
\begin{equation}
    p_{K,m}(f)=\sum_{j=0}^m\| f^{(j)} \|_{K,\infty}.
\end{equation}
%TODO : prouver que ce sont des msemi-normes.
En particulier,
\begin{equation}
    p_{K,0}(f)=\sup_{x\in K}| f(x) |.
\end{equation}
La topologie de \(  C^{\infty}(\Omega)\) est la topologie donnée par ces semi-normes. La topologie de \( \swD(\Omega)\) est la topologie induite depuis celle de \(  C^{\infty}(\Omega)\). Cela n'est pas très explicite, mais heureusement nous n'aurons souvent pas besoin de plus que de la notion de convergence dans \( \swD'(\Omega)\). Rappelons que la topologie d'un espace donne la notion de convergence par la définition \ref{DefIQbkyDP}.

\begin{lemma}   \label{LemWEGpemo}
    Si une fonction \( f\colon \swD(\Omega)\to \eR\) est continue sur chacun des \( \swD(K)\) pour tout \( K\) compact dans \( \Omega\) alors est continue sur \( \swD(\Omega)\).
\end{lemma}

\begin{proof}
    Soit \( I\) ouvert dans \( \eR\); nous devons trouver un ouvert \( \mO\) dans \(  C^{\infty}(\Omega)\) tel que \( f^{-1}(I)=\swD(\Omega)\cap\mO\). Vu que \( f\) est continue sur chacun des \( \swD(K)\) avec \( K\) compact dans \( \Omega\), pour tout tel compact nous avons un ouvert \( \mO_K\) dans \( \swD(K)\) tel que \( f^{-1}(I)\cap \swD(K)=\mO_K\). En tant qu'union d'ouverts\footnote{Voir définition \ref{DefTopologieGene}.}, l'ensemble
    \begin{equation}
        \mO=\bigcup_{\text{\( K\) compact de \( \Omega\)}}\mO_K
    \end{equation}
    est ouvert dans \(  C^{\infty}(\Omega)\). Si \( \phi\inf^{-1}(I)\), nous avons \( \phi\in\swD(K)\) pour un certain \( K\) compact de \( \Omega\), donc \( f^{-1}(I)\subset\mO\). A forciori nous avons \( f^{-1}(I)\subset\mO\cap\swD(\Omega)\).

    Dans l'autre sens, si \( \phi\in\mO\), alors \( \phi\) est dans un des \( \mO_K\) et donc dans \( f^{-1}(I)\). Nous avons donc bien \( f^{-1}(I)=\swD(\Omega)\cap \mO\).
\end{proof}

\begin{theorem}[Convergence dans \( \swD(\Omega)\)\cite{TQSWRiz}]       \label{ThoXYADBZr}
    Soit \( (\varphi_n)_{n\in \eN}\) une suite dans \( \swD(\Omega)\) et \( \varphi\in\swD(\Omega)\). Nous avons \( \varphi_n\stackrel{\swD(\Omega)}{\longrightarrow}\varphi\) si et seulement si il existe \( K\) compact dans \( \Omega\) tel que \( \varphi_n\in\swD(K)\) pour tout \( n\) et \( \varphi_n\stackrel{\swD(K)}{\longrightarrow}\varphi\).
\end{theorem}

\begin{proof}
    Supposons que \( \varphi_n\stackrel{\swD(\Omega)}{\longrightarrow}\varphi\) et qu'il n'existe pas de compacts contenant tous les supports des \( \varphi_n\). Alors pour tout compact de \( \Omega\) il existe un \( n\) tel que le support de \( \varphi_n\) ne soit pas dans \( K\). Nous considérons une suite de compacts \( (K_i)\) tels que \( \Int(K_n)\subset K_{n+1}\) et \( \Omega=\bigcup_nK_n\). Une telle suite existe par le lemme \ref{LemGDeZlOo}. Ensuite nous construisons des sous-suites de la façon suivante. D'abord \( L_1=K_1\) et \( n_1\in \eN\) est choisit de telle sorte que \( \varphi_{n_1}\) ait un support non contenu dans \( L_1\). Ensuite \( L_i\) est un compact de la suite \( (K_n)\) choisit plus loin que \( L_{i-1}\) et tel que \( \varphi_{n_{i-1}}\in \swD(L_i)\). Le nombre \( n_{i}\) est alors choisit plus grand que \( n_{i-1}\) de telle sorte que \( \varphi_{n_i}\notin\swD(L_i)\). Ce faisant, en posant \( \phi_i=\varphi_{n_i}\) nous avons
    \begin{equation}
        \phi_i\in\swD(L_{i+1})\setminus\swD(L_i)
    \end{equation}
    et \( \Int(L_n)\subset L_{n+1}\) et \( \Omega=\bigcup_nL_n\). Étant donné que \( (\phi_i)\) et une sous-suite de \( (\varphi_i)\) nous avons encore \( \phi_i\stackrel{\swD(\Omega)}{\longrightarrow}\varphi\).

    Soit \( i\in \eN\). Nous allons utiliser la seconde forme géométrique du théorème de Hahn-Banach \ref{ThoACuKgtW} pour séparer les parties \( \{ \phi_i \}\) (compact) et \( \swD(L_i)\) (fermé) dans \( \swD(\Omega)\). Nous avons \( f_i\in \swD'(\Omega)\) telle que 
    \begin{subequations}
        \begin{numcases}{}
            f_i(\phi_i)>\alpha\\
            f\big( \swD(L_i) \big)<\alpha. 
        \end{numcases}
    \end{subequations}
    Nous redéfinissons immédiatement \( f_i\) de façon à avoir
    \begin{subequations}
        \begin{numcases}{}
            f_i(\phi_i)=0\\
            f\big( \swD(L_i) \big)<0.
        \end{numcases}
    \end{subequations}

    Nous introduisons la fonction définie sur \( \swD(\Omega)\) par
    \begin{equation}    \label{EqJCqeXti}
        p(\phi)=\sum_{i=1}^{\infty}i\frac{ f_i(\phi) }{ | f_i(\phi_i) | }.
    \end{equation}
    Si \( \phi\in L_k\), alors \( f_k(\phi)=0\) et même \( f_{l}(\phi)=0\) pour tout \( l\geq k\). Donc pour chaque \( k\), la somme définissant \( p\) est finie sur \( \swD(L_k)\). Nous en déduisons que \( p\) est continue sur chacun des \( \swD(L_k)\) et donc sur \( \swD(\Omega)\) par le lemme \ref{LemWEGpemo}.

    L'image de la suite convergente \( \phi_k\stackrel{\swD(\Omega)}{\longrightarrow}\varphi\) par \( p\) doit être bornée parce que \( p\) est continue. Mais dans la somme  \eqref{EqJCqeXti}, tous les termes sont positifs et en particulier le terme \( i=k\) vaut \( k\), donc \( p(\phi_k)\geq k\), ce qui contredit le fait que l'image de la suite soit bornée. Nous en déduisons donc l'existence d'un compact \( K\) tel que \( \varphi_n\in \swD(K)\) pour tout \( n\).

    Nous devons encore prouver que \( \varphi_n\stackrel{\swD(K)}{\to}\varphi\) pour ce choix de \( K\). Vu que \( \varphi_n\stackrel{\swD(\Omega)}{\longrightarrow}\varphi\), le lemme \ref{LemPESaiVw} nous dit que nous avons aussi \( \varphi_n\stackrel{ C^{\infty}(\Omega)}{\longrightarrow}\varphi\), ce qui signifie que pour tout \( K\) et \( m\) nous avons
    \begin{equation}
        p_{K,m}(\varphi_n-\varphi)\to 0.
    \end{equation}
    En particulier pour le \( K\) fixé plus haut nous avons \( p_m(\varphi_n-\varphi)\to 0\), c'est à dire que \( \varphi_n\stackrel{\swD(K)}{\longrightarrow}\varphi\).
    
\end{proof}

\begin{definition}[Convergence dans \( \swD(\Omega)\)]
    Nous avons \( f_n\stackrel{\swD'(\Omega)}{\longrightarrow}f\) si et seulement si \( f_n(\varphi)\to f(\varphi)\) pour tout \( \varphi\in\swD(\Omega)\).
\end{definition}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Espaces duaux}
%---------------------------------------------------------------------------------------------------------------------------

Si \( \Omega\) est un ouvert de \( \eR^d\), alors l'ensemble \( \swD(\Omega)\) est contenu dans \(  C^{\infty}(\Omega)\). Nous allons commencer par définir une topologie sur \(  C^{\infty}(\Omega)\) et ensuite donner à \( \swD(\Omega)\) la topologie induite\footnote{Définition \ref{DefVLrgWDB}.}.

\begin{definition}[Distribution]    \label{DefPZDtWVP}
    Une \defe{distribution}{distribution} sur un ouvert \( \Omega\) de \( \eR^d\) est une forme linéaire continue sur \(\swD(\Omega)= C^{\infty}_c(\Omega)\)\nomenclature[Y]{\( \swD(\Omega)\)}{Les fonctions \( C^{\infty}\) à support compact sur \( \Omega\)}. C'est donc un élément de \( \swD'(\Omega)\).
\end{definition}

Le théorème suivant donne quelque façons de vérifier qu'une forme linéaire soit continue.
\begin{theorem}[\cite{TQSWRiz,RIOTOaj}] \label{ThoVDDBnVn}
    Soit \( T\) une forme linéaire sur \( \swD(\Omega)\). Nous avons équivalence entre les points suivants.
    \begin{enumerate}
        \item
            \( T\) est continue.
        \item
            Pour tout compact \( K\subset \Omega\)m il existe \( m\in \eN\) et \( C\geq 0\) tel que pour tout \( \varphi\in\swD(K)\) nous ayons
            \begin{equation}
                \big| T(\varphi) \big|\leq p_{m,K}(\varphi).
            \end{equation}
        \item
            \( T\) est séquentiellement continue sur \( \swD(\Omega)\).
        \item
            \( T\) est séquentiellement continue en \( 0\).
        \item
            Pour tout compact \( K\subset \Omega\), la restriction de \( T\) à \( \swD(K)\) est continue.
    \end{enumerate}
\end{theorem}

\begin{definition}
    Nous munissons l'espace \( \swD'(\Omega)\) de la \defe{topologie \( *\)-faible}{topologie!$*$-faible}, c'est à dire celle de la famille de semi-normes
    \begin{equation}
        \begin{aligned}
            p_{\varphi}\colon \swD'(\Omega)&\to \eR \\
            T&\mapsto \big| T(\varphi) \big|. 
        \end{aligned}
    \end{equation}
\end{definition}
Oui, c'est bien une famille de semi-normes indicée par l'ensemble \( \swD'(\Omega)\). Il n'y en a donc a priori pas du tout une quantité dénombrable.

\begin{proposition}[Convergence au sens des distributions]
    Nous avons \( T_n\stackrel{\swD'(\Omega)}{\longrightarrow}T\) si et seulement si \( T_n(\varphi)\to T(\varphi)\) pour tout \( \varphi\in\swD(\Omega)\).
\end{proposition}

\begin{proof}
    La convergence \( T_n\stackrel{\swD'(\Omega)}{\longrightarrow}T\) signifie que l'on ait \( p_{\varphi}(T_n-T)\to 0\) pour tout \( \varphi\in\swD(\Omega)\), ce qui en retour signifie que
    \begin{equation}
        \big| (T_n-T)(\varphi) \big|\to 0.
    \end{equation}
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Espaces de Schwartz}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour un multiindice \( \alpha=(\alpha_1,\ldots, \alpha_d)\in \eN^d\), nous notons
\begin{equation}
    \partial^{\alpha}\varphi=\partial_{x_1}^{\alpha_1}\ldots\partial_{x_d}^{\alpha_d}\varphi
\end{equation}
pour peu que la fonction \( \varphi\) soit \( | \alpha |=\alpha_1+\ldots +\alpha_d\) fois dérivable.

\begin{definition}
    L'\defe{espace de Schwartz}{espace!de Schwartz} est l'ensemble des fonctions infiniment dérivables dont toutes les dérivées décroissent plus vite que tout polynôme :
    \begin{equation}
        \swS(\eR^d)=\big\{   \varphi\in C^{\infty}(\eR^d)\tq\forall \alpha,\beta\in \eN^d, p_{\alpha,\beta}(\varphi)<\infty   \big\}
    \end{equation}
    où nous avons considéré
    \begin{equation}    \label{EqOWdChCu}
        p_{\alpha,\beta}(\varphi)=\sup_{x\in \eR^d}| x^{\beta}(\partial^{\alpha}\varphi)(x) |=\| x^{\beta}\partial^{\alpha}\varphi \|_{\infty}.
    \end{equation}
    Une fonction \( \varphi\in\swS(\eR^d)\) est dite à \defe{décroissance rapide}{fonction!à décroissance rapide}.
\end{definition}

Pour simplifier les notations (surtout du côté de Fourier), nous allons parfois écrire \( M_i\varphi\)\nomenclature[Y]{\( M_i\varphi\)}{La fonction \( x\mapsto x_i\varphi(x)\)} pour la fonction \( x\mapsto x_i\varphi(x)\).

\begin{example}
    La fonction \(  e^{-x^2}\) est une fonction à décroissance rapide sur \( \eR\).
\end{example}

\begin{proposition} \label{PropCSmzwGv}
    Une fonction à décroissance rapide décrois plus vite que n'importe quel polynôme\footnote{D'où le nom des fonctions à décroissance rapide.}. Plus précisément, si \( \varphi\in\swS(\eR^d)\), pour tout polynôme \( Q\), il existe un \( r>0\) tel que \(  | \varphi(x) |<\frac{1}{ | Q(x) | } \) pour tout \( \| x \|\geq r\).
\end{proposition}

\begin{proof}
    Nous commençons par considérer un polynôme \( P\) donné par
    \begin{equation}
        P(x)=\sum_kc_kx^{\beta_k}
    \end{equation}
    où les \( \beta_k\) sont des multiindices, les \( c_k\) sont des constantes et la somme est finie. Nous avons la majoration
    \begin{equation}
        \sup_{x\in \eR^d}| \varphi(x)P(x) |\leq\sum_k\sup_x\big| c_k\varphi(x) x^{\beta_k} \big|\leq\sum_k| c_k |p_{0,\beta_k}(\varphi)<\infty.
    \end{equation}
    Nous allons noter \( M_P\) la constante \( \sum_k| c_k |p_{0,\beta_k}(\varphi)\), de sorte que pour tout \( x\in \eR^d\) nous ayons \( | \varphi(x)P(x) |\leq M_P\) et donc
    \begin{equation}
        | \varphi(x) |\leq \frac{ M_P }{ | P(x) | }=\frac{1}{ | \frac{1}{ M_P }P(x) | }.
    \end{equation}
    Notons que cette inégalité est a fortiori correcte pour les \( x\) sur lesquels \( P\) s'annule.

    Soit maintenant un polynôme \( Q\). Nous considérons le polynôme \( P(x)=\| x \|Q(x)\). Étant de plus haut degré, pour toute constante \( C\) il existe un rayon \( r_C\) tel que \( | P(x) |\geq C| Q(x) |\) pour tout \( | x |\geq r_C\). En particulier pour \( | x |\geq r_{M_P}\) nous avons
    \begin{equation}
        | P(x) |\geq M_P| Q(x) |
    \end{equation}
    et donc, pour ces \( x\), 
    \begin{equation}
        | \varphi(x) |\leq \frac{1}{ | \frac{1}{ M_P }P(x) | }\leq \frac{1}{ | Q(x) | }.
    \end{equation}
    La première inégalité est valable pour tout \( x\), et la seconde pour \( \| x \|\geq r_{M_P}\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Topologie}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}
    Les \( p_{\alpha,\beta}\) donnés par l'équation \eqref{EqOWdChCu} ci-dessus sont des semi-normes\footnote{Définition \ref{DefPNXlwmi}.}.
\end{lemma}
%TODO : une preuve pour égayer la galerie.

\begin{lemma}[\cite{OEVAuEz}]   \label{LemRJhCbkO}
    La topologie sur \( \swS(\eR^d)\) est donnée aussi par les semi-normes
    \begin{equation}
        q_{n,m}=\max_{| \alpha |\leq n}\sup_{x\in \eR^d}\big( 1+\| x \| \big)^m\big| \partial^{\alpha}\varphi(x) \big|.
    \end{equation}
    Autrement dit, une suite \( \varphi_n\stackrel{\swS(\eR^d)}{\to}0\) si et seulement si \( q_{n,m(\varphi)}\to 0\) pour tout \( n\) et \( m\).
\end{lemma}
Le fait que les \( q_{n,m}(\varphi)\) restent bornés est la proposition \ref{PropCSmzwGv}. Cependant ce lemme est plus précis parce qu'en disant seulement que \( \varphi\) est majoré par des polynôme, nous ne disons pas que les polynômes correspondants aux \( \varphi_n\) tendent vers zéro si \( \varphi_n\stackrel{\swS}{\to}0\). Et d'ailleurs on ne sait pas très bien ce que signifierait \( P_n\to 0\) pour une suite de polynômes.

\begin{proposition}     \label{PropGNXBeME}
    Pour \( p\in\mathopen[ 1 , \infty \mathclose]\), l'espace \( \swS(\eR^d)\) s'injecte continument dans \( L^p(\eR^d)\). 
\end{proposition}

\begin{proof}
    L'injection dont nous parlons est l'identité ou plus précisément l'identité suivie de la prise de classe. Il faut vérifier que cela est correct et continu, c'est à dire d'abord qu'une fonction à décroissance rapide est bien dans \( L^p\) et ensuite que si \( f_n\stackrel{\swS}{\to}0\), alors \( f_n\stackrel{L^p}{\to}0\).
    
    Commençons par \( p=\infty\). Alors \( \| f_n \|_{\infty}=p_{0,0}(f_n)\to 0\) parce que si \( f_n\stackrel{\swS}{\to}0\), alors en particulier \( p_{0,0}(f_n)\to 0\).

    Au tour de \( p<\infty\) maintenant. Nous savons qu'en dimension \( d\), la fonction
    \begin{equation}
        x\mapsto \frac{1}{ (1+\| x \|)^s }
    \end{equation}
    est intégrable dès que \( s>d\).
    %TODO : il faudrait une petite preuve de ça.
    Pour toute valeur de \( m\) nous avons
    \begin{equation}
        \| \varphi \|_p^p=\int_{\eR^d}| \varphi(x) |^pdx=\int_{\eR^d}\frac{ \big|    (1+\| x \|)^m\varphi(x)   \big|^p }{ \big( 1+\| x \| \big)^{mp} }\leq\int_{\eR^d}\frac{q_{0,m}(\varphi)^p}{ \big( 1+\| x \| \big)^{mp} }.
    \end{equation}
    En choisissant \( m\) de telle sorte que \( mp>d\), nous avons convergence de l'intégrale et donc \( \| \varphi \|_p<\infty\). Nous retenons que
    \begin{equation}    \label{EqVWfEFMk}
        \| \varphi \|_p^p\leq Cq_{0,m}(\varphi)^p
    \end{equation}
    pour une certaine constance \( C\) et un bon choix de \( m\).

    Ceci prouve que \( \swS(\eR^d)\subset L^p(\eR^d)\). Nous devons encore vérifier que l'inclusion est continue. Si \( \varphi_n\stackrel{\swS}{\to}0\), alors en particulier nous avons \( q_{0,m}(\varphi_n)\to 0\) par le lemme \ref{LemRJhCbkO}. Par conséquent la majoration \eqref{EqVWfEFMk} nous dit que \( \| \varphi_n \|_p\to 0\) également.

\end{proof}
En résumé, si \( \varphi_n\stackrel{\swS(\eR^d)}{\to}\varphi\) alors \( \varphi_n\stackrel{L^p}{\to}\varphi\).

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Produit de convolution}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[\cite{CXCQJIt}]
    Si \( \varphi\in L^1(\eR)\) et \( \psi\in\swS(\eR)\), alors \( \varphi * \psi\in \swS(\eR)\).
\end{proposition}

\begin{proof}
    Nous devons prouver que
    \begin{equation}
        p_{\alpha,\beta}(\varphi*\psi)=\sup_{x\in \eR^d}| x^{\beta}(\partial^{\alpha}(\varphi*\psi))(x) |
    \end{equation}
    est borné pour tout multiindices \( \alpha\) et \( \beta\). En appliquant \( | \alpha |\) fois la proposition \ref{PropHNbdMQe}, nous mettons toutes les dérivées sur \( \psi\) : \( \partial^{\alpha}(\varphi*\psi)=(\varphi*\partial^{\alpha}\psi)\). Cela étant fait, nous majorons
    \begin{subequations}
        \begin{align}
            \big| x^{\beta}(\varphi*\partial^{\alpha}\psi)(x) \big|&\leq| x^{\beta} |\int_{\eR^d} |\varphi(y)|\underbrace{\big| (\partial^{\alpha}\psi)(x-y)\big|}_{\leq\| \partial^{\alpha}\psi \|_{\infty}} dy \big|\\
            &\leq | x^{\beta} |  \| \partial^{\alpha}\psi \|_{\infty}\int_{\eR^d}| \varphi(y) |dy\\
            &\leq p_{\alpha,\beta}(\psi)\| \varphi \|_{_{L^1}}.
        \end{align}
    \end{subequations}
    Par conséquent, \( p_{\alpha,\beta}(\varphi*\psi)\leq \| \varphi \|_{L^1}p_{\alpha,\beta}(\psi)<\infty\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Transformée de Fourier}
%---------------------------------------------------------------------------------------------------------------------------

La définition de la transformée de Fourier de \( \varphi\in\swS(\eR^d)\) est 
\begin{equation}
    \hat  \varphi(\xi)=\int_{\eR^n}\varphi(x) e^{-ix\cdot \xi}.
\end{equation}

\begin{lemma}   \label{LemQPVQjCx}
    Si \( \varphi\in\swS(\eR^d)\) et si \( \alpha\) est un multiindice, alors
    \begin{equation}
        \partial^{\alpha}\hat\varphi=(-i)^{| \alpha |}\widehat{M_{\alpha}\varphi}.
    \end{equation}
    et
    \begin{equation}
        \widehat{\partial^{\alpha}\varphi}(\xi)=(-i)^{| \alpha |}\xi^{\alpha}\hat\varphi(\xi).
    \end{equation}
\end{lemma}

\begin{proof}
    Nous considérons la fonction \( h(x,\xi)=\varphi(x) e^{-ix\cdot \xi}\) dont la dérivée par rapport à \( \xi_i\) est donnée par \( -i(M_{i}\varphi)(x) e^{x\cdot \xi}\). Cette fonction est majorée en norme par
    \begin{equation}
        G(x)=M_i\varphi(x),
    \end{equation}
    qui est encore une fonction à décroissance rapide et donc parfaitement intégrable sur \( \eR^d\). Le théorème \ref{ThoMWpRKYp} nous dit donc que la dérivée de \( \hat \varphi\) par rapport à \( \xi_i\) existe et vaut
    \begin{equation}
        \frac{ \partial \hat\varphi }{ \partial \xi_i }(\xi)=-i\int_{\eR^n}x_i\varphi(x) e^{-i\xi\cdot x}=-i\widehat{M_i\varphi}(\xi).
    \end{equation}
    En appliquant ce résultat en chaîne, nous trouvons la première formule annoncée.

    Nous passons à la seconde formule annoncée. Étant donné que \( \varphi\in\swS\), ses dérivées le sont aussi et par conséquent, il n'y a pas de problèmes pour écrire
    \begin{equation}    \label{EqTYizlnia}
        \widehat{\partial_{x_k}\varphi}(\xi)=\int_{\eR^d}\frac{ \partial \varphi }{ \partial x_k }(x) e^{-ix\cdot \xi}dx.
    \end{equation}
    Étant donné que
    \begin{equation}    \label{EqZAeYaCB}
        \frac{ \partial  }{ \partial x_k }\left( \varphi(x) e^{-ix\cdot\xi} \right)=\frac{ \partial \varphi }{ \partial x_k }(x) e^{-ix\cdot\xi}-i\xi_k\varphi(x) e^{-ix\cdot \xi},
    \end{equation}
    notre tâche sera de prouver que
    \begin{equation}    \label{EqVGvYBNK}
        \int_{\eR^d}\frac{ \partial  }{ \partial x_k }\left( \varphi(x) e^{-ix\cdot \xi} \right)dx=0.
    \end{equation}
    Autrement dit, nous voulons montrer que le terme au bord d'une intégration par partie s'annule. D'abord le fait que \( \varphi\) soit à décroissance rapide nous assure que l'intégrale \eqref{EqVGvYBNK} converge. Pour chaque \( \xi\), la fonction
    \begin{equation}
        f(x,\xi)=\frac{ \partial x_k }{ \partial  }\left( \varphi(x) e^{-ix\cdot \xi} \right)
    \end{equation}
    est intégrable par rapport à \( x\). De plus, \( f\) est dans \( \swS(\eR)\) pour chacune de ses variables (les autres étant fixées). Le théorème de Fubini \ref{ThoFubinioYLtPI} nous permet alors de décomposer l'intégrale en
    \begin{equation}
        \int_{\eR^d}f(x,\xi)dx=\int_{\eR}\ldots\int_{\eR} f(x_1,\ldots, x_d)dx_1\ldots dx_d.
    \end{equation}
    De plus nous pouvons intégrer dans l'ordre de notre choix et nous choisissons évidemment d'intégrer d'abord par rapport à \( x_k\).  Étudions donc l'intégrale
    \begin{equation}
        \int_{\eR}\frac{ \partial  }{ \partial x }\left( \varphi(x) e^{-ix\xi} \right)dx=\lim_{A\to\infty}\int_{-A}^A\frac{ \partial  }{ \partial x }\left( \varphi(x) e^{-ix\xi} \right)dx
    \end{equation}
    dans laquelle nous avons un peu allégé les notations. Une primitive de ce qui est intégré est toute trouvée : c'est \( \varphi(x) e^{-ix\xi}\), et nous pouvons utiliser le théorème fondamental du calcul intégral pour écrire que
    \begin{equation}
        \int_{-A}^A\left( \varphi(x) e^{-ix\xi} \right)'dx=\left[ \varphi(x) e^{-ix\xi} \right]_{x=-A}^{x=A}.
    \end{equation}
    Vu que \( \varphi\) est dans \( \swS\), la limite \( A\to\infty\) donne zéro.

    En substituant maintenant \eqref{EqZAeYaCB} dans \eqref{EqTYizlnia} et en tenant compte du terme que nous venons de montrer s'annuler, nous avons
    \begin{equation}
        \widehat{\partial_k\varphi}(\xi)=-i\xi_k\int_{\eR^d}\varphi(x) e^{-ix\cdot \xi}=-i\xi_k\hat\varphi(\xi).
    \end{equation}
    En recommençant la procédure \( | \alpha |\) fois nous trouvons la seconde formule annoncée.
\end{proof}


\begin{proposition}
    L'espace de Schwartz est stable par transformée de Fourier. De plus l'application
    \begin{equation}
        \TF\colon \swS(\eR^d)\to \swS(\eR^d)
    \end{equation}
    est linéaire et continue.
\end{proposition}

\begin{proof}
    La linéarité découle de celle de l'intégrale. La difficulté est de prouver que pour \( \varphi\in\swS(\eR^d)\) nous avons bien que \( \hat\varphi\in\swS(\eR^d)\) et que cette association est continue\footnote{Pour rappel, en dimension infinie, il n'est pas garanti qu'une application linéaire soit continue.}.
    \begin{subproof}
        \item[Stabilité]
            Nous devons prouver que pour tout multiindices \( \alpha\) et \( \beta\), nous avons \( p_{\alpha,\beta}(\hat\varphi)<\infty\). Nous avons
            \begin{equation}
                \xi^{\beta}\partial^{\alpha}\hat\varphi(\xi)=\xi^{\beta}(-i)^{| \alpha |}\widehat{M_{\alpha}\varphi}(\xi)=(-i)^{| \alpha |+| \beta |}\widehat{\partial^{\beta}M_{\alpha}\varphi}(\xi).
            \end{equation}
            Ensuite nous nous souvenons que \( \| \hat f \|_{\infty}\leq \| f \|_1\) parce que
            \begin{equation}
                | \hat f(\xi) |\leq\int_{\eR^d}\big| f(x) e^{-ix\cdot \xi} \big|=\int_{\eR^d}| f(x) |dx=\| f \|_1.
            \end{equation}
            Donc 
            \begin{equation}
                p_{\alpha,\beta}(\hat\varphi)=\| \widehat{\partial^{\beta}M_{\alpha}\varphi} \|_{\infty}\leq \| \partial^{\beta}M_{\alpha}\varphi \|_1.
            \end{equation}
            Du fait que \( \varphi\) soit dans \( \swS\), la dernière expression est finie. Cela prouve déjà que
            \begin{equation}
                \TF\big( \swS(\eR^d) \big)\subset\swS(\eR^d).
            \end{equation}
            
        \item[Continuité]

            Nous supposons avoir une suite \( \varphi_n\stackrel{\swS}{\to}\varphi\), et nous devons prouver que \( \hat\varphi_n\stackrel{\swS}{\to}\hat\varphi\). Pour alléger les notations, nous posons \( f_n=\varphi_n-\varphi\). Nous avons
            \begin{subequations}    \label{subEqsSGsGGih}
                \begin{align}
                    \| \hat f \|_{\alpha,\beta}&=\| \xi^{\beta}\partial^{\alpha}\hat f \|_{\infty}\\
                    &=\| \widehat{  \partial^{\beta}M_{\alpha}f  } \|_{\infty}\,\text{lemme \ref{LemQPVQjCx}.}\\
                    &\leq \| \partial^{\beta}M_{\alpha}f \|_1
                \end{align}
            \end{subequations}
            La convergence \(f_n\stackrel{\swS}{\to}0\) nous dit ente autres que \( \partial^{\beta}M_{\alpha}f_n\stackrel{\swS}{\to}0\); en particulier la proposition \ref{PropGNXBeME} nous dit que \( \partial^{\beta}M_{\alpha}f_n\stackrel{L^1}{\to}0\), ce qui signifie, par les majorations \eqref{subEqsSGsGGih} que
            \begin{equation}
                \| \hat f_n \|_{\alpha,\beta}\leq \| \partial^{\beta}M_{\alpha}f_n \|_1\to0,
            \end{equation}
            ce qui prouve la continuité de transformée de Fourier dans \( \swS(\eR^d)\).
    \end{subproof}
    
\end{proof}

\begin{theorem}
    Nous avons la formule d'inversion
    \begin{equation}
        f(x)=\frac{1}{ (2\pi)^n }\int_{\eR^n}\hat f(\xi) e^{ix\cdot \xi}d\xi.
    \end{equation}
\end{theorem}
%TODO : à préciser

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Distributions tempérées}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
    Une \defe{distribution tempérée}{distribution!tempérée} est une forme linéaire continue sur \( \swS(\eR^d)\). L'ensemble des distributions tempérées est noté \( \swS'(\eR^d)\)\nomenclature[Y]{\( \swS'(\eR^d)\)}{espace des distributions tempérées}. Si \( T\) est une telle distribution, nous notons $\langle T, \varphi\rangle$ l'image de \( \varphi\) par \( T\).
\end{definition}

Si \( f\) est une fonction sur \( \eR^d\) telle que \( f\varphi\in L^1(\eR^d)\) pour tout \( \varphi\in \swS(\eR^d)\), alors nous définissons la distribution \( T_f\in\swS'(\eR^d)\) par
\begin{equation}
    \langle T_f, \varphi\rangle =\int_{\eR^d}f(x)\varphi(x)dx.
\end{equation}
Cette définition ne fonctionne pas pour toute les fonctions. Par exemple pour \( f(x)= e^{x^2}\), et \( \varphi(x)= e^{-x^2}\in\swS(\eR)\) nous avons \( f\varphi=1\) qui n'est pas du tout intégrable sur \( \eR\).

\begin{example}
    La \defe{distribution de Dirac}{distribution!de Dirac} \( \delta\) est donnée par
    \begin{equation}
        \langle \delta, \varphi\rangle =\varphi(0).
    \end{equation}
    Montrons qu'elle est continue. Soit une suite \( \varphi_n\stackrel{\swS}{\to}0\). En particulier, \( p_{0,0}(\varphi_n)=\sup_x| \varphi_n(x) |\to 0\). Donc \( \varphi_n(0)\to 0\) comme il le faut.
\end{example}

\begin{example}
    La \defe{valeur principale}{valeur!principale (distribution)} de la fonction \( x\mapsto \frac{1}{ x }\) est la distribution
    \begin{equation}
        \begin{aligned}
            T\colon \swS(\eR)&\to \eR \\
            \varphi&\mapsto \lim_{\substack{\epsilon\to 0\\\epsilon>0}}\int_{| x |>\epsilon}\frac{ \varphi(x) }{ x }.
        \end{aligned}
    \end{equation}
    Montrons que cela définit bien une distribution tempérée.

    D'abord l'intégrale existe pour tout \( \epsilon\), par exemple parce que pour les grands \( | x |\) nous avons par exemple \( | \varphi(x)\leq x^3 |\) et donc \( \varphi(x)/x\leq 1/x^2\) dont l'intégrale converge. Nous devons maintenant regarder la limite.

    Nous considérons une suite \( \epsilon_n\to 0\) et la suite
    \begin{equation}
        a_n=\int_{| x |\geq \epsilon_n}\frac{ \varphi(x) }{ x }dx.
    \end{equation}
    Nous montrons que cette suite converge dans \( \eR\) en montrant qu'elle est de Cauchy. Pour cela nous travaillons un peu la forme de \( \varphi\) :
    \begin{equation}
        \varphi(x)=\varphi(0)+\int_0^x\varphi'(t)dt=\varphi(0)+\int_0^1x\varphi'(x\theta)d\theta.
    \end{equation}
    Ce qui est dans l'intégrale est borné par \( K=\| M_x\varphi' \|_{\infty}\) qui est parfaitement fini parce que \( \varphi\) est à décroissance rapide. Lorsque nous calculons \( | a_m-a_n |\), le terme \( \varphi(0)/x\) donne une intégrale nulle parce que le domaine d'intégration \( \epsilon_n\leq | x |\leq \epsilon_n\) est symétrique alors que la fonction \( 1/x\) est impaire.
    \begin{equation}
        | a_m-a_n |\leq \big| \int_{\epsilon_m<| x |<\epsilon_n}K \big|=2| \epsilon_n-\epsilon_m |K
    \end{equation}
    Tout cela nous dit que \( T\) est bien définie. Nous devons encore étudier sa continuité.

    Soit \( \chi\) une fonction dans \(  C^{\infty}_c(\eR)\) telle valant \( 1\) sur \( \mathopen[ -1 , 1 \mathclose]\), paire et à valeurs dans \( \mathopen[ 0 , 1 \mathclose]\).
    %TODO : il faudrait montrer qu'il existe des fonctions C infini à support compact qui ne sont pas nulles partout. C'est fait autour du lemme de Borel.
    Pour tout \( \epsilon>0\) nous avons \( \int_{| x |>\epsilon}\frac{ \chi(x) }{ x }dx=0\). 

    Nous avons aussi \( \varphi=\chi\varphi+(1-\chi)\varphi\), et donc
    \begin{subequations}
        \begin{align}
            \int_{| x |>\epsilon}\frac{ \varphi(x) }{ x }dx&=\int_{| \epsilon |>0}\chi(x)\frac{ \varphi(x)-\varphi(0) }{ x }dx+\int_{| \epsilon |>0}\big( 1-\chi(x) \big)\frac{ \varphi(x) }{ x }dx\\
            &=\int_{| \epsilon |>0}\chi(x)\int_0^1\underbrace{\varphi'(\theta x)}_{\leq \| \varphi' \|_{\infty}}d\theta+\int_{| x |\geq 1}\big( 1-\chi(x) \big)\frac{ \varphi(x) }{ x }dx\\
            &\leq\| \varphi' \|_{\infty}\int_{| x |\geq \epsilon}\chi(x)dx+\| \varphi \|_{L^1}\\
            &=C\| \varphi' \|_{\infty}+\| \varphi \|_{1}.
        \end{align}
    \end{subequations}
    Cela est valable pour toute fonction \( \varphi\in\swS(\eR)\). Mais nous savons que si \( \varphi_n\stackrel{\swS(\eR)}{\to}0\), alors \( \| \varphi_n \|_{\infty}\to 0\), \( \| \varphi'_n \|_{\infty}\to 0\) et \( \| \varphi_n \|_1\to 0\); donc si \( \varphi_n\stackrel{\swS(\eR)}{\to}0\), alors
    \begin{equation}
        T(\varphi_n)=\lim_{\substack{\epsilon\to 0\\\epsilon>0}}\int_{| x |>\epsilon}\frac{ \varphi(x) }{ x }\leq C\| \varphi_n' \|_{\infty}+\| \varphi_n \|_1\to 0.
    \end{equation}
\end{example}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Peigne de Dirac}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}
    La formule
    \begin{equation}    \label{EqMEVmKvg}
        \Delta_a=\sum_{k\in \eZ}\delta_{ka}
    \end{equation}
    définit un élément de \( \swD'(\eR)\).
\end{proposition}
La forme linéaire \( \Delta_a\) est le \defe{peigne de Dirac}{peigne de Dirac} de pas \( a\).

\begin{proof}
    Nous utilisons le critère de continuité séquentielle en zéro du théorème \ref{ThoVDDBnVn}. Soit une suite \( \varphi_n\to 0\) dans \( \swD(\eR)\). Par le théorème \ref{ThoXYADBZr} il existe un compact \( K\) de \( \eR\) pour lequel \( \varphi_n\in\swD(K)\) pour tout \( n\) et \( \varphi_n\to0\) dans \( \swD(K)\). La somme \ref{EqMEVmKvg} est donc finie et nous pouvons la permuter avec une limite :
    \begin{equation}
        \lim_{n\to \infty} \Delta_a(\varphi_n)=\sum_{k\in\eZ}\lim_{n\to \infty} \varphi_n(ka).
    \end{equation}
    La limite \( \varphi_n\to 0\) dans \( \swD(K)\) signifie que nous avons convergence uniforme de la fonction et de toutes ses dérivées vers \( 0\). En particulier \( \| \varphi_n \|_{\infty}\to 0\); disons que la somme (qui est finie) fasse \( s\) termes :
    \begin{equation}
        \sum_{k\in \eZ}\varphi_n(ka)\leq s\| \varphi_n \|_{\infty}.
    \end{equation}
    Le terme de droite tend vers zéro lorsque \( n\) tend vers l'infini.
\end{proof}
Donc \( \Delta_a\) est bien une distribution au sens de la définition \ref{DefPZDtWVP}.

