% This is part of Le Frido
% Copyright (c) 2016
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Inversion}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{lemmaDef}        \label{LEMooNLYKooKBMdDk}
    Soit un cercle \( C\) et un point \( A\) du plan \( \eR^2\). Soit une droite passant par \( A\) et coupant \( C\) en deux points \( P\) et \( P'\) (pas spécialement distincts). Alors le nombre 
    \begin{equation}
        \| AP \|\| AP' \|
    \end{equation}
    ne dépend pas du choix de la droite et est nommé la \defe{puissance}{puissance!d'un point} du point \( A\) par rapport au cercle \( C\).
\end{lemmaDef}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Cercles perpendiculaires}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
    Deux cercles sont \defe{perpendiculaires}{cercles!perpendiculaires} lorsque leurs tangentes aux points d'intersections sont perpendiculaires.
\end{definition}

\begin{lemma}[\cite{MonCerveau}]        \label{LEMooWMGOooAieUjD}
    Soient deux cercles perpendiculaires \( C_1\) et \( C_2\). Alors
    \begin{enumerate}
        \item       \label{ITEMooJVYYooSrlSdA}
            le centre de \( C_1\) est hors de \( C_2\).
        \item        \label{ITEMooTQATooNWvllF}
            Si \( \ell\) est une droite passant par ce le centre de \( C_1\) (nommé \( O\)) et si \( \ell\) coupe \( C_2\) en les deux points \( P\) et \( P'\), alors \( P\) et \( P'\) sont situés du même côté de \( O\).
    \end{enumerate}
\end{lemma}

\begin{proof}
    Nous nommons \( O_1\) le centre de \( C_1\) ainsi que \( Q\) et \( Q'\) les points d'intersection de \( C_1\) avec \( C_2\). Si \( \ell_Q\) et \( \ell_{Q'} \) sont les tangentes à \( C_1\) en \( Q\) et \( Q'\), alors ce sont des rayons de \( C_2\) (parce que les cercles sont perpendiculaires). Par conséquent le centre \( O_2\) de \( C_2\) est le point d'intersection \( Q'=\ell_Q\cap \ell_{Q'}\).

    Le triangle \( O_1O_2Q\) est rectangle en \( Q\) et donc \( \| O_1O_2 \|>\| QO_2 \| \). Or le nombre \( \| QO_2 \|\) est le rayon de \( C_2\), donc \( O_1\) est en dehors de \( C_2\).

    Ceci achève de prouver le point \ref{ITEMooJVYYooSrlSdA}; nous démontrons le point \ref{ITEMooTQATooNWvllF}. Les points \( P\) et \( P'\) sont sur le cercle \( C_2\), donc tous les points du segment \( [PP']  \) sont dans le cercle. Or le centre de \( C_1\) doit être en dehors de \( C_2\); il ne peut donc pas être dans le segment \( [PP']\), ce qui prouve que \( P\) et \( P'\) ne sont pas de part et d'autre de \( O\) sur la droite \( (OPP')\).
\end{proof}

\begin{proposition}[\cite{MonCerveau}]      \label{PROPooYSVYooOFKxib}
    Soit un cercle \( C_1\) de centre \( O\) et de rayon \( R\).
    \begin{enumerate}
        \item       \label{ITEMooWYIJooAAmXUl}
            Un cercle \( C_2\) est perpendiculaire à \( C_1\) si et seulement si il existe une droite \( \ell\) passant par \( O\) telle que les points d'intersection \( \{ P,P' \}= \ell\cap C_2\) soient situés du même côté de \( O\) et vérifient
            \begin{equation}        \label{EQooDTAWooNYUXZX}
        \| OP \|\| OP' \|=R^2.
    \end{equation}
        \item       \label{ITEMooYKZOooYZKyhF}
            Dans ce cas, toutes les droites passant par \( O\) et coupant \( C_2\) en deux points \( P,P'\) vérifient le fait que \( P\) et \( P'\) soient du même côté de \( O\) et \( \| OP \|\| OP' \|=R^2\).
    \end{enumerate}
\end{proposition}

\begin{proof}
    Nous commençons par prouver le point \ref{ITEMooYKZOooYZKyhF}. Le fait que les points \( P\) et \( P'\) soient du même côté de \( O\) est le lemme \ref{LEMooWMGOooAieUjD}\ref{ITEMooTQATooNWvllF}. Pour la relation sur les distances, soit \( Q\in C_1\cap C_2\). Vu que \( C_1\) et \( C_2\) sont perpendiculaires, la droite \( (OQ)\) ne coupe \( C_2\) qu'en ce point, et la puissance de \( O\) par rapport au cercle \( C_2\) est \( \| OQ \|^2=R^2\).

    La même puissance peut être calculée via la droite \( \ell\) :
    \begin{equation}
        \| OP \|\| OP' \|.
    \end{equation}
    Donc \( \| OP \|\| OP' \|=R^2\).

    Soit un cercle \( C_2\) passant par \( P\) et \( P'\). Notons que \( P\) et \( P'\) ne sont pas sur \( C_1\) parce qu'ils ne pourraient pas être alignés avec \( O\). De plus l'un est à l'intérieur de \( C_1\) et l'autre à l'extérieur de \( C_1\). Les cercles \( C_1\) et \( C_2\) possèdent donc deux points distincts d'intersections.
    La puissance de \( O\) par rapport à \( C_2\) est :
    \begin{equation}
        \| OP \|\| OP' \|=R^2
    \end{equation}
    parce que \( (OP)\) est une droite coupant \( C_2\) en les points \( P\) et \( P'\).

    Soit \( Q\) un point d'intersection de \( C_1\) et \( C_2\), et \( Q'\) l'autre point d'intersection de \( C_2\) avec la droite \( (OQ)\). La puissance de \( O\) par rapport à \( C_2\) peut également être calculée à partir de cette droite (lemme \ref{LEMooNLYKooKBMdDk}) et nous avons
    \begin{equation}
        \| OQ \|\| OQ' \|=R^2,
    \end{equation}
    mais \( Q\in C_1\), donc \( \| OQ \|=R\) et partant \( \| OQ' \|=R\). Nous en déduisons que \( Q'\in C_1\) également. Or \( Q'\) ne peut pas être l'autre point d'intersection de \( C_1\) avec \( C_2\) (sinon \( O,Q,Q'\) ne seraient pas alignés). Donc \( Q=Q'\) et nous déduisons que la droite \( (OQ)\) est tangente à \( C_2\).

    Le rayon de \( C_1\) est tangent à \( C_2\). Cela signifie que $C_1$ est perpendiculaire à \( C_2\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Inversion}
%---------------------------------------------------------------------------------------------------------------------------

\begin{propositionDef}[\cite{ooZYLAooXwWjLa}]       \label{PROPDEFooVLIWooQgpLQa}
    Soit un cercle \( C\) de centre \( O\) dans \( \eR^2\). Il existe une unique application 
    \begin{equation}
        i_C\colon \eR^2\setminus O\to \eR^2\setminus O
    \end{equation}
    telle que
    \begin{enumerate}
        \item
            \( i_C(x)=x\) pour tout \( x\in C\)
        \item\label{ITEMooXLZCooEGAxHu}
            \( i_C\) échange l'intérieur et l'extérieur de \( C\).
        \item\label{ITEMooCPPUooDJIzSk}      
            \( i_C\) laisse invariants les droites et les cercles orthogonales à \( C\).
    \end{enumerate}
    Cette application est l'\defe{inversion}{inversion} de cercle \( C\).
\end{propositionDef}

\begin{proof}
    Soit \( P\) à l'intérieur de \( C\), mais différent de \( O\). Nous notons \( \ell\) la droite \( (OP)\) et nous considérons un cercle \( C_2\) passant par \( P\) et perpendiculaire à \( C\) (existence par la proposition \ref{PROPooYSVYooOFKxib}). Nous avons \( \ell\perp C\) (parce que \( \ell\) est un rayon) et \( C_2\perp C\). Donc \( i_C(\ell)=\ell\) et \( i_C(C_2)=C_2\) par l'exigence \ref{ITEMooCPPUooDJIzSk}. Mais comme \( P\in\ell\cap C_2 \) nous avons aussi
    \begin{equation}
        i_C(P)\in \ell\cap C_2.
    \end{equation}
    Mais \( \ell\) et \( C_2\) se coupent en exactement deux points. Vu que \( i_C(P)\) doit être hors de \( C\) (exigence \ref{ITEMooXLZCooEGAxHu}), avoir \( i_C(P)=P\) est impossible. Nous en concluons que \( i_C(P)\) doit être l'autre intersection.

    Nous avons prouvé que les conditions \ref{ITEMooXLZCooEGAxHu} et \ref{ITEMooCPPUooDJIzSk} fixent l'image d'un point situé dans l'intérieur de \( C\).

    Si \( P\) est extérieur au cercle $C$, la même procédure fonctionne : nous considérons la droite \( \ell=(OP)\) et un cercle \( C_2\) perpendiculaire à \( C\) et passant par \( P\). Encore une fois, ces deux objets sont fixés par \( i_C\), et vu que \( i_C(P)\) doit être à l'intérieur de \( C\), il est fixé.

    L'unicité est montrée.

    En ce qui concerne l'existence, si \( P\neq O\), la procédure suivante donne \( P'\) :
    \begin{itemize}
        \item Soit la droite \( \ell=(OP)\).
        \item Soit un cercle \( C_2\) perpendiculaire à \( C\) et passant par \( P\).
        \item Le point \( P'\) est le point de l'intersection \( C_2\cap\ell\) qui n'est pas \( P\).
    \end{itemize}
    Il est aisé de vérifier que poser \( i_C(P)=P'\) donne une application qui vérifie toute les propriétés.
\end{proof}

\begin{normaltext}      \label{NORMooUBFQooCzXRJj}
    Nous recopions la construction de l'inversion d'un point par rapport à un cercle. Si \( C_1\) est un cercle de centre \( O\) et \( P\) est un point différent de \( O\), alors la procédure suivante construit \( P'=i_{C_1}(P)\) :
    \begin{itemize}
        \item Soit la droite \( \ell=(OP)\).
        \item Soit un cercle \( C_2\) perpendiculaire à \( C_1\) et passant par \( P\).
        \item Le point \( P'\) est le point de l'intersection \( C_2\cap\ell\) qui n'est pas \( P\).
    \end{itemize}
    Que se passe-t-il si \( \ell\) et \( C_2\) n'ont qu'une seule intersection ? Alors la droite \( \ell=(OP)\) est tangente à \( C_2\). Or de \( O \) il n'existent que deux droites tangentes à \( C_2\), et ce sont les rayons passant par les intersections parce que les cercles sont perpendiculaires. En d'autres mots, cette situation se présente lorsque \( P\) est sur le cercle \( C_1\). Dans ce cas, \( i_{C_1}(P)=P\).
\end{normaltext}

\begin{corollary}
    L'inversion \( i_C\) est une involution (\( i_C^2=\id\)).
\end{corollary}

\begin{proof}
    Soit un cercle \( C\) de centre \( O\) et un point \( P\). Si \( C_2\) est un cercle perpendiculaire à \( C\) passant par \( P\), alors nous avons vu en \ref{NORMooUBFQooCzXRJj} que \( P'=i_C(P)\) est l'autre intersection entre \( C_2\) et la droite \( (OP)\).

    Pour construire l'image de \( P'\), il faut un cercle perpendiculaire à \( C\) passant par \( P'\). Le cercle \( C_2\) déjà utilisé fait l'affaire. Ensuite, la droite \( (OP')\) est la même que la droite \( (OP)\). Donc l'image de \( P'\) est \( P\).
\end{proof}

\begin{proposition}
    Soit le cercle de rayon \( R\) et de centre \( a\in \eC\). Alors 
    \begin{equation}
        i_C(z)=\frac{ R^2 }{ \bar z-\bar a }+a.
    \end{equation}
\end{proposition}

\begin{proof}
    Si \( a=0\) et \( z=r e^{i\varphi}\) alors \( i_C(z)\) est le point situé sur la même demi-droite \( \mathopen[ O , z \mathclose[\), mais à une distance de \( O\) vérifiant la relation \eqref{EQooDTAWooNYUXZX}. Donc
        \begin{equation}        \label{EQooOSAJooDJqlWz}
            i_C(z)=\frac{ R^2 }{ r } e^{i\varphi}=\frac{ R^2 }{ \bar z }.
        \end{equation}
        Étant donné que toute la construction donnée en \ref{NORMooUBFQooCzXRJj} est invariante sous le translations, si le centre du cercle est \( a\neq 0\) nous pouvons utiliser la décomposition
        \begin{equation}
            i_C=t_a\circ i_{C_0}\circ t_{-a}
        \end{equation}
        où \( t_a\) est la translation de vecteur \( a\) et \( C_0\) est le cercle de rayon \( R\) et de centre \( 0\). Cela donne donc, en utilisant \eqref{EQooOSAJooDJqlWz} pour \( i_{C_0}\) :
        \begin{equation}
            i_C(z)=a+\frac{ R^2 }{ \overline{ z-a }  }.
        \end{equation}
\end{proof}

\begin{proposition}[\cite{ooZYLAooXwWjLa}]
    Soit un cercle \( C\) de centre \( O\). L'inversion
    \begin{equation}
        i_C\colon \eR^2\setminus\{ 0 \}\to \eR^2\setminus\{ 0 \}
    \end{equation}
    transforme
    \begin{enumerate}
        \item
            les droites passant par \( O\) sur elles-mêmes;
        \item
            les cercles passant par \( O\) en des droites ne passant pas par \( O\);
        \item
            les droites ne passant pas par \( O\) en des cercles passant par \( O\);
        \item
            les cercles ne passant pas par \( O\) en des cercles ne passant pas par \( O\).
    \end{enumerate}
\end{proposition}

\begin{proof}
    Point par point.
    \begin{enumerate}
        \item
            Une droite passant par \( O\) est une droite perpendiculaire à \( C\). Par le point \ref{ITEMooCPPUooDJIzSk} de la définition \ref{PROPDEFooVLIWooQgpLQa}, elle est invariante.
        \item
            Nous construisons successivement :
            \begin{itemize}
                \item 
                    Un cercle \( C_1\) de centre \( O_1\) et passant par \( O\). Le but est de déterminer l'image de ce cercle.
                \item
                    Le point \( P\) de \( C_1\) tel que \( [OP]\) en soit un diamètre.
                \item
                    Le point \( P'=i_C(P)\).
                \item
                    La droite \( \ell\) perpendiculaire à \( (OP)\) et passant par \( P'\).
            \end{itemize}
            Nous montrons maintenant que \( i_C(C_1\setminus\{ O \})=\ell\). Soit \( Q\in C_1\setminus\{ P,O \}\). Nous posons
            \begin{equation}
                Q'=(QO)\cap \ell.
            \end{equation}
            Vu que \( [OP]\) est un diamètre de \( C_1\) et que \( Q\in C_1\), le triangle \( OPQ\) est rectangle en \( Q\). Et étant donné que \( Q'\) est sur \( \ell\) nous savons que \( OP'Q'\) est rectangle en \( P'\).
            
            De plus les angles en \( O\) de ces deux triangles sont identiques (parce que c'est l'angle formé par les droites \( (OQ) \) et \( (OP)\)); les triangles \( OPQ\) et \( QP'Q'\) sont donc semblables et nous pouvons utiliser le théorème de Thalès\footnote{Faites bien le dessin : ce n'est pas une situation de Thalès ultra-standard de collège.} :
            \begin{equation}
                \frac{ OP }{ OQ }=\frac{ OQ' }{ OP' }.
            \end{equation}
            Donc
            \begin{equation}
                \| OP \|\| OP' \|=\| OQ \|\| OQ' \|,
            \end{equation}
            mais \( P'\) est l'image de \( P\) par l'inversion du cercle \( C\), c'est à dire \( \| OP \|\| OP' \|=R^2\). Nous en déduisons que
            \begin{equation}
                \| OQ \| \| OQ' \|=R^2,
            \end{equation}
            c'est à dire que \( Q'\) est l'image de \( Q\) par \( i_C\), et donc que
            \begin{equation}        \label{EQooPJBGooGeIVQQ}
                i_C\big( C_1\setminus\{ O \} \big)\subset \ell.
            \end{equation}
            
            Pour avoir l'inclusion inverse, il faut remarquer que \( \ell\) est parallèle à la tangente à \( C_1\) en \( O\). Donc si \( Q\in \ell\), la droite \( (OQ)\) intersecte le cercle \( C_1\) en un point \( Q'\). En refaisant le cheminement du résultat \eqref{EQooPJBGooGeIVQQ} à l'envers, il est loisible de prouver que \( i_C(Q')=Q\) et donc que \( \ell\) est bien inclue à l'image de \( C_1\) par \( i_C\).

        \item
            Nous commençons par prouver que toutes les droites ne passant pas par \( O\) sont des images de cercles passant par \( O\). 

            Nous considérons :
            \begin{itemize}
                \item 
                    une droite \( \ell\) ne passant pas par \( O\).
                \item
                    la droite \( d\), perpendiculaire à \( \ell\) passant par \( O\) 
                \item
                    le point \( P'=\ell\cap d\),
                \item
                    le point \( P=i_C(P')\),
                \item
                    le cercle \( C_1\) dont \( [OP]\) est un diamètre.
            \end{itemize}
            Par tout ce que nous avons fait jusqu'à présent, la droite \( \ell\) est l'image du cercle \( C_1\). Or si \( \| OP \|=r\) alors
            \begin{equation}
                \| OP' \|=\frac{ R^2 }{ r }.
            \end{equation}
        Donc quelle que soit la valeur de \( \| OP' \|\) dans \( \mathopen] 0 , \infty \mathclose[\), il existera un point \( P\) tel que le cercle passant par \( O\) et \( P\) ait pour image la droite perpendiculaire à \( (OP)\) passant par \( i_C(P)\).

            Étant donné que \( i_C\) est une involution surjective des cercles passant par \( O\) vers les droites ne passant pas par \( O\), elle transforme également toutes les droites ne passant pas par \( O\) en un cercle passant par \( O\).

        \item

            Soit \( C_1\), un cercle ne passant pas par \( O\). Nous voulons déterminer \( i_C(C_1)\) et démontrer que c'est un cercle ne passant pas par \( O\). Nous notons \( r^2\), la puissance de \( O\) par rapport à \( C_1\). Soit \( C_2\), le cercle de centre \( O\) et de rayon \( r\).

            Soit \( \ell\) une droite passant par \( O\) et coupant \( C_1\) en les points \( P\) et \( Q\) (éventuellement confondus) avec \( \| OP \|\leq \| OQ \|\). Par l'indépendance de la puissance en le choix de la droite,
            \begin{equation}
                r^2=\| OP \|\| OQ \|
            \end{equation}
            et donc \( \| OP \|\leq r\leq \| OQ \|\).

            Mais \( C_2\) est centré en \( O\) et de rayon \( r\). Donc il passe par le segment \( \mathopen[ P , Q \mathclose]\) et coupe alors \( C_1\) en exactement deux points.

    \end{enumerate}
    <++>
\end{proof}
<++>

