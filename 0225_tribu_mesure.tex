% This is part of Mes notes de mathématique
% Copyright (c) 2011-2015
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Prolongement}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem}[Prolongement de Hahn\cite{MesureLebesgueLi}]    \label{ThoLCQoojiFfZ}
    Soit \( \tribA\) une algèbre de parties d'un ensemble \( S\) et \( \mu\) une mesure sur \( (S,\tribA)\). Soit \( \tribF=\sigma(\tribA)\) la tribu engendrée par \( \tribA\). Alors
    \begin{enumerate}
        \item
            La mesure \( \mu\) se prolonge en une mesure \( m\) sur \( \tribF\).
        \item
            Si \( \mu\) est \( \sigma\)-finie alors le prolongement est unique et \( m\) est \( \sigma\)-finie.
        \item
            Si \( \mu\) est finie, alors \( m\) l'est aussi.
    \end{enumerate}
\end{theorem}
\index{théorème!prolongement de Hahn}
\index{prolongement!théorème de Hahn}

\begin{proof}
    La proposition \ref{PropIUOoobjfIB} nous donne une mesure extérieure \( \mu^*\) sur \( S\) dont la restriction à \( \tribA\) est \( \mu\). Si \( \tribM\) est la tribu des parties \( \mu^*\)-mesurables de \( S\) alors le théorème de Carathéodory \ref{ThoUUIooaNljH} nous dit que \( (S,\tribM,\mu^*)\) est un espace mesuré.
    \begin{subproof}
        \item[\( \tribA\subset\tribM\)]
            Cette partie est une adaptation de ce qui a déjà été fait dans la preuve de la proposition \ref{PropOJFoozSKAE}. Soit \( A\in\tribA\) et \( X\in S\); nous devons prouver la relation de la définition \ref{DefTRBoorvnUY}. Vu que \( \mu^*\) est une mesure extérieure nous avons automatiquement
            \begin{equation}
                \mu^*(A)\leq \mu^*(X\cap A)+\mu^*(X\cap A^c).
            \end{equation}
            Il reste à prouver l'inégalité inverse. Soit une suite \( B_k\) d'éléments de \( \tribA\) telle que \( X\subset\bigcup_kB_k\); nous avons alors
            \begin{equation}
                \mu^*(X\cap A)\leq \mu^*\big( \bigcup_{k=1}^{\infty}B_k\cap A \big)\leq \sum_{k=1}^{\infty}\mu^*(B_k\cap A)=\sum_k\mu(B_k\cap A)
            \end{equation}
            où nous avons utilisé la définition \ref{DefUMWoolmMaf}\ref{ItemARKooppZfDaiii} ainsi que le lemme \ref{LemBFKootqXKl}. De la même façon,
            \begin{equation}
                \mu^*(X\cap A^c)\leq \sum_k\mu(B_k\cap A^c).
            \end{equation}
            Mettant les deux bouts ensemble, en remarquant que \( B_k\cap A\in\tribA\) et donc que \( \mu^*(B_k\cap A)=\mu(B_k\cap A)\),
            \begin{equation}
                \mu^*(X\cap A)+\mu^*(X\cap A^c)\leq \sum_k\mu(B_k\cap A)+\mu(B_k\cap A^c)=\sum_k\mu(B_k).
            \end{equation}
            La somme \( \mu^*(X\cap A)+\mu^*(X\cap A^c)\) est donc inférieure à chacun des éléments de l'ensemble sur lequel on prend l'infimum pour définir\footnote{Définition \ref{EqRNJooQrcoa}.} \( \mu^*(X)\), donc
            \begin{equation}
                 \mu^*(X\cap A)+\mu^*(X\cap A^c)\leq \mu^*(X).
            \end{equation}
    \end{subproof}

    A fortiori nous avons \( \sigma(\tribA)\subset\tribM\) et donc \( (S,\sigma(\tribA),\mu^*)\) est un espace mesuré. Cela prouve l'existence d'une mesure prolongeant \( \mu\) à \( \sigma(\tribA)\).

    \begin{subproof}
        \item[Unicité]

            Nous supposons à présent que \( \mu\) est \( \sigma\)-finie. Soient \( m_1\) et \( m_2\) deux mesures prolongeant \( \mu\) et définies sur une tribu contenant \( \tribA\). Nous posons
            \begin{equation}
                \tribC=\{ A\in\tribA\tq\mu(A)<\infty \}.
            \end{equation}
            Dans l'optique d'utiliser le théorème d'unicité des mesures \ref{ThoJDYlsXu}, nous prouvons que \( \sigma(\tribA)=\sigma(\tribC)\). Vu que \( \mu\) est \( \sigma\)-finie, il existe une suite croissante \( (S_n)\) d'éléments de \( \tribA\) telle que \( S=\bigcup_nS_n\) et \( \mu(S_n)\in\tribC\). Alors si \( A\in\tribA\) nous avons \( A=\bigcup_n(A\cap S_n)\), et donc \( A\in\sigma(\tribC)\). Donc \( \tribA\subset\sigma(\tribC)\). Mais étant donné que \( \tribC\subset\tribA\) nous avons aussi \( \sigma(\tribC)\subset\sigma(\tribA)\). Au final \( \sigma(\tribA)=\sigma(\tribC)\).

            Les mesures \( m_1\) et \( m_2\) sont des mesures sur \( \sigma(\tribC)\) coïncidant sur \( \tribC\) (parce que \( \tribC\subset\tribA\)). De plus la classe \( \tribC\) est stable par intersection finie et contient une suite croissante dont l'union est \( S\) (parce que \( \mu\) est \( \sigma\)-finie).

            Le théorème \ref{ThoJDYlsXu} nous dit alors que \( m_1\) et \( m_2\) coïncident sur \( \sigma(\tribC)=\sigma(\tribA)\).

        \item[Extension finie et \( \sigma\)-finie]

            Enfin si \( \mu\) est \( \sigma\)-finie il existe \( S_n\in\tribA\) avec \( \mu(S_n)<\infty\) et \( \bigcup_nS_n=S\). Ces ensembles vérifient tout autant \( m(S_n)=\mu(S_n)<\infty\) pour tout prolongement \( m\) de \( \mu\).

            Idem si \( \mu\) est finie, tout prolongement est fini.
    \end{subproof}
\end{proof}

% TODO : parler de la compactification en un point de R ainsi que de la topologie sur R U {+infini,-infini}.
\begin{example}[\cite{MesureLebesgueLi}] \label{ExKCEoolsZrL}
Soit \( \tribA\), l'algèbre de parties de \( \eR\) formée par les réunions finies d'intervalles de la forme \( \mathopen] -\infty , a \mathclose[\), \( \mathopen[ a , b [\) et \( \mathopen[ b , +\infty [\) avec \( -\infty<a\leq b<+\infty\). Notons que les singletons ne font pas partie de \( \tribA\) parce que \( \mathopen[ a ,a[=\emptyset\). Nous posons
    \begin{equation}
        \mu(A)=\begin{cases}
            0    &   \text{si \( A=\emptyset\)}\\
            \infty    &    \text{sinon}.
        \end{cases}
    \end{equation}
    Cela donne une mesure (non \( \sigma\)-finie) sur \( (\eR,\tribA)\).

    Nous allons prouver que la tribu engendrée par \( \tribA\) est la tribu des boréliens et que \( \mu\) accepte (au moins) deux prolongements distincts à \( \sigma(\tribA)\).

    D'abord nous avons
    \begin{equation}
        \mathopen] a , b \mathclose[=\big( \mathopen -\infty , a \mathclose[\cup \mathopen[ b , +\infty [ \big)\cap\mathopen[ a , b [,
    \end{equation}
    donc toutes les boules ouvertes appartiennent à \( \sigma(\tribA)\). Ces dernières comprenant une base dénombrable de la topologie de \( \eR\) (par la proposition \ref{PropNBSooraAFr}), tous les ouverts de \( \eR\) sont dans \( \sigma(\tribA)\). Par conséquent \( \Borelien(\eR)\subset(\eR^d)\). Mais en même temps tous les éléments de \( \tribA\) sont des boréliens, donc \( \Borelien(\eR)=\sigma(\tribA)\) parce que la fermeture en tant qu'algèbre de parties est plus petite que la fermeture en tant que tribu.

    La mesure de comptage prolonge \( \mu\) parce qu'à part l'ensemble vide, tous les éléments de \( \tribA\) sont infinis. Notons que les singletons sont dans \( \sigma(\tribA)\), donc la mesure de comptage prend d'autres valeurs que \( 0\) et \( +\infty\).

    Par ailleurs la mesure
    \begin{equation}
        \mu'(A)=\begin{cases}
            0    &   \text{si \( A=\emptyset\)}\\
            +\infty    &    \text{sinon}
        \end{cases}
    \end{equation}
    est également une mesure prolongeant \( \mu\) à \( \sigma(\tribA)=\Borelien(\eR)\).

    La mesure de comptage et \( \mu'\) sont deux prolongements distincts de \( \mu\).
\end{example}

%TODO : quelle partie de R n'est pas borélienne ?

\begin{example}[\cite{MesureLebesgueLi}]
    Nous montrons maintenant une mesure non \( \sigma\)-finie qui se prolonge en deux mesures distinctes, toutes deux \( \sigma\)-finies.

    Nous considérons la même algèbre \( \tribA\) de parties que celle donnée dans l'exemple \ref{ExKCEoolsZrL}, mais cette fois vue sur \( \eQ\) uniquement. La mesure de comptage \( m\) sur \( (\eQ,\tribA)\) n'est pas \( \sigma\)-finie.

    Vu que les singletons sont des boréliens nous avons \( \sigma(\tribA)=\partP(\eQ)\), ce qui fait que \( (\eQ,\sigma(\tribA),m)\) est un prolongement \( \sigma\)-fini de \( m\). L'espace mesuré \( (\eQ,\sigma(\tribA),2m)\) est également \( \sigma\)-fini et est un prolongement distinct de \( (\eQ,\tribA,m)\).
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Fonctions mesurables}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{proposition}[\cite{OYRmzAa}]
    Tout ouvert de \( \eR^n\) est une union dénombrable de rectangles presque disjoints\footnote{«presque» au sens où les intersections éventuelles sont de mesure de Lebesgue nulle.}.
\end{proposition}

\begin{proof}
    Soit \( G\) un ouvert de \( \eR^n\). Soit \( \{ Q_i^{1} \}_{i\in \eN}\) un découpage de \( \eR^n\) en cubes de côté \( 1\) et dont les sommets sont en les coordonnées entières. Ce sont des cubes presque disjoints. Nous considérons ensuite pour chaque \( k>1\) le découpage \( \{ Q_i^{(k)} \}_{i\in\eN}\) de \( \eR^n\) en cubes de côtés \( 2^{-k}\) qui consiste à découper en \( 2\) les côtés des cubes du découpage \( Q^{(k-1)}\). Ces cubes forment encore un découpage dénombrable de \( \eR^n\) en des cubes presque disjoints. Ensuite nous considérons \( \mE\) l'union de tous les \( Q_i^{(k)}\) contenus dans \( G\).

    Montrons que \( \mE=G\). D'abord \( \mE\subset G\) parce que \( \mE\) est une union d'ensembles contenus dans \( G\). Ensuite si \( x\in G\), il existe une boule de rayon \( r\) autour de \( x\) contenue dans \( G\); alors un des ensembles \( Q_i^{(k)}\) avec \( 2^{-j}<\frac{ r }{2}\) est contenue dans \( B(x,r)\) et donc dans \( \mE\).

    Bien entendu l'union qui donne \( \mE\) n'est pas satisfaisante par ce que les \( Q_i^{(k+1)}\) sont contenus dans les \( Q_i^{(k)}\); les intersections sont donc loin d'être de mesure nulle.

    Nous faisons ceci : 
    \begin{subequations}
        \begin{align}
            R^{(0)}&=\{ Q_i^{(1)} \text{contenu dans \( G\)} \}\\
            R^{(k+1)}&=\{ Q_i^{(k+1)}\text{contenus dans \( G\) et pas dans \( R^{(k)}\)} \}.
        \end{align}
    \end{subequations}
    En fin de compte l'union de tous les ensembles contenus dans les \( R^{(k)}\) forment encore \( \eR^n\), mais sont d'intersection presque vide.
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Fonction mesurable}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[Fonction mesurable] \label{DefQKjDSeC}
    Soit \( (E,\tribA)\) et \( (F,\tribF)\) deux espaces mesurés. Une fonction \( f\colon E\to F\) est \defe{mesurable}{mesurable!fonction} si pour tout \( \mO\in \tribF\), l'ensemble \( f^{-1}(\mO)\) est dans \( \tribA\).

    Une fonction à valeurs dans \( \eR^d\) est \defe{borélienne}{borélienne!fonction}\index{fonction!borélienne} si elle est mesurable pour la tribu des boréliens sur \( \eR^d\). Plus explicitement, \( f\colon (\Omega,\tribA)\to (\eR^d,\Borelien(\eR^d))\) est borélienne si pour tout \( \mO\in\Borelien\) nous avons \( f^{-1}(\mO)\in\tribA\).
\end{definition}
Si \( \tribA\) est une tribu sur un ensemble \( E\), nous notons \( m(\tribA)\)\nomenclature[P]{\( m(\tribA)\)}{Ensemble des fonctions \( \tribA\)-mesurables} l'ensemble des fonctions qui sont \( \tribA\)-mesurables.

Le plus souvent lorsque nous parlerons de fonctions \( f\colon X\to Y\) où \( Y\) est un espace topologique, nous considérons la tribu borélienne sur \( Y\). Ce sera en particulier le cas dans la théorie de l'intégration.

\begin{remark}
    Lorsque nous considérons des fonctions à valeurs réelles \( f\colon X\to \eR\) nous utiliserons toujours la tribu borélienne sur \( \eR\). Pour \( X\), cela peut dépendre des contextes. En théorie de l'intégration, nous mettrons sur \( X\) la tribu des ensembles mesurables au sens de Lebesgue sur \( X\), \emph{tout en gardant celle des boréliens sur l'ensemble d'arrivée}.

    Pour toute la partie sur l'intégration, une fonction \( f\colon \eR^n\to \eR^m\) sera mesurable si pour tout borélien \( A\) de \( \eR^m\) l'ensemble \( f^{-1}(A)\) est Lebesgue-mesurable dans \( \eR^n\).

    Étant donné qu'il est franchement difficile de créer des ensembles non mesurables au sens de Lebesgue, il est franchement difficile de créer des fonction non mesurables à valeurs réelles. L'hypothèse de mesurabilité est donc toujours satisfaite dans les cas pratiques.
\end{remark}

\begin{lemma}[\cite{NBoIEXO}]   \label{LemFOlheqw}
    Une fonction \( f\colon X\to \eR\) est mesurable si et seulement si \( f^{-1}(I)\) est mesurable pour tout \( I\) de la forme \( \mathopen] a , \infty \mathclose[\).
\end{lemma}

\begin{proof}
    Nous devons prouver que \( f^{-1}(A)\) est mesurable dans \( X\) pour tout borélien \( A\) de \( \eR\). Nous posons
    \begin{equation}
        S=\{ A\subset \eR\tq f^{-1}(A)\text{ est mesurable dans \( X\)} \}
    \end{equation}
    et nous prouvons que cela est une tribu. D'abord \( f^{-1}(\eR)=X\), et \( X\) est mesurable, donc \( \eR\in S\). Ensuite si \( A\in S\) alors \( f^{-1}(A^c)=f^{-1}(A)^c\). En tant que complémentaire d'un mesurable de \( X\), l'ensemble \( f^{-1}(A)^c\) est mesurable dans \( X\). Et enfin si \( A_n\in S \) alors \( f^{-1}(\bigcup_nA_n)=\bigcup_nf^{-1}(A_n)\) qui est encore mesurable dans \( X\) en tant qu'union de mesurables.

    Donc \( S\) est une tribu qui contient tous les ensembles de la forme \( \mathopen] a , \infty \mathclose]\). Le lemme \ref{LemZXnAbtl} conclu que \( S\) contient tous les boréliens de \( \eR\).
\end{proof}

\begin{lemma}[\cite{NBoIEXO}]   \label{LemIGKvbNR}
    Soit \( f_n\colon X\to \eR\) une suite de fonctions mesurables\footnote{Ici \( X\) est un espace mesuré et \( \eR\) est muni des boréliens.}. Alors \( \sup_n f_n\) est mesurable.
\end{lemma}

\begin{proof}
    Nous avons
    \begin{subequations}
        \begin{align}
            (\sup f_n)^{-1}\big( \mathopen] a , \infty \mathclose] \big)&=\{ x\in X\tq (\sup f_n)(x)>a \}\\
            &=\bigcup_n\{ x\in X\tq f_n(x)>a \}\\
            &=\bigcup_nf_n^{-1}\big( \mathopen] a , \infty \mathclose] \big).
        \end{align}
    \end{subequations}
    Étant donné que \( f_n\) est mesurable et que \( \mathopen] a , \infty \mathclose]\) est mesurable, chacun des \( f_n^{-1}\big( \mathopen] a , \infty \mathclose] \big) \) est mesurable dans \( X\). Nous sommes en présence d'une union dénombrable de mesurables, donc \( (\sup f_n)^{-1}\big( \mathopen] a , \infty \mathclose] \big)\) est mesurable.

    Le lemme \ref{LemFOlheqw} conclu que \( \sup f_n\) est mesurable.
\end{proof}

\begin{proposition}\label{PropFYPEOIJ}
    Si \( f_n\) est une suite de fonctions mesurables et positives, alors la fonction \( \sum_nf_n\) est mesurable.
\end{proposition}

\begin{proof}
    Nous considérons les fonctions \( s_k(x)=\sum_{n=0}^kf_n(x)\) qui vaut éventuellement \( \infty\) en certains points. Nous avons
    \begin{equation}
        \sum_nf_n(x)=\sup_ks_k(x),
    \end{equation}
    donc le lemme \ref{LemIGKvbNR} nous donne la mesurabilité de la somme de \( f_n\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure image}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[Mesure image\cite{TribuLi}]
    Soient \( (S_1,\tribF_1)\) et \( (S_2,\tribF_2)\) des espaces mesurables. Soit \( \varphi\colon S_1\to S_2\) une application mesurable. Si \( m_1\) est une mesure positive sur \( S_1\) alors l'application définie par
    \begin{equation}
        m_2(A_2)=m_1\big( \varphi^{-1}(A_2) \big)
    \end{equation}
    est une mesure positive sur \( (S_2,\tribF_2)\).
\end{proposition}

\begin{definition}
    La mesure \( m_2\) ainsi définie est la \defe{mesure image}{mesure!image} de \( m_1\) par l'application \( \varphi\). Elle est notée \( \varphi(m_1)\).
\end{definition}

\begin{proof}
    Il y a deux choses à vérifier pour avoir une mesure positive\footnote{Définition \ref{DefBTsgznn}}.

    D'abord pour l'ensemble vide :
    \begin{equation}
        m_2(\emptyset)=m_1\big( \varphi^{-1}(\emptyset) \big)=m_1(\emptyset)=0.
    \end{equation}
    Ensuite pour l'additivité. Soient \( A_n\) dans \( \tribF_2\) des parties deux à deux disjointes et telles que \( \bigcup_nA_n\in\tribF_2\). Alors nous avons
    \begin{subequations}
        \begin{align}
            m_2\big( \bigcup_nA_n \big)&=m_1\Big( \varphi^{-1}(\bigcup_nA_n) \Big)\\
            =&m_1\big( \bigcup_n\varphi^{-1}(A_n) \big)\\
            &=\sum_nm_1\big( \varphi(A_n) \big)\\
            &=\sum_nm_2(A_n).
        \end{align}
    \end{subequations}
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Fonction simple}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}  \label{DefBPCxdel}
Une fonction mesurable \( f\colon X\to \eR\) est \defe{simple}{simple!fonction}\index{fonction!simple} si son image est finie
\begin{equation}
    f(x)=\sum_{j=1}^p\alpha_j\mtu_{A_j}(x)
\end{equation}
où \( A_j=f^{-1}(\alpha_j)\). Notons que \( f\) étant mesurable, les ensembles \( A_j\) sont forcément mesurables.
\end{definition}

\begin{lemma}[Limite croissante de fonctions étagées mesurables]    \label{LemYFoWqmS}
    Soit \( f\colon (\Omega,\tribA)\to \eR\) une fonction mesurable. Il existe une suite \( f_n\colon \Omega\to \eR\) de fonctions simples telles que \( f_n\to f\) ponctuellement et \( | f_n |<f\).
\end{lemma}

\begin{proof}
    Nous considérons \( (q_n)\) une suite parcourant tous les rationnels\footnote{Nous rappelons que \( \eQ\) est dénombrable et dense dans \( \eR\).}.
    Pour \( n\in \eN\) nous définissons la fonction
    \begin{equation}
        f_n(\omega)=\begin{cases}
            \max\{ q_i\tq i\leq n,\, q_i\leq f(\omega) \}    &   \text{si \( f(\omega)\geq 0\)}\\
            \min\{ q_i\tq i\leq n,\, q_i\geq f(\omega) \}    &    \text{si \( f(\omega)< 0\).}
        \end{cases}
    \end{equation}
    La fonction \( f_n\) est simple parce qu'elle ne prend que \( n\) valeurs différentes. Nous avons aussi par construction que \( | f_n(\omega)|\leq |f(\omega) |\). Nous avons aussi pour tout \( \omega\in \Omega\) que \( f_n(\omega)\to f(\omega)\) parce que \( \eQ\) est dense dans \( \eR\).

    En ce qui concerne la mesurabilité de \( f_n\), les étages de \( f_n\) sont les ensembles de la forme \( \{ \omega\in \Omega\tq f(\omega)\in\mathopen[ a , b [ \}\) où \( a\) et \( b\) sont deux éléments de \( \{ q_1,\ldots, q_n \}\) qui sont consécutifs au sens de l'ordre dans \( \eQ\) (et non spécialement au sens de l'ordre d'apparition dans la suite), avec éventuellement \( b=\infty\) si \( a\) est le plus grand. Les ensembles \( \mathopen[ a , b [\) étant mesurables dans \( \eR\) et la fonction \( f\) étant mesurable par hypothèse, les ensembles \( f^{-1}\Big( \mathopen[ a , b [ \Big)\) sont mesurables dans \( (\Omega,\tribA)\).
\end{proof}

\begin{proposition}\label{PropWBavIf}
    Une fonction positive et mesurable sur \( \Omega\) est limite ponctuelle croissante de fonctions simples positives.
\end{proposition}

\begin{proof}
    Soit \( \{ q_i \}\) une énumération des rationnels positifs. Il suffit de poser
    \begin{equation}
        f_n(x)=\max\{ q_i\tq i\leq n,\text{ et }f(x)\geq q_i \}.
    \end{equation}
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Théorème de récurrence}
%---------------------------------------------------------------------------------------------------------------------------

Soit \( X\) un espace mesurable, \( \mu\) une mesure finie sur \( X\) et \( \phi\colon X\to X\) une application mesurable préservant la mesure, c'est à dire que pour tout ensemble mesurable \( A\subset X\),
\begin{equation}
    \mu\big( \phi^{-1}(A) \big)=\mu(A).
\end{equation}
Si \( A\subset X\) est un ensemble mesurable, un point \( x\in A\) est dit \defe{récurrent}{récurrent!point d'un système dynamique} par rapport à \( A\) si et seulement si pour tout \( p\in \eN\), il existe \( k\geq p\) tel que \( \phi^k(x)\in A\).

\begin{theorem}[\wikipedia{fr}{Théorème_de_récurrence_de_Poincaré}{Théorème de récurrence de Poincaré}.]     \label{ThoYnLNEL}
    Si \( A\) est mesurable dans \( X\), alors presque tous les points de \( A\) sont récurrents par rapport à \( A\).
\end{theorem}

\begin{proof}
    Soit \( p\in \eN\) et l'ensemble
    \begin{equation}
        U_p=\bigcup_{k=p}^{\infty}\phi^{-k}(A)
    \end{equation}
    des points qui repasseront encore dans \( A\) après \( p\) itérations  de \( \phi\). C'est un ensemble mesurable en tant que union d'ensembles mesurables (pour rappel, les tribus sont stables par union dénombrable, comme demandé à la définition \ref{DefjRsGSy}), et nous avons donc
    \begin{equation}
        \mu(U_p)\leq \mu(X)<\infty.
    \end{equation}
    De plus \( U_p=\phi^{-p}(U_0)\), donc \( \mu(U_p)=\mu(U_0)\). Vu que \( U_p\subset U_p\), nous avons
    \begin{equation}
        \mu(U_0\setminus U_p)=0.
    \end{equation}
    Étant donné que \( A\subset U_0\) nous avons a fortiori que
    \begin{equation}
        \{ x\in A\tq x\notin U_p \}\subset U_0\setminus U_p,
    \end{equation}
    et donc
    \begin{equation}
        \mu\{ x\in A\tq x\notin U_p \}=0.
    \end{equation}
    Cela signifie exactement que l'ensemble des points \( x\) de \( A\) tels que aucun des \( \phi^k(x)\) avec \( k\geq p\) n'est dans \( A\) est de mesure nulle.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Tribu produit}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}      \label{DefTribProfGfYTuR}
    Si \( \tribA_1\) et \( \tribA_2\) sont deux tribus sur deux ensembles \( \Omega_1\) et \( \Omega_2\), nous définissons la \defe{tribu produit}{tribu!produit} \( \tribA_1\otimes\tribA_2\) comme étant la tribu engendrée par 
    \begin{equation}
        \{ X\times Y\tq X\in\tribA_1,Y\in\tribA_2 \}.
    \end{equation}
    Ces ensembles sont appelés \defe{rectangles}{rectangle!produit de tribus} de \( (\Omega_1,\tribA_1)\otimes (\Omega_2,\tribA_2)\).
\end{definition}

\begin{lemma}[Propriété des sections\cite{NBoIEXO}] \label{LemAQmWEmN}
    Soient \( \tribA_1\) et \( \tribA_2\) des tribus sur les ensembles \( \Omega_1\) et \( \Omega_2\). Si \( A\in\tribA_1\otimes\tribA_2\) alors pour tout \( x\in \Omega_1\) et \( y\in\Omega_2\), les ensembles
    \begin{subequations}    \label{subEqCTtPccK}
        \begin{align}
            A_1(y)=\{ x\in\Omega_1\tq (x,y)\in A \}\\
            A_2(x)=\{ y\in\Omega_2\tq (x,y)\in A \}
        \end{align}
    \end{subequations}
    sont mesurables.
\end{lemma}
\index{section!propriété des}

\begin{proof}
    Soit \( y\in\Omega_2\); nous allons prouver le résultat pour \( A_1(y)\). Pour cela nous notons 
    \begin{equation}
        S=\{ A\in \tribA_1\otimes\tribA_2\tq \forall y\in\Omega_2, A_1(y)\in\tribA_1 \},
    \end{equation}
    et nous allons noter que \( S\) est une tribu contenant les rectangles. Par conséquent, \( S\) sera égal à \( \tribA_1\otimes \tribA_2\).

    \begin{subproof}
        \item[Les rectangles]

            Considérons le rectangle \( A=X\times Y\) et si \( y\in \Omega_2\) alors
            \begin{equation}
                A_1(y)=\{ x\in \Omega_1\tq (x,y)\in X\times Y \}.  
            \end{equation}
            Donc soit \( y\in Y\) alors \( A_1(y)=X\in\tribA_1\), soit \( y\notin Y\) et alors \( A_1(y)=\emptyset\in\tribA_1\).

        \item[Tribu : ensemble complet]

            Nous avons \( \Omega_1\times \Omega_2\in S\) parce que c'est un rectangle.

        \item[Tribu : complémentaire] Soit \( A\in S\) et montrons que \( A^c\in S\). Nous avons d'abord
            \begin{equation}
                (A^c)_1(y)=\{ x\in \Omega_1\tq (x,y)\in A^c \}.
            \end{equation}
            D'autre part
            \begin{equation}
                A_1(y)^c=\{ x\in\Omega_1\tq (x,y)\notin A \}=\{ x\in \Omega_1\tq (x,y)\in A^c \}=(A^c)_1(y).
            \end{equation}
            Vu que \( \tribA_1\) est une tribu et que par hypothèse \( A_1(y)\in\tribA_1\), nous avons aussi \( A_1(y)^c\in S\), et donc \( (A^c)_1(y)\in \tribA_1\), ce qui prouve que \( A^c\in S\).

        \item[Tribu : union dénombrable] Soit une suite \( A_n\in S\). Nous avons
            \begin{equation}
                (\bigcup_nA_n)_1(y)=\{ x\in\Omega_1\tq (x,y)\in \bigcup_nA_n \}=\bigcup_n\{ x\in\Omega_1\tq (x,y)\in A_n \}=\bigcup_n(A_n)_1(y),
            \end{equation}
            et ce dernier ensemble est dans \( \tribA_1\) parce que c'est une union dénombrable d'éléments de \( \tribA_1\).
        
    \end{subproof}
    Nous avons donc prouvé que \( S\) est une tribu contenant les rectangles, donc \( S\) contient au moins \( \tribA_1\otimes \tribA_2\).
\end{proof}

\begin{corollary}
    Si \( f\colon \Omega_1\times \Omega_2\to \eR\) est une fonction mesurable\footnote{Définition \ref{DefQKjDSeC}.} sur \( X\times Y\) alors pour chaque \( y\) dans \( \Omega_2\), la fonction
    \begin{equation}
        \begin{aligned}
            f_y\colon X&\to \eR \\
            x&\mapsto f(x,y) 
        \end{aligned}
    \end{equation}
    est mesurable.
\end{corollary}

\begin{proof}
    Soit \( \mO\) un ensemble mesurable de \( \eR\) (i.e. un borélien), et \( y\in \Omega_2\). Nous avons
    \begin{equation}
        f_y^{-1}(\mO)=\{ x\in X\tq f(x,y)\in \mO \}=A_1(y)
    \end{equation}
    où
    \begin{equation}
        A=\{ (x,y)\in \Omega_1\times \Omega_2\tq f(x,y)\in \mO \}=f^{-1}(\mO).
    \end{equation}
    Ce dernier est mesurable parce que \( f\) l'est.
\end{proof}


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Intégrale par rapport à une mesure}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Une mesure \( \mu\) sur un espace mesurable \( (\Omega,\tribA)\) permet de définir une fonctionnelle linéaire sur l'ensemble des fonctions mesurables \( \Omega\to \eR\). Cette fonctionnelle linéaire est l'intégrale que nous allons définir à présent.

\begin{definition}  \label{DefTVOooleEst}
    Si \( Y\in \tribA\) et si \( f\) est une fonction simple nous définissons
    \begin{equation}
        \int_Yfd\mu=\sum_ia_i\mu(Y\cap E_i).
    \end{equation}
    Pour une fonction \( \mu\)-mesurable générale \( f\colon \Omega\to \mathopen[ 0 , \infty \mathclose]\) nous définissons l'intégrale de \( f\) sur \( Y\) par
    \begin{equation}        \label{EqDefintYfdmu}
        \int_Yfd\mu=\sup\Big\{ \int_Yhd\mu\,\text{où \( h\) est une fonction simple et mesurable telle que \( 0\leq h\leq f\)} \Big\}.
    \end{equation}
\end{definition}

\begin{definition}  \label{DefTCXooAstMYl}
    Une fonction \( f\colon \Omega\to \eR\) est dite \defe{intégrable}{intégrable} au sens de Lebesgue si \( \int_{\Omega}| f |<\infty\). Dans ce cas nous définissons
    \begin{equation}    \label{EqUHSooWfgUty}
        \int_{\Omega}f=\int_{\Omega}f^+-\int_{\Omega}f^-
    \end{equation}
    où \( f^+\) et \( f^-\) sont les parties positives et négatives de \( f\); les deux intégrales à droite dans \eqref{EqUHSooWfgUty} sont finies dès que \( f\) est intégrables.
\end{definition}
Nous verrons comment donner un sens à \( \int_{\Omega}f\) dans certains cas où \( f\) n'est pas intégrable sur \( \Omega\) dans la section \ref{SecGAVooBOQddU} sur les intégrales impropres.

Nous définissons aussi
\begin{equation}
    \mu(f)=\int_{\Omega}f
\end{equation}
si \( f\) est une fonction mesurable sur \( \Omega\).

\begin{remark}
    Dans \( \eR^d\), quasiment toutes les fonctions et ensembles sont mesurables. En effet la construction d'ensembles non mesurables demande obligatoirement l'utilisation de l'axiome du choix; de tels ensembles doivent être construits «exprès pour». Il y a très peu de chances pour que vous tombiez sur un ensemble non mesurable de \( \eR^d\) sans que vous ne vous en rendiez compte.
\end{remark}

\begin{remark}
    «Mesurable» ne signifie pas «intégrable». Par exemple la fonction 
    \begin{equation}
        \begin{aligned}
            f\colon \eR&\to \bar\eR \\
            \omega&\mapsto\begin{cases}
            \frac{1}{ \omega }    &   \text{si $ \omega\neq 0$}\\
            \infty    &    \text{$\omega=0$}.
            \end{cases}
        \end{aligned}
    \end{equation}
    est mesurable, mais non intégrable.
\end{remark}

\begin{proposition}     \label{PropOPSCooVpzaBt}
    Si \( A,B\subset \Omega\) sont des ensembles disjoints et si \( f\) est intégrable sur \( A\cup B\) alors
    \begin{equation}
        \int_{A\cup B}f=\int_Af+\int_Bf.
    \end{equation}
\end{proposition}

Le lemme suivant nous aide à détecter des fonctions presque partout nulles.
\begin{lemma}   \label{Lemfobnwt}
    Soit \( f\) une fonction mesurable positive ou nulle telle que
    \begin{equation}
        \int_{\Omega}fd\mu=0.
    \end{equation}
    Alors \( f=0\) \( \mu\)-presque partout.
\end{lemma}

\begin{proof}
    L'ensemble des points \( x\in\Omega\) tels que \( f(x)\neq 0\) peut s'écrire comme une union dénombrable disjointe :
    \begin{equation}
        \{ x\in\Omega\tq f(x)\neq 0 \}=\bigcup_{i=0}^{\infty}E_i
    \end{equation}
    avec
    \begin{subequations}
        \begin{align}
            E_0&=\{ x\in\Omega\tq f(x)>1 \}\\
            E_i&=\{ x\in\Omega\tq \frac{1}{ i+1 }\leq f(x)<\frac{1}{ i } \}.
        \end{align}
    \end{subequations}
    Si un des ensembles \( E_i\) est de mesure non nulle, alors nous pouvons considérer la fonction simple \( h(x)=\frac{1}{ i+1 }\mtu_{E_i}\) dont l'intégrale sur \( \Omega\) est strictement positive. Par conséquent le supremum de la définition \eqref{EqDefintYfdmu} est strictement positif.

    Nous savons donc que \( \mu(E_i)=0\) pour tout \( i\). Étant donné que la mesure d'une union disjointe dénombrable est égale à la somme des mesures, nous avons
    \begin{equation}
        \mu\{ x\in\Omega\tq f(x)\neq 0 \}=0,
    \end{equation}
    ce qui signifie que \( f\) est nulle \( \mu\)-presque partout.
\end{proof}

\begin{corollary}   \label{CorjLYiSm}
    Soit \( f\) une fonction mesurable sur l'espace mesuré \( (\Omega,\tribA,\mu)\) telle que
    \begin{equation}
        \int_{\Omega}f\mtu_{f>0}d\mu=0.
    \end{equation}
    Alors \( f\leq 0\) presque partout.
\end{corollary}

\begin{proof}
    Nous avons l'égalité d'ensembles
    \begin{equation}
        \{ f\mtu_{f>0}\neq 0 \}=\{ \mtu_{f>0}\neq 0 \}.
    \end{equation}
    Mais lemme \ref{Lemfobnwt} implique que \( f\mtu_{f>0}\) est nulle presque partout, c'est à dire que la mesure de l'ensemble du membre de gauche est nulle par conséquent
    \begin{equation}
        \mu\{ \mtu_{f>0}\neq 0 \}=0.
    \end{equation}
    Cela signifie que la fonction \( f\) est presque partout négative ou nulle.
\end{proof}

\begin{lemma}   \label{LemPfHgal}
    Soit \( f\) une fonction telle que \( | f(x)|\leq g(x) \) pour tout \( x\in\Omega\). Si \( g\) est intégrable, alors \( f\) est intégrable.
\end{lemma}

\begin{proof}
    Nous décomposons \( f\) en parties positives et négatives :
    \begin{subequations}
        \begin{align}
            A_+&=\{ x\in\Omega\tq f(x)>0 \}\\
            A_-&=\{ x\in\Omega\tq f(x)<0 \}.
        \end{align}
    \end{subequations}
    Nous posons \( f_+(x)=f(x)\mtu_{A_+}\) et \( f_-(x)=f(x)\mtu_{A_-}\). Nous avons \( f=f_+-f_-\) et
    \begin{equation}
        \int_{\Omega}f=\int_{A_+}f+\int_{A_-}f
    \end{equation}
    parce que \( \Omega=A_+\cup A_-\cup\{ x\in\Omega\tq f(x)=0 \}\). Si \( \varphi\) est une fonction simple qui majore \( f_+\) nous avons
    \begin{equation}
        \varphi(x)=\sum_{k}a_k\mtu_{E_k}(x)\leq f(x)\mtu_{A_+}(x)\leq g(x).
    \end{equation}
    Par conséquent le supremum qui définit \( \int f_+\) est inférieur au supremum qui définit \( \int g\). La fonction \( f_+\) est donc intégrable. La même chose est valable pour la fonction \( f_-\).
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Mesure dominée}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[Produit d'une mesure par une fonction]
    Si \( (S,\tribF,m_1)\) est un espace mesuré, et si \( f\colon S\to \eR\) est intégrable, et si \( B\) est un ensemble mesurable, nous définissons \( fm_1\) par
    \begin{equation}
        m_2(B)=(fm_1)(B)=\int_Bf(t)dm_1(t).
    \end{equation}
    Cela est une mesure positive sur \( (S,\tribF)\).
\end{proposition}

\begin{proof}
    D'abord pour l'ensemble vide : \( m_2(\emptyset)=\int_{\emptyset}fdm_1=0\).

    Si \( A_n\) sont des éléments disjoints de \( \tribF\) tels que \( \bigcup_nA_n\in\tribF\). Alors en utilisant la proposition \ref{PropOPSCooVpzaBt}, nous avons le calcul suivant :
    \begin{equation}
        m_2\big( \bigcup_nA_n \big)=\int_{\bigcup_nA_n}f(t)dm_1(t)=\sum_{n}\int_{A_n}f(t)dm_1(t)=\sum_nm_2(A_n).
    \end{equation}
\end{proof}

\begin{definition}[\cite{PersoFeng}]
    Soient \( \mu\) et \( \nu\) deux mesures sur le même espace \( \Omega\) et la même tribu \( \tribA\). Nous disons que la mesure \( \mu\) est \defe{dominée}{dominée!mesure} par \( \nu\) si pour tout ensemble mesurable \( A\), \( \nu(A)=0\) implique \( \mu(A)=0\).

    Si \( \nu\) est une mesure positive et \( \mu\) une mesure, nous disons que \( \mu\) est \defe{absolument continue}{mesure!absolument continue} par rapport à \( \nu\) si \( \nu(A)=0\) implique \( \mu(A)=0\). On note aussi \( \mu\ll\nu\)\nomenclature[Y]{$\mu\ll\nu$}{La mesure \( \mu\) est absolument continue par rapport à la mesure \( \nu\).}.
\end{definition}

La mesure \( \mu\) est \defe{portée}{portée!mesure} par l'ensemble \( E\in\tribA\) si pour tout \( A\in\tribA\), 
\begin{equation}
    \mu(A)=\mu(A\cap E).
\end{equation}

Nous écrivons que \( \mu\perp\nu\)\nomenclature[Y]{\( \mu\perp\nu\)}{mesures perpendiculaires} si il existe un ensemble \( E\in\tribA\) tel que \( \mu\) soit porté par \( E\) et \( \nu\) soit porté par \( \complement E\).

\begin{theorem}[Radon-Nikodym\cite{NikoLi}]
    Soient \( \mu\) et \( \nu\) deux mesures \( \sigma\)-finies sur un espace métrisable \( (\Omega,\tribA)\).
    \begin{enumerate}
        \item
            Il existe un unique couple de mesures \( \mu_1\) et \( \mu_2\) telles que
            \begin{enumerate}
                \item
                    \( \mu=\mu_1+\mu_2\)
                \item
                    \( \mu_1\) est dominé par \( \nu\)
                \item
                    \( \mu_2\perp \nu\).
            \end{enumerate}
            Dans ce cas, les mesures \( \mu_1\) et \( \mu_2\) sont positives et \( \sigma\)-finies.
        \item
            À égalité \(  \nu\)-presque partout près, il existe une unique fonction mesurable positive \( f\) telle que pour tout mesurable \( A\),
            \begin{equation}
                \mu_1(A)=\int_Ad\mu_1=\int_{\Omega}\mtu_Afd \nu.
            \end{equation}
        \item
            À égalité \( \nu\)-presque partout près, il existe une unique fonction positive mesurable \( h\) telle que \( \mu_1=h\nu\).
    \end{enumerate}
\end{theorem}
\index{théorème!Radon-Nikodym}
%TODO : une preuve

\begin{corollary}   \label{CorZDkhwS}
    Si \( \mu\) es une mesure \( \sigma\)-finie dominée par la mesure \( \sigma\)-finie \( m\), alors \( \mu\) possède une unique fonction de densité.
\end{corollary}

\begin{corollary}       \label{CorDomDens}
    Soient \( \mu\) et \( m\), deux mesures positives \( \sigma\)-finies sur \( (\Omega,\tribA)\). Alors \( m\) domine \( \mu\) si et seulement si \( \mu\) possède une densité par rapport à \( m\).
\end{corollary}
 
\begin{proof}
    Si \( \mu\) est dominée par \( m\), alors la décomposition \( \mu=\mu+0\) satisfait le théorème de Radon-Nikodym. Par conséquent il existe une fonction \( f\) telle que
    \begin{equation}
        \mu(A)=\int_Afdm.
    \end{equation}
    Cette fonction est alors une densité pour \( \mu\) par rapport à \( m\).

    Pour la réciproque, nous supposons que \( \mu\) a une densité \( f\) par rapport à \( m\), et que \( A\) est une ensemble de \( m\)-mesure nulle :
    \begin{equation}
        m(A)=\int_{\Omega}\mtu_Adm=0.
    \end{equation}
    Cela signifie que la fonction \( \mtu_A\) est \( m\)-presque partout nulle. La fonction produit \( \mtu_Af\) est également nulle \( m\)-presque partout, et par conséquent
    \begin{equation}
        \mu(A)=\int_{\Omega}\mtu_Afdm=0.
    \end{equation}
\end{proof}

\begin{probleme}
    Est-ce que la démonstration de cela ne demande pas la convergence monotone d'une façon ou d'une autre ?
\end{probleme}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure complexe}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[Mesure complexe\cite{TLRRooOjxpTp}] \label{DefGKHLooYjocEt}
    Si \( (\Omega,\tribA)\) est un espace mesurable, une \defe{mesure complexe}{mesure!complexe} est une application \( \mu\colon \tribA\to \eC\) telle que
    \begin{enumerate}
        \item
            $\mu(\emptyset)=0$,
        \item
            \( \nu\) est sous-additive : si les ensembles \( A_i\in\tribA\), alors \( \sum_i\mu(A_i)=\mu(\bigcup_iA_i)\).
    \end{enumerate}
\end{definition}
Notons que la série $\sum_i\mu(A_i)$ est alors nécessairement absolument convergente. En effet changer l'ordre de la somme ne change pas l'union, et donc ne change pas la valeur de la somme. Si \( \sigma\colon \eN\to \eN\) est une permutation, 
\begin{equation}
    \sum_i\mu(A_{\sigma(i)})=\mu\big( \bigcup_iA_{\sigma(i)} \big)=\mu\big( \bigcup_iA_i \big)=\sum_i\mu(A_i).
\end{equation}
Le théorème \ref{PopriXWvIY} dit alors que la somme doit être absolument convergente.


\begin{theorem}[Radon-NikoDym complexe\footnote{L'histoire du nom de ce théorème est intéressante. Lorsque monsieur et madame Rèmederdonnukodym apprirent que leurs amis, les Rèmedelaboulechevelue avaient appelé leur fils Théo, ils décidèrent d'en faire autant. C'est en souvenir de ces circonstances que monsieur Nikodym (prénommé Radon) décida de faire des math.}]\label{ThoZZMGooKhRYaO}
    Soit \( \mu\) une mesure positive sur \( (\Omega,\tribA)\) et \( \nu\) une mesure complexe. Alors
    \begin{enumerate}
        \item
            Il existe un unique couple de mesures complexes \( \nu_a\), \( \nu_s\) sur \( (\Omega,\tribA)\) tel que
            \begin{enumerate}
                \item
                    \( \nu=\nu_a+\nu_s\)
                \item
                    \( \nu_a\ll\mu\)
                \item
                    \( \nu_s\perp \mu\).
            \end{enumerate}
        \item
            Ces mesures satisfont alors \( \nu_a\perp\nu_s\).
        \item
            Il existe une fonction intégrable \( h\colon \Omega\to \eC\) telle que \( \nu_a=h\mu\).
        \item
            La fonction \( h\) est unique à \( \mu\)-équivalence près.
        \item   \label{ItemDIXOooFqOkgGv}
            Si de plus \( \nu\ll \mu\) alors \( \nu=h\mu\).
    \end{enumerate}
\end{theorem}
\index{théorème!Radon-Nikodym!complexe}
\begin{proof}
    No proof.
\end{proof}

\begin{remark}  \label{RemSYRMooZPBhbQ}
    Le point \ref{ItemDIXOooFqOkgGv} est souvent utilisé sous la forme
    \begin{equation}
        \nu(A)=\int_{\Omega}\mtu_A(\omega)h(\omega)d\mu(\omega)=\int_{A}h(\omega)d\mu(\omega).
    \end{equation}
\end{remark}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Théorème d'approximation}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem}[Théorème d'approximation\cite{YHRSDGc}]     \label{ThoAFXXcVa}
    Soit \( (X,\tribB,\mu)\) un espace mesuré où \( \tribB\) sont les boréliens de \( X\). Soit \( A\in \tribB\) tel que \( A\subset W\) où \( W\) est un ouvert avec \( \mu(W)<\infty\). Soit aussi \( \epsilon>0\).
    \begin{enumerate}
        \item
            Il existe un fermé \( F\) et un ouvert \( V\) tels que \( \mu(V)<\infty\) et
            \begin{equation}
                F\subset A\subset V
            \end{equation}
            et \( \mu(V\setminus F)<\epsilon\).
        \item
            Il existe \( f\in C^0(X,\eR)\) nulle hors de \( W\) vérifiant \( 0\leq f\leq 1\) et
            \begin{equation}
                \int_X| \mtu_A-f |^pd\mu(x)<\epsilon.
            \end{equation}
    \end{enumerate}
\end{theorem}
% TODO : la preuve est dans la référence. Il faut replacer ce théorème après la définition de l'intégrale.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure à densité}
%---------------------------------------------------------------------------------------------------------------------------

Si \( \mu\) est une mesure sur \( \eR^d\), une fonction \( f\colon \eR^d\to \eR\) est une \defe{densité}{densité d'une mesure} si pour tout \( A\subset\eR^d\) nous avons
\begin{equation}
    \mu(A)=\int_Af(x)dx
\end{equation}
où \( dx\) est la mesure de Lebesgue.
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Mesure de Lebesgue}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\label{SecZTFooXlkwk}

Nous notons \( \mS\) l'ensemble des intervalles\footnote{Définition \ref{DefEYAooMYYTz}.} de \( \eR\).

\begin{proposition}
    L'ensemble réunions finies d'éléments de \( \mS\) est une algèbre de parties de \( \eR\).
\end{proposition}
Cette algèbre de parties de $\eR$ est notée \( \tribA_{\mS}\).

\begin{proof}

    Nous devons vérifier la définition \ref{DefTCUoogGDud}. Les ensembles \( \eR\) et \( \emptyset\) sont des intervalles et font donc partie de \( \tribA_{\mS}\).
    
    Si \( A\in\tribA_{\mS}\) se décompose en union d'intervalles de la forme \( (a_k,b_k)\) avec \( k=1,\ldots, n\) (ici nous mettons des parenthèses au lieu de crochets parce qu'a priori nous ne savons pas). Alors
    \begin{equation}
        A^c=\bigcup_{k=0}^{k}(b_k,a_{k+1})
    \end{equation}
    où nous avons posé \( b_0=-\infty\) et \( a_{n+1}=+\infty\). Ici encore les parenthèses sont soit fermées soit ouvertes en fonction de ce qu'étaient celles dans la décomposition de \( A\). Quoi qu'il en soit, cette décomposition de \( A^c\) montre que \( A^c\in\tribA_{\mS}\).

    Enfin si \( A,B\in\tribA_{\mS}\) alors \( A\cup B\in\tribA_{\mS}\).
\end{proof}

\begin{lemma}
    Tout élément de \( \tribA_{\mS}\) admet une décomposition minimale unique en réunion finie d'intervalles. Cette décomposition est formée d'intervalles deux à deux disjoints.
\end{lemma}

\begin{proof}
    Nous allons montrer que si \( A\in\tribA_{\mS}\), alors la décomposition minimale consiste en les composantes connexes de \( A\). Pour cela nous rappelons que la proposition \ref{PropInterssiConn} dit qu'une partie de \( \eR\) est connexe si et seulement si elle est un intervalle. D'abord cela nous dit immédiatement que les composantes connexes de \( A\) forment une décomposition de \( A\) en intervalles. Nous devons prouver qu'elle est minimale.

    Soit \( \{ C_k \}_{k=1,\ldots, n}\) les composantes connexes de \( A\). Aucun connexe de \( \eR\) contenu dans \( A\) ne peut intersecter plus d'un des \( C_k\), et par conséquent nous ne pouvons pas décomposer \( A\) en moins de \( n\) intervalles. 
    
    Pour l'unicité, soit \( \{ I_k \}_{k=1,\ldots, n}\) un ensemble de \( n\) intervalles tels que \( \bigcup_{k=1}^nI_k=A\). Chacun des \( I_k\) intersecte un et un seul des \( C_k\). En effet si \( x\in I_k\cap C_i\) et \( y\in I_k\cap C_j\), alors \( \mathopen[ x , y \mathclose]\subset I_k\) parce que \( I_k\) est un intervalle. Mais \( C_i\) étant le plus grand connexe contenant \( x\), \( \mathopen[ x , y \mathclose]\subset C_i\) et de la même façon, \( \mathopen[ x , y \mathclose]\subset C_j\). Par conséquent \( C_i\) et \( C_j\) sont tous deux la composante connexe de \( x\) et \( y\). Nous en déduisons que \( C_i=C_j\), c'est à dire \( i=j\).

    Par ailleurs nous avons \( I_k\cap I_l=\emptyset\) dès que \( k\neq l\) parce que sinon l'ensemble \( I_k\cap I_l\) serait connexe et la décomposition des \( \{ I_k \}_{k=1,\ldots, n} \) ne serait pas minimale : en remplaçant \( I_k\) et \( I_l\) par \( I_k\cup I_l\) on aurait eu une décomposition contenant moins d'éléments. Donc à renumérotation près nous pouvons supposer que \( I_k\) intersecte \( C_l\) si et seulement si \( k=l\).

    Dans ce cas nous devons avoir \( I_k=C_k\), sinon les éléments de \( C_k\setminus I_k\) ne seraient pas dans \( \bigcup_{i=1}^nI_i\).
\end{proof}

\begin{definition}[longueur d'intervalle\cite{MesureLebesgueLi}]
    Si \( I\) est un intervalle d'extrémités \( a\) et \( b\) avec \( -\infty\leq a\leq b\leq +\infty\) alors nous définissons la \defe{longueur}{longueur!d'un intervalle}\index{intervalle!longueur} de \( I\) par
    \begin{equation}
        \ell(I)=\begin{cases}
            b-a    &   \text{si \( -\infty<a\leq b< +\infty\)}\\
            \infty    &    \text{si \( a\) ou \( b\) est infini}
        \end{cases}
    \end{equation}
    Si \( A\in\tribA_{\mS}\) et si sa décomposition minimale est \( A=\bigcup_{k=1}^nI_k\), alors on définit
    \begin{equation}
        \ell(A)=\sum_{k=1}^n\ell(I_k).
    \end{equation}
\end{definition}

Le lemme suivant nous indique que nous pouvons calculer la longueur d'un élément de \( \tribA_{\mS}\) sans savoir la décomposition minimale, pourvu que l'on connaisse une décomposition disjointe.
\begin{lemma}[\cite{MesureLebesgueLi}]\label{LemIUQooEzHun}
    Si
    \begin{equation}
        B=\bigcup_{r=1}^pJ_r
    \end{equation}
    est une décomposition de \( B\in\tribA_{\mS}\) en intervalles deux à deux disjoints alors
    \begin{equation}
        \ell(B)=\sum_{r=1}^p\ell(J_r).
    \end{equation}
\end{lemma}

\begin{proof}
    Nous prouvons dans un premier temps le résultat dans le cas où \( B=I\) est un intervalle. Soit \( I\) un intervalle et une décomposition en intervalles disjoints \( I=\bigcup_{r=1}^pJ_r\). Nous montrons qu'alors \( \ell(I)=\sum_{r=1}^p\ell(J_r)\). Nous verrons ensuite comment passer au cas où \( B\) est un élément générique de \( \tribA_{\mS}\).
    \begin{subproof}
    \item[Si \( B=I\) est un intervalle infini]

        Si \( I\) est infini alors un des \( J_r\) soit l'être et donc \( \sum_{r=1}^p\ell(J_r)=\infty=\ell(I)\).
    \item[Si \( B=I\) est un intervalle ininfini]

    Pour chaque \( r=1,\ldots, p\) nous notons \( a_r\) et \( b_r\) les extrémités de \( J_r\). Vu que les \( J_r\) sont connexes et disjoints, si \( a_k\leq a_l\) alors \( b_k\leq a_l\), sinon l'ensemble (non vide) \( \mathopen] a_l , b_k \mathclose[ \) serait dans l'intersection \( I_k\cap I_l\) qui, elle, est vide. Plus généralement, si \( x\in J_k\) et \( y\in J_l\) avec \( x<y\) alors pour tout \( x'\in J_k\) et tout \( y'\in J_l\) nous avons \( x'<y'\). Vu qu'il y a un nombre fini d'ensembles \( J_r\), nous pouvons les classer dans l'ordre croissant :
        \begin{equation}
            a_1\leq b_1\leq a_2\leq b_2\leq \ldots\leq b_{p-1}\leq a_p\leq b_p.
        \end{equation}
        Vu que les \( J_r\) sont disjoints et que leur union est connexe nous avons en réalité
        \begin{equation}
            a=a_1\leq b_1=a_2\leq b_2=a_3\leq\ldots\leq b_{p-1}= a_p\leq b_p,
        \end{equation}
        donc une somme télescopique donne
        \begin{equation}
            \ell(I)=b-a=\sum_{r=1}^p(b_r-a_r)=\sum_{r=1}^p\ell(J_r).
        \end{equation}

    \item[Si \( B\) n'est pas un intervalle]
        Soit \( \{ I_k \}_{k=1,\ldots, n}\) la décomposition minimale de \( B\). Alors
        \begin{equation}
            \spadesuit=\ell(B)=\sum_{k=1}^n\ell(I_k)=\sum_{k=1}^n\ell\big( \bigcup_{r=1}^p(I_k\cap J_r) \big).
        \end{equation}
        Mais \( I_k\) est un intervalle et s'écrit comme union disjointe \( I_k=\bigcup_{r=1}^p(I_k\cap J_r)\), donc par la première partie
        \begin{equation}
            \spadesuit=\sum_{k=1}^n\sum_{r=1}^p\ell(I_k\cap J_r)=\sum_{r=1}^p\sum_{k=1}^n\ell(I_k\cap J_r).
        \end{equation}
        Ici \( J_r\) est un intervalle qui se décompose en \( J_r=\bigcup_{k=1}^n(I_k\cap J_r)\), donc nous pouvons encore utiliser la première partie :
        \begin{equation}
            \spadesuit=\sum_{r=1}^p\ell(J_r),
        \end{equation}
        ce qu'il fallait.
    \end{subproof}
\end{proof}

\begin{lemma}   \label{LemPIOooRLkbo}
    Si \( A,B\in\tribA_{\mS}\) avec \( A\subset B\) alors \( \ell(A)\leq \ell(B)\).
\end{lemma}

\begin{proof}
    Nous avons évidemment \( B=A\cup B\setminus A\). Notons que \( B\setminus A\in\tribA_{\mS}\) par le lemme \ref{LemBFKootqXKl}. Si \( \{ I_k \}\) est une décomposition disjointe de \( A\) et \( \{ J_i \}\) une de \( B\setminus A\) alors \( \{ I_k \}\cup\{ J_i \}\) est une décomposition disjointe de \( A\cup B\setminus A\) et le lemme \ref{LemIUQooEzHun} nous dit que
    \begin{equation}
        \ell(B)=\ell(A\cup B\setminus A)=\ell(A)+\ell(B\setminus A).
    \end{equation}
    Par conséquent \( \ell(B)\geq \ell(A)\).
\end{proof}

\begin{lemma}   \label{LemUMVooZJgMu}
    Si \( I\) est un intervalle et si il se décompose en
    \begin{equation}
        I=\bigcup_{n\in \eN}I_n
    \end{equation}
    où les \( I_n\) sont des intervalles disjoints, alors
    \begin{equation}
        \ell(I)=\sum_{n=1}^{\infty}\ell(I_n).
    \end{equation}
\end{lemma}

\begin{proof}
    Nous allons encore diviser la preuve en deux parties suivant que \( I\) soit de longueur finie ou pas.   
    \begin{subproof}

        \item[Si \( I\) est de longueur finie]
        
            Soient \( a\) et \( b\) les extrémités de \( I\) : \( -\infty<a\leq b< +\infty\). Pour tout \( N\geq 1\) nous avons
            \begin{equation}
                \sum_{n=1}^N\ell(I_n)=\ell\big( \bigcup_{n=1}^nI_n \big)\leq \ell(I).
            \end{equation}
            La première égalité est le lemme dans le cas d'une union finie \ref{LemIUQooEzHun}. L'inégalité est le lemme \ref{LemPIOooRLkbo}. Cela étant vrai pour tout $N$, à la limite \( N\to\infty\) nous conservons l'inégalité :
            \begin{equation}
                \sum_{n=1}^{\infty}\ell(I_n)\leq \ell(I).
            \end{equation}
            Nous devons encore voir l'inégalité inverse. Pour cela nous supposons que \( a<b\). Sinon \( \ell(I)=0\) et tous les \( I_n\) doivent être vide sauf un qui contiendra seulement \( \{ a \}\) (si \( I\) le contient).

            Soit \( \epsilon>0\) avec \( \epsilon<b-a\) et l'intervalle
            \begin{equation}
                \mathopen[ a+\frac{ \epsilon }{ 4 } , b-\frac{ \epsilon }{ 4 } \mathclose]=\mathopen[ a' , b' \mathclose]\subset I.
            \end{equation}
            Si les \( a_n\) et le \( b_n\) sont le extrémités des \( I_n\) alors
            \begin{equation}
                \mathopen[ a' , b' \mathclose]\subset I=\bigcup_{n\geq 1}I_n\subset\bigcup_{n\geq 1}\mathopen] a_n-\frac{ \epsilon }{ 2^{n+2} } , b_n+\frac{ \epsilon }{ 2^{n+2} } \mathclose[=\bigcup_{n\geq 1}\mathopen] a'_n , b'_n \mathclose[
            \end{equation}
            où nous avons posé \( a'_n=a_n-\epsilon/2^{n+2}\) et \( b'_n=b_n+\epsilon/2^{n+2}\). Nous avons donc recouvert le compact\footnote{Lemme \ref{LemOACGWxV}.} \( \mathopen[ a' , b' \mathclose]\) par des ouverts. Nous pouvons donc en extraire un sous-recouvrement fini (c'est la définition de la compacité), c'est à dire une partie finie \( F\) de \( \eN\) telle que 
            \begin{equation}
                \mathopen[ a' , b' \mathclose]\subset \bigcup_{n\in F}\mathopen] a'_n , b'_n \mathclose[.
            \end{equation}
            Le lemme \ref{LemPIOooRLkbo} nous dit alors que
            \begin{equation}
                \heartsuit=b'-a'\leq \ell\big( \bigcup_{n\in F}\mathopen] a'_n , b'_n \mathclose[ \big)\leq \sum_{n\in F}(b'_n-a'_n).
            \end{equation}
            La seconde inégalité se prouve en recopiant\footnote{Nous ne pouvons pas invoquer directement le lemme \ref{LemZQUooMdCpq} parce que nous n'avons pas encore prouvé que \( \ell\) était une mesure sur \( (\eR,\tribA_{\mS})\).} la preuve de \ref{LemZQUooMdCpq}. Nous continuons le calcul :
            \begin{equation}
                \heartsuit\leq\sum_{n\in F}(b_n-a_n)+\sum_{n\in F}\frac{ \epsilon }{ 2^{n+1} }\leq \sum_{n\in F}(b_n-a_n)+\frac{ \epsilon }{2}.
            \end{equation}
            Mais \( b'-a'=(b-a)-\frac{ \epsilon }{2}\), donc
            \begin{equation}
                b-a-\frac{ \epsilon }{2}\leq \sum_{n\in F}(b_n-a_n)+\frac{ \epsilon }{2}.
            \end{equation}
            D'où nous déduisons que
            \begin{equation}
                \ell(I)=b-a\leq \sum_{n\in F}(b_n-a_n)+\epsilon\leq \sum_{n\in \eN}(b_n-a_n)+\epsilon=\sum_{n\in \eN}\ell(I_n)+\epsilon.
            \end{equation}
            Cela étant valable pour tout \( \epsilon\) nous déduisons que
            \begin{equation}
                \ell(I)\leq\sum_{n\in \eN}\ell(I_n).
            \end{equation}

        \item[Si \( I\) est de longueur infinie]

        Étant donné que \( I\) est un intervalle de longueur infinie, il contient au moins un ensemble du type \( \mathopen] -\infty , a \mathclose]\) ou \( \mathopen[ a , +\infty [\); donc  pour tout \( M>0\), il existe \( N\geq 1\) tel que
            \begin{equation}
                \ell\big( I\cap\mathopen[ -N , N \mathclose] \big)\geq M.
            \end{equation}
            Mais \( I\cap\mathopen[ -N , N \mathclose]\) est un intervalle et 
            \begin{equation}
                I\cap\mathopen[ -N , N \mathclose]=\bigcup_{n\in \eN}I_n\cap\mathopen[ -N , N \mathclose]
            \end{equation}
            qui est une union disjointe. Par conséquent,
            \begin{equation}
                M\leq \ell\big( I\cap\mathopen[ -N , N \mathclose] \big)=\sum_n\ell\big( I_n\cap\mathopen[ -N , N \mathclose] \big)\leq\sum_n\ell(I_n).
            \end{equation}
            Cela étant vrai pour tout \( M>0\), nous concluons que
            \begin{equation}
                \sum_{n\in \eN}\ell(I_n)=\infty.
            \end{equation}
    \end{subproof}
\end{proof}

\begin{remark}
    Pour la preuve de \ref{LemUMVooZJgMu} nous ne pouvons pas classer les \( I_n\) en ordre croissant comme nous l'avons fait dans la preuve de \ref{LemIUQooEzHun}. En effet si \( I=\mathopen[ 0 , 1 \mathclose]\) et que nous recouvrons \( \mathopen[ 0 , \frac{ 1 }{2} [\) et \( \mathopen] \frac{ 1 }{2} , 1 \mathclose]\) par une infinité d'intervalles chacun, nous ne pouvons plus les classer par ordre croissant.
\end{remark}

\begin{proposition}[\cite{MesureLebesgueLi}]     \label{PropULFoodgXrR}
    La fonction \( \ell\) ainsi définie est une mesure \( \sigma\)-finie sur l'algèbre de parties \( \tribA_{\mS}\).
\end{proposition}

\begin{proof}
    Le fait que \( \ell\) soit \( \sigma\)-finie provient par exemple du fait que \( \ell\big( \mathopen] -n , n \mathclose[ \big)=2n\) tandis que \( \bigcup_n\mathopen] -n , n \mathclose[=\eR\).

        Nous devons à présent prouver que \( \ell\) est additive. Soient \( (A_i)_{i\in \eN}\) des éléments disjoints de \( \tribA_{\mS}\), avec leurs décomposition minimales
            \begin{equation}
                A_i=\bigcup_{k=1}^nI^{(i)}_k.
            \end{equation}
            Pour chaque \( i\in \eN\), le lemme \ref{LemUMVooZJgMu} nous indique que
            \begin{equation}
                \ell(A_i)=\sum_{k\in \eN}\ell(I^{(i)}_k).
            \end{equation}
            L'ensemble \( \eN\times \eN\) est dénombrable et nous pouvons considérer la décomposition 
            \begin{equation}
                \bigcup_{i\in \eN}A_i=\bigcup_{(i,k)\in \eN\times \eN}I^{(i)}_k.
            \end{equation}
            Cette décomposition n'est pas spécialement minimale\footnote{\( A_1\) pourrait contenir \( \mathopen[ 0 , 1 \mathclose]\) et \( A_2\) contenir \( \mathopen] 1 , 2 \mathclose]\).} mais elle est disjointe.
            Le lemme \ref{LemUMVooZJgMu} donne
            \begin{equation}
                \ell(\bigcup_i A_i)=\sum_{(i,k)\in \eN\times \eN}\ell(I_k^{(i)})=\sum_{i\in \eN}\left( \sum_{k\in \eN}\ell(I^{(i)}_k)\right)=\sum_{i\in \eN}\ell(A_i).
            \end{equation}
            La décomposition de la somme sur \( \eN^2\) en deux sommes sur \( \eN\) est faite en vertu de la proposition \ref{PropVQCooYiWTs}.
            
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure et tribu de Lebesgue}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem} \label{ThoDESooEyDOe}
    Il existe une unique mesure \( \lambda\) sur \( \big( \eR,\Borelien(\eR) \big)\) telle que
    \begin{equation}
        \lambda\big( \mathopen] a , b \mathclose[ \big)=b-a
    \end{equation}
    pour tout \( a\leq b\) dans \( \eR\).
\end{theorem}

\begin{proof}
    
    L'existence provient du théorème de prolongement de Hahn \ref{ThoLCQoojiFfZ} : la mesure \( \ell\) sur \( (\tribA_{\mS})\) se prolonge à \( \sigma(\tribA_{\mS})=\Borelien(\eR)\).

    Nous ne pouvons pas prouver l'unicité en invoquant la partie unicité de Hahn (c'est tentant parce que \( \ell\) est \( \sigma\)-finie) parce que dans ce théorème nous ne fixons la valeur de \( \lambda\) que sur une toute petite partie de \( \tribA_{\mS}\). Nous allons cependant voir que cette petite partie suffit à garantir l'unicité.

    La classe 
    \begin{equation}
        \tribD=\{ \mathopen] a , b \mathclose[\tq -\infty<a\leq b< +\infty \}
    \end{equation}
    est stable par intersection finie et engendre la tribu borélienne. En effet \( \tribD\) contient toutes les boules et donc une base dénombrable de la topologie de \( \eR\) (proposition \ref{PropNBSooraAFr}). Donc tous les ouverts de \( \eR\) sont dans \( \sigma(\tribD)\) et \( \sigma(\tribD)=\Borelien(\eR)\). Nous pouvons donc dire grâce au théorème \ref{ThoJDYlsXu} qu'il y a unicité de la mesure sur \( \Borelien(\eR)\) lorsque les valeurs sur \( \tribD\) sont fixées.
\end{proof}

\begin{definition}
    La mesure de l'espace mesuré \( \big( \eR,\Borelien(\eR),\lambda \big)\) donné par le théorème \ref{ThoDESooEyDOe} est la \defe{mesure de Lebesgue}{mesure!de Lebesgue} sur \( \eR\).
\end{definition}

\begin{remark}
    La véritable mesure de Lebesgue munie de la tribu de Lebesgue est l'espace complété de \( \big( \eR,\Borelien(\eR),\lambda \big)\) par la proposition \ref{PropIIHooAIbfj}. Lorsque nous parlons de \( \eR\) sans précisions, les ensembles \defe{mesurables}{mesurable!ensemble} sont les éléments de cette tribu complétée. Ce sera le plus souvent le cas pour la théorie de l'intégration.

    Quoi qu'il en soit nous allons poursuivre en parlant de la mesure de Lebesgue sur les boréliens.
\end{remark}

\begin{remark}
    Il n'est pas évident que la tribu de Lebesgue soit plus grande que celle des boréliens, ni que la tribu des parties soit plus grande que celle de Lebesgue. Nous mentionnons cependant les faits suivants.
    %TODO : donner des exemples
    \begin{enumerate}
        \item
            Il existe des ensembles mesurables non-boréliens, et cela ne nécessite pas l'axiome du choix. Un argument classique de cardinalité est donné dans \cite{SFYoobgQUp}. La construction la plus explicite que j'aie trouvée est dans \cite{XSHoosgoQa}, mais ça a l'air de demander des connaissances précises sur les ordinaux.
        \item
            Vu que l'ensemble de Cantor \( C\) est mesurable de mesure nulle, tout sous-ensemble de Cantor est mesurable de mesure nulle parce que la tribu de Lebesgue est complète par définition. Le cardinal de \( \partP(C)\) est strictement supérieur à la puissance du continu, alors que le cardinal de l'ensemble des boréliens est au plus égal à la puissance du continu. Donc il existe des non boréliens contenus dans Cantor; de tels non boréliens sont alors mesurables au sens de Lebesgue.

            Pour savoir des choses sur la cardinalité de l'ensemble des parties, on peut aller voir dans \cite{KZIoofzFLV}.
        \item
            Si nous admettons l'axiome du choix alors il existe des ensembles non mesurables.
    \end{enumerate}
\end{remark}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Propriétés de la mesure de Lebesgue}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}
    Tout ensemble dénombrable de \( \eR\) est mesurable de mesure nulle.
\end{proposition}

\begin{proof}
    Un point de \( \eR\) est un intervalle de mesure nulle. Si \( D\) est dénombrable, il est union disjointes et dénombrable de points. Le lemme \ref{LemUMVooZJgMu} nous dit alors que sa mesure est \( \lambda(D)=\sum_{i=1}^{\infty}\lambda(\{ a_i \})=0\).
\end{proof}

\begin{proposition}[Ensemble de Cantor]    \label{PropBEWooXZdKN}
    L'ensemble de Cantor\footnote{Définition \ref{DefIYDooVIDJs}} est borélien, non dénombrable et de mesure nulle.
\end{proposition}

\begin{proof}
    Nous reprenons les notations de la définition \ref{DefIYDooVIDJs}. Le fait que l'ensemble de Cantor soit non dénombrable a été prouvé dans la proposition \ref{PropTPPooDySbm}.

    L'ensemble de Cantor étant une intersection dénombrable de boréliens, il est borélien par le lemme \ref{LemBWNlKfA}. Vu que \( K_n\subset\mathopen[ 0 , 1 [\) nous avons \( \frac{1}{ 3 }K_n\leq \frac{1}{ 3 }\) et \( \frac{1}{ 3 }(K_n+2)\geq \frac{ 2 }{ 3 }\), donc \( K_n\) est une union disjointe de \( 2^n\) intervalles de mesure \( 2/3^n\). Nous avons donc
        \begin{equation}
            \lambda(K_n)=\left( \frac{ 2 }{ 3 } \right)^n.
        \end{equation}
        L'ensemble de Cantor étant contenu dans chacun des \( K_n\), sa mesure est plus petite que la mesure de chacun des \( K_n\) (lemme \ref{LemPMprYuC}) et donc \( \lambda(K)\leq \left( \frac{ 2 }{ 3 } \right)^n\) pour tout \( n\); ergo \( \lambda(K)=0\).
\end{proof}


\begin{proposition}
    La mesure de Lebesgue est invariante par translation, c'est à dire que si \( A\) est mesurable alors \( \lambda(A)=\lambda(A+\alpha)\) pour tout réel \( \alpha\).
\end{proposition}

\begin{proof}
    Nous commençons par les intervalles ouverts :
    \begin{equation}
    \lambda\big( \mathopen] a , b \mathclose[+\alpha \big)=\lambda\big( \mathopen] a+\alpha , b+\alpha \mathclose[ \big)=(b+\alpha)-(a+\alpha)=b-a=\lambda\big( \mathopen] a , b \mathclose[ \big).
    \end{equation}
    D'après ce qui est dit dans l'exemple \ref{ExDMPoohtNAj}, la mesure de Lebesgue sur les boréliens est invariante par translation.

    Si \( A\) est mesurable alors il existe un borélien \( B\) et un ensemble négligeable \( N\) tels que \( A=B\cup N\) par la caractérisation \ref{EqFJIoorxZNU} de la complétion. Alors \( A+\alpha=B+\alpha\cup N+\alpha\) et \( N+\alpha\) est encore un ensemble négligeable. Donc \( \lambda(A+\alpha)=\alpha(B+\alpha)=\lambda(B)\).
\end{proof}

Le mesure \( \ell\) définie sur l'algèbre de parties \( \tribA_{\mS}\) (voir proposition \ref{PropULFoodgXrR}). La proposition \ref{PropIUOoobjfIB} nous donne donc une mesure extérieure par
\begin{equation}    \label{EqJGXoogdKqb}
    \lambda^*(X)=\inf\{ \sum_n\ell(A_n);A_n\in\tribA_{\mS},X\subset\bigcup_nA_n \}.
\end{equation}

La proposition suivante montre que cette mesure extérieure peut être exprimée seulement avec des intervalles ouverts.
\begin{proposition} \label{PropTNOooDcfwn}
    Nous avons
    \begin{equation}
        \lambda^*(X)=\inf\{ \sum_{n\geq 1}\ell(I_n);\text{\( I_n\) sont des intervalles ouverts et }X\subset\bigcup_nI_n \}.
    \end{equation}
\end{proposition}

\begin{proof}
    Nous savons que dans la définition \eqref{EqJGXoogdKqb}, chacun des \( A_n\) est une réunion disjointe d'intervalles (pas spécialement ouverts) deux à deux disjoints; donc
    \begin{equation}
        \lambda^*(X)=\inf\{ \sum_n\ell(I_n);I_n\in\mS,X\subset\bigcup_nI_n \}.
    \end{equation}
    Soit \( \epsilon>0\). Si \( A\subset\bigcup_nI_n\), pour chaque \( n\geq 1\) nous considérons un intervalle ouvert \( J_n\) tel que \( I_n\subset J_n\) et \( \ell(I_n)+\frac{ \epsilon }{ 2^n }\leq \ell(J_n)\). Faisant cela pour chacun des découpages de \( X\) en intervalles nous trouvons
    \begin{equation}
        \lambda^*(X)\leq \inf\{ \sum_n\ell(J_n)\text{ \( J_n\) est ouvert et }X\subset\bigcup_nJ_n \}+\epsilon.
    \end{equation}
    Étant donné que \( \epsilon\) est arbitraire nous avons l'égalité.
\end{proof}

\begin{proposition}[\cite{MesureLebesgueLi}]    \label{PropMXIoojpKvd}
    Si \( X\subset \eR\) est tel que \( \lambda^*(X)<\infty\) alors
    \begin{enumerate}
        \item   \label{ItemGJUoozrDILi}
            Pour tout \( \epsilon>0\) il existe un ouvert \( \Omega_{\epsilon}\) tel que
            \begin{subequations}
                \begin{numcases}{}
                    X\subset\Omega_{\epsilon}\\
                    \lambda(\Omega_{\epsilon})\leq \lambda^*(X)+\epsilon.
                \end{numcases}
            \end{subequations}
        \item   \label{ItemGJUoozrDILii}
            Il existe une intersection dénombrable d'ouverts \( G\) telle que
            \begin{subequations}
                \begin{numcases}{}
                    X\subset G\\
                    \lambda(G)=\lambda^*(X).
                \end{numcases}
            \end{subequations}
    \end{enumerate}
\end{proposition}

\begin{proof}
    Pour \ref{ItemGJUoozrDILi}, la proposition \ref{PropTNOooDcfwn} nous a déjà dit que
    \begin{equation}
        \lambda^*(X)=\inf\{ \sum_n\ell(I_n)\text{ \( I_n\) est un intervalle ouvert}, X\subset\bigcup_nI_n \},
    \end{equation}
    donc si \( \epsilon>0\), il existe des intervalles ouverts \( I_n\) tels que 
    \begin{subequations}
        \begin{numcases}{}
            X\subset\bigcup_nI_n\\
            \sum_n\ell(I_n)\leq \lambda^*(X)+\epsilon.
        \end{numcases}
    \end{subequations}
    Si nous posons \( \Omega_{\epsilon}=\bigcup_nI_n\), alors nous avons bien
    \begin{subequations}
        \begin{numcases}{}
            X\subset\Omega_{\epsilon}\\
            \lambda(\Omega_{\epsilon})\leq\sum_n\ell(I_n)\leq \lambda^*(X)+\epsilon.
        \end{numcases}
    \end{subequations}

    En ce qui concerne \ref{ItemGJUoozrDILii}, pour chaque \( k\geq 1\) nous considérons l'ensemble \( \Omega_{1/k}\) obtenu comme précédemment avec \( \epsilon=1/k\) et nous posons \( G=\bigcap_{k\geq 1}\Omega_{1/k}\). Cela est une intersection dénombrable d'ouverts vérifiant \( X\subset G\) (parce que \( X\subset \Omega_{1/k}\) pour tout \( k\)) et donc \( \lambda^*(X)\leq\lambda^*(G)=\lambda(G)\). De plus pour tout \( k\) nous avons 
    \begin{equation}
        \lambda(G)\leq(\Omega_{1/k})\leq \lambda^*(X)+\frac{1}{ k }
    \end{equation}
    pour tout \( k\). En faisant \( k\to \infty\) nous avons
    \begin{equation}
        \lambda(G)\leq \lambda^*(X).
    \end{equation}
    Au final
    \begin{equation}
        \lambda(G)\leq \lambda^*(X)\leq \lambda(G),
    \end{equation}
    d'où l'égalité.
\end{proof}

\begin{corollary}
    Une partir \( N\subset \eR\) est négligeable\footnote{Définition \ref{DefAVDoomkuXi}.} si et seulement si \( \lambda^*(N)=0\).
\end{corollary}

\begin{proof}
    Nous savons que si \( N\) est négligeable il existe un borélien \( Y\) tel que \( N\subset Y\) avec \( \lambda(Y)=0\). Par conséquent\footnote{Au péril d'être lourd nous rappelons que \( \lambda^*\) est défini sur toutes les parties de \( \eR\).}
    \begin{equation}
        \lambda^*(N)\leq \lambda^*(Y)=\lambda(Y)=0.
    \end{equation}
    
    Pour l'implication inverse nous supposons que \( \lambda^*(N)=0\) et nous prenons l'ensemble \( G\) définit par la proposition \ref{PropMXIoojpKvd}\ref{ItemGJUoozrDILii} : c'est un borélien contenant \( N\) et tel que \( \lambda(G)=\lambda^*(N)=0\). L'ensemble \( N\) est donc négligeable.
\end{proof}

\begin{theorem}[Régularité extérieure de la mesure de Lebesgue] \label{ThoHFXooONFRN}
    Pour tout mesurable \( A\subset \eR\) nous avons
    \begin{equation}
        \lambda(A)=\inf\{ \lambda(\Omega);\text{\( \Omega\) ouvert contenant \( A\)} \}.
    \end{equation}
\end{theorem}
\index{régularité!extérieure de la mesure de Lebesgue}

\begin{proof}
    Nous commençons par le cas où \( B\) est un borélien.
    \begin{subproof}

        \item[Si \( B\) borélien, \( \lambda(B)<\infty\)]
        
        Soit \( \epsilon>0\); par la proposition \ref{PropMXIoojpKvd}\ref{ItemGJUoozrDILi} il existe un ouvert \( \Omega_{\epsilon}\) contenant \( B\) tel que \( \lambda(\Omega_{\epsilon})\leq \lambda^*(B)+\epsilon\). Vu qu'ici \( B\) est borélien, \( \lambda^*(B)=\lambda(B)\) et nous concluons que pour tout \( \epsilon\) il existe un ouvert \( \Omega_{\epsilon}\) tel que
        \begin{subequations}
            \begin{numcases}{}
                B\subset\Omega_{\epsilon}\\
                \lambda(\Omega_{\epsilon})\leq \lambda(B)+\epsilon,
            \end{numcases}
        \end{subequations}
        et donc
        \begin{equation}
            \lambda(B)=\inf\{ \lambda(\Omega);\text{ \( \Omega\) ouvert contenant \( B\) } \}.
        \end{equation}
        
        \item[Si \( B\) borélien, \( \lambda(B)=+\infty\)]

            Dans ce cas l'infimum est pris uniquement sur des ouverts \( \Omega\) tels que \( \lambda(\Omega)=\infty\).

        \item[Si \( A\) est mesurable non borélien]
    
    Nous passons maintenant au cas où \( A \) est mesurable sans être borélien. Il s'écrit donc \( A=B\cup N\) avec \( B\) borélien et \( N\) négligeable par la proposition \ref{thoCRMootPojn}, et par définition \( \lambda(A)=\lambda(B)\). Si \( Y\) est un borélien tel que \( N\subset Y\) et \( \lambda(Y)=0\) alors
    \begin{subequations}
        \begin{align}
            \lambda(A)=\lambda(B)&=\inf\{ \lambda(\Omega)\tq \text{ \( \Omega\) ouvert}, B\subset\Omega \}\label{subeqMTHoopkSKOi}\\
            &\leq\inf\{ \lambda(\Omega)\tq \text{ \( \Omega\) ouvert}, B\cup N\subset\Omega \}  \label{subeqMTHoopkSKOii}\\
            &\leq\inf_{\Omega',Y'}\{ \lambda(\Omega'\cup Y')\tq \text{ \( \Omega'\), \( Y'\) ouverts}, B\subset\Omega', Y\subset Y' \}\label{subeqMTHoopkSKOiii}\\
            &\leq\inf_{\Omega',Y'}\{ \lambda(\Omega')+\lambda(Y')\tq \text{ \( \Omega'\), \( Y'\) ouverts},  B\subset\Omega',Y\subset Y' \}\label{subeqMTHoopkSKOiv}\\
            &\leq\inf_{\Omega'}\{ \lambda(\Omega')\tq \text{ \( \Omega'\) ouvert},  B\subset\Omega \}\label{subeqMTHoopkSKOv}\\
            &=\lambda(B).
        \end{align}
    \end{subequations}
    Justifications :
    \begin{itemize}
        \item \eqref{subeqMTHoopkSKOi} Le cas borélien déjà fait.
        \item \eqref{subeqMTHoopkSKOii} Les ouverts \( \Omega\) tels que \( B\cup N\subset \Omega\) vérifient a fortiori \( B\subset \Omega\); nous avons donc agrandit l'ensemble sur lequel l'infimum est pris.
        \item \eqref{subeqMTHoopkSKOiii} Parmi les ouverts \( \Omega\) qui recouvrent \( B\cup N\), il y a ceux de la forme \( \Omega'\cup Y'\) où \( \Omega'\) recouvre \( B\) et \( Y'\) est un ouvert contenant \( Y\). Donc nous avons rétréci l'ensemble sur lequel l'infimum est pris et par conséquent agrandit l'infimum.
        \item \eqref{subeqMTHoopkSKOiv} Mesure d'une union majorée par la somme des mesures.
        \item \eqref{subeqMTHoopkSKOv} Vu que \( Y\) est borélien, \( \lambda(Y)=\inf_{\text{\( Y'\) ouvert}}\{ \lambda(Y')\tq Y\subset Y' \}=0\). Donc pour tout \( \Omega'\) et tout \( \epsilon>0\), nous pouvons trouver un \( Y'\) vérifiant les conditions tel que \( \lambda(\Omega')+\lambda(Y')\leq \lambda(\Omega')+\epsilon\).
    \end{itemize}
    Toutes les inégalités sont des égalités en en particulier \eqref{subeqMTHoopkSKOii} donne
    \begin{equation}
        \lambda(A)=\inf\{ \lambda(\Omega)\tq \text{ \( \Omega\) ouvert}, B\cup N\subset\Omega \},
    \end{equation}
    ce qu'il fallait.
    \end{subproof}
    
\end{proof}

\begin{proposition}[\cite{MesureLebesgueLi}]    \label{PropEZNoofLkVb}
    Si \( A\) est mesurable dans \( \eR\) et si \( \epsilon>0\) alors il existe un ouvert \( \Omega_{\epsilon}\) et un fermé \( F_{\epsilon}\) tels que
    \begin{subequations}    \label{subeqHNEooaNqDu}
        \begin{numcases}{}
            F_{\epsilon}\subset A\subset \Omega_{\epsilon}\\
            \lambda(\Omega_{\epsilon}\setminus F_{\epsilon})\leq \epsilon.
        \end{numcases}
    \end{subequations}
\end{proposition}

\begin{proof}
    Nous commençons par le cas d'un borélien \( B\).
    \begin{subproof}
        \item[Première étape]
        
            Montrons qu'il existe un ouvert \( U_{\epsilon}\) tel que
            \begin{subequations}
                \begin{numcases}{}
                    B\subset U_{\epsilon}\\
                    \lambda(U_{\epsilon}\setminus B)\leq \frac{ \epsilon }{2}.
                \end{numcases}
            \end{subequations}
            Si \( \lambda(B)<\infty\) alors le théorème \ref{ThoHFXooONFRN} nous donne un ouvert \( U_{\epsilon}\) tel que \( B\subset U_{\epsilon}\) et \( \lambda(U_{\epsilon})\leq \lambda(B)+\frac{ \epsilon }{2}\). Nous avons alors
            \begin{equation}
                \lambda(\Omega_{\epsilon}\setminus B)=\lambda(\Omega_{\epsilon})-\lambda(B)\leq \frac{ \epsilon }{2}.
            \end{equation}
            Si par contre \( \lambda(B)=\infty\), nous posons \( B_n=B\cap\mathopen[ -n , n \mathclose]\) et \( \epsilon_n=\epsilon/2^{n+1}\). Pour chaque \( n\) nous avons un ouvert \( \Omega_n\) tel que
            \begin{subequations}
                \begin{numcases}{}
                    B_n\subset \Omega_n\\
                    \lambda(\Omega_n\setminus B_n)\leq \frac{ \epsilon }{ 2^{n+1} }
                \end{numcases}
            \end{subequations}
            Par conséquent en posant \( \Omega=\bigcup_{n\geq 1}\Omega_n\) nous avons\footnote{Nous utilisons la petite relation ensembliste \( \big( \bigcup_nA_n \big)\setminus\big( \bigcup_nB_n \big)\subset \bigcup_n(A_n\setminus B_n)\).}
            \begin{subequations}
                \begin{numcases}{}
                    B\subset \Omega\\
                    \lambda(\Omega\setminus B)\leq \lambda\big( \bigcup_n(\Omega_n\setminus B_n) \big)\leq \sum_{n\geq 1}\lambda(\Omega_n\setminus B_n)=\frac{ \epsilon }{2}.
                \end{numcases}
            \end{subequations}
            La première étape est terminée.

        \item[Deuxième étape]

            Nous prouvons à présent qu'il existe un ouvert \( \Omega_{\epsilon}\) et un fermé \( F_{\epsilon}\) tels que
            \begin{subequations}
                \begin{numcases}{}
                    F_{\epsilon}\subset B\subset \Omega_{\epsilon}\\
                    \lambda(\Omega_{\epsilon}\setminus B)\leq \frac{ \epsilon }{2}\\
                    \lambda(B\setminus F_{\epsilon})\leq \frac{ \epsilon }{2}.
                \end{numcases}
            \end{subequations}
            L'ouvert \( \Omega_{\epsilon}\), nous l'avons déjà de l'étape précédente. Pour le fermé, nous appliquons la première étape au borélien \( B^c\); ce qui nous trouvons est un ouvert \( G_{\epsilon}\) tel que
            \begin{subequations}
                \begin{numcases}{}
                    B^c\subset G_{\epsilon}\\
                    \lambda(G_{\epsilon}\setminus B^c)\leq \frac{ \epsilon }{2}.
                \end{numcases}
            \end{subequations}
            En posant \( F_{\epsilon}=G_{\epsilon}^c\) nous avons un fermé tel que \( F_{\epsilon}\subset B\) et
            \begin{equation}
                \lambda(B\setminus F_{\epsilon})=\lambda(F_{\epsilon}^c\setminus B^c)=\lambda(G_{\epsilon}\setminus B^c)\leq \frac{ \epsilon }{2}.
            \end{equation}
            
        \item[Dernière étape]

            Les ensembles \( F_{\epsilon}\) et \( \Omega_{\epsilon}\) trouvés à la deuxième étape donnent bien les relations \eqref{subeqHNEooaNqDu}. En effet \( \Omega_{\epsilon}\setminus F_{\epsilon}=(\Omega_{\epsilon}\setminus B)\cup(B\setminus F_{\epsilon})\), donc
            \begin{equation}
                \lambda(\Omega_{\epsilon}\setminus F_{\epsilon})\leq \lambda(\Omega_{\epsilon}\setminus B)+\lambda(B\setminus F_{\epsilon})=\epsilon.
            \end{equation}
    \end{subproof}
    Nous passons au cas où \( A=B\cup N\) est mesurable. Nous commençons par prendre les \( \Omega_{\epsilon}\) et \( F_{\epsilon}\) qui correspondent à \( B\) :
    \begin{subequations}
        \begin{numcases}{}
            F_{\epsilon}\subset B\subset \Omega_{\epsilon}\\
            \lambda(\Omega_{\epsilon}\setminus F_{\epsilon})\leq \epsilon.
        \end{numcases}
    \end{subequations}
    Soit \( Y\) un borélien tel que \( N\subset Y\) et \( \lambda(Y)\) puis un ouvert \( Y'\) tel que \( \lambda(Y')\leq \epsilon\) et \( Y\subset Y'\). L'existence d'un tel \( Y'\) est assurée par la proposition \ref{ThoHFXooONFRN} appliquée à \( Y\). Nous vérifions que les ensembles \( F_{\epsilon}\) et \( \Omega_{\epsilon}\cup Y'\) fonctionnent. En effet \( \Omega_{\epsilon}\cup Y'\setminus F_{\epsilon}\subset (\Omega_{\epsilon}\setminus F_{\epsilon})\cup Y'\), donc
    \begin{subequations}
        \begin{numcases}{}
            F_{\epsilon}\subset B\cup N\subset \Omega_{\epsilon}\cup Y'\\
            \lambda\big( (\Omega_{\epsilon}\setminus F_{\epsilon}) \big)\leq \lambda(\Omega_{\epsilon}\setminus F_{\epsilon})+\lambda(Y')\leq 2\epsilon.
        \end{numcases}
    \end{subequations}
    Donc en réalité il faut choisir \( \Omega_{\epsilon/2}\), \( F_{\epsilon/2}\) et \( \lambda(Y')\leq \epsilon/2\).
\end{proof}

\begin{theorem}[Régularité intérieure de la mesure de Lebesgue]
    Si \( A\) est mesurable dans \( \eR\) alors
    \begin{equation}
        \lambda(A)=\sup\{ \lambda(K); \text{\( K\) compact contenu dans \( B\)} \}.
    \end{equation}
\end{theorem}
\index{régularité!intérieure de la mesure de Lebesgue}

\begin{proof}
    Par la proposition \ref{PropEZNoofLkVb} nous avons
    \begin{equation}    \label{EqTPEooUHTbH}
        \lambda(A)=\sup_{\text{\( F\) fermé dans \( A\)}}\lambda(F).
    \end{equation}
    Pour un tel \( F\) nous posons \( K_n=F\cap\mathopen[ -n , n \mathclose]\) qui est compact\footnote{parce que fermé et borné, théorème de Borel-Lebesgue \ref{ThoXTEooxFmdI}.} et contenu dans \( B\). De plus le lemme \ref{LemAZGByEs}\ref{ItemJWUooRXNPcii} nous dit que
    \begin{equation}
        \lambda(F)=\lim_{n\to \infty} \lambda(K_n)
    \end{equation}
    Donc tous les \( \lambda(F)\) peuvent être arbitrairement approchés par un \( \lambda(K)\) avec \( K\) compact dans \( A\), et le supremum \eqref{EqTPEooUHTbH} n'est pas affecté en nous restreignant à prendre des compacts contenus dans \( B\) :
    \begin{equation}    
        \lambda(A)=\sup_{\text{\( F\) fermé dans \( A\)}}\lambda(F)=\sup_{\text{\( K\) compact dans \( A\)}}\lambda(K).
    \end{equation}
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Lebesgue sur \texorpdfstring{$ \eR^d$}{Rd}}
%---------------------------------------------------------------------------------------------------------------------------

La mesure de Lebesgue sur \( \eR^d\) est d'abord la mesure définie sur \( \big( \eR^d,\Borelien(\eR^d) \big)\) comme le produit \( \lambda\otimes\ldots\otimes \lambda\). Puis la complétion.
