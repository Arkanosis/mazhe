% This is part of Mes notes de mathématique
% Copyright (c) 2011-2013
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Sommes de familles infinies}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Convergence commutative}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
    Soit \( x_k\) une suite dans un espace vectoriel normé \( E\). Nous disons que la suite \defe{converge commutativement}{convergence!commutative} vers \( x\in E\) si \( \lim_{n\to \infty}\| x_n-x \| =0\) et si pour toute bijection \( \tau\colon \eN\to \eN\) nous avons aussi
    \begin{equation}
        \lim_{n\to \infty} \| x_{\tau(k)}-x \|=0.
    \end{equation}
    La notion de convergence commutative est surtout intéressante pour les séries. La somme
    \begin{equation}
        \sum_{k=0}^{\infty}x_k
    \end{equation}
    converge commutativement vers \( x\) si \( \lim_{N\to \infty} \| x-\sum_{k=0}^Nx_k \|=0\) et si pour toute bijection \( \tau\colon \eN\to \eN\) nous avons
    \begin{equation}
        \lim_{N\to \infty} \| x-\sum_{k=0}^Nx_{\tau(k)} \|=0.
    \end{equation}
\end{definition}

Nous démontrons maintenant qu'une série converge commutativement si et seulement si elle converge absolument.

Pour le sens inverse, nous avons la proposition suivante.
\begin{proposition}
    Soit \( \sum_{k=0}^{\infty}a_k\) une série réelle qui converge mais qui ne converge pas absolument. Alors pour tout \( b\in \eR\), il existe une bijection \( \tau\colon \eN\to \eN\) telle que \( \sum_{i=0}^{\infty}a_{\tau(i)}=b\).
\end{proposition}
Pour une preuve, voir \href{http://gilles.dubois10.free.fr/analyse_reelle/seriescomconv.html}{chez Gilles Dubois}.

\begin{proposition} \label{PopriXWvIY}
    Soit \( (a_i)_{i\in \eN}\) une suite dans \( \eC\) convergent absolument. Alors elle converge commutativement.
\end{proposition}

\begin{proof}
    Soit \( \epsilon>0\). Nous posons \( \sum_{i=0}^\infty a_i=a\) et nous considérons \( N\) tel que
    \begin{equation}
        | \sum_{i=0}^Na_i-a |<\epsilon.
    \end{equation}
    Étant donné que la série des \( | a_i |\) converge, il existe \( N_1\) tel que pour tout \( p,q>N_1\) nous ayons \( \sum_{i=p}^q| a_i |<\epsilon\). Nous considérons maintenant une bijection \( \tau\colon \eN\to \eN \). Prouvons que la série \( \sum_{i=0}^{\infty}| a_{\tau(i)} |\) converge. Nous choisissons \( M\) de telle sorte que pour tout \( n>M\), \( \tau(n)>N_1\); alors si \( p,q>M\) nous avons
    \begin{equation}
        \sum_{i=p}^q| a_{\tau(i)} |<\epsilon.
    \end{equation}
    Par conséquent la somme de la suite \( (a_{\tau(i)})\) converge. Nous devons montrer à présent qu'elle converge vers la même limite que la somme «usuelle» \( \lim_{N\to \infty} \sum_{i=0}^Na_i\).

    Soit \( n>\max\{ M,N \}\). Alors
    \begin{equation}
        \sum_{k=0}^na_{\tau(k)}-\sum_{k=0}^na_k=\sum_{k=0}^Ma_{\tau(k)}-\sum_{k=0}^Na_k+\underbrace{\sum_{M+1}^na_{\tau(k)}}_{<\epsilon}-\underbrace{\sum_{k=N+1}^na_k}_{<\epsilon}.
    \end{equation}
    Par construction les deux derniers termes sont plus petits que \( \epsilon\) parce que \( M\) et \( N\) sont les constantes de Cauchy pour les séries \( \sum a_{\tau(i)}\) et \( \sum a_i\). Afin de traiter les deux premiers termes, quitte à redéfinir \( M\), nous supposons que \( \{ 1,\ldots, N \}\subset \tau\{ 1,\ldots, M \}\); par conséquent tous les \( a_i\) avec \( i<N\) sont atteints par les \( a_{\tau(i)}\) avec \( i<M\). Dans ce cas, les termes qui restent dans la différence
    \begin{equation}
        \sum_{k=0}a_{\tau(k)}-\sum_{k=0}^Na_k
    \end{equation}
    sont des \( a_k\) avec \( k>N\). Cette différence est donc en valeur absolue plus petite que \( \epsilon\), et nous avons en fin de compte que
    \begin{equation}
        \left| \sum_{k=0}^na_{\tau(k)}-\sum_{k=0}^na_k \right| <\epsilon.
    \end{equation}
\end{proof}

\begin{proposition}     \label{PropyFJXpr}
    Soit \( \sum_{i=O}^{\infty}a_i\) une série qui converge mais qui ne converge pas absolument. Pour tout \( b\in \eR\), il existe une bijection \( \tau\colon \eN\to \eN\) telle que \( \sum_{i=}^{\infty}a_{\tau(i)}=b\).
\end{proposition}

Les propositions \ref{PopriXWvIY} et \ref{PropyFJXpr} disent entre autres qu'une série dans \( \eC\) est commutativement sommable si et seulement si elle est absolument sommable.

Soit \( (a_i)_{i\in I}\) une famille de nombres complexes indexée par un ensemble \( I\) quelconque. Nous allons nous intéresser à la somme \( \sum_{i\in I}a_i\).


Soit \( \{ a_i \}_{i\in I}\) des nombres positifs. Nous définissons la somme
\begin{equation}
    \sum_{i\in I}a_i=\sup_{\text{\( J\) fini}}\sum_{j\in J}a_j.
\end{equation}
Notons que cela est une définition qui ne fonctionne bien que pour les sommes de nombres positifs. Si \( a_i=(-1)^i\), alors selon la définition nous aurions \( \sum_i(-1)^i=\infty\). Nous ne voulons évidemment pas un tel résultat.

Dans le cas de familles de nombres réels positifs, nous avons une première définition de la somme. 
\begin{definition}  \label{DefHYgkkA}
Soit \( (a_i)_{i\in I}\) une famille de nombres réels positifs indexés par un ensemble quelconque \( I\). Nous définissons
\begin{equation}
    \sum_{i\in I}a_i=\sup_{\text{\( J\) fini dans \( I\)}}\sum_{j\in J}a_j.
\end{equation}
\end{definition}

\begin{definition}  \label{DefIkoheE}
    Si \( \{ v_i \}_{i\in I}\) est une famille de vecteurs dans un espace vectoriel normé indexée par un ensemble quelconque \( I\). Nous disons que cette famille est \defe{sommable}{famille!sommable} de somme \( v\) si pour tout \( \epsilon>0\), il existe un \( J_0\) fini dans \( I\) tel que pour tout ensemble fini \( K\) tel que \( J_0\subset K\) nous avons
    \begin{equation}
        \| \sum_{j\in K}v_j-v \|<\epsilon.
    \end{equation}
\end{definition}
Notons que cette définition implique la convergence commutative.

\begin{example}
    La suite \( a_i=(-1)^i\) n'est pas sommable parce que quel que soit \( J_0\) fini dans \( \eN\), nous pouvons trouver \( J\) fini contenant \( J_0\) tel que \( \sum_{j\in J}(-1)^j>10\). Pour cela il suffit d'ajouter à \( J_0\) suffisamment de termes pairs. De la même façon en ajoutant des termes impairs, on peut obtenir \( \sum_{j\in J'}(-1)^i<-10\).
\end{example}

\begin{example}
    De temps en temps, la somme peut sortir d'un espace. Si nous considérons l'espace des polynômes \( \mathopen[ 0 , 1 \mathclose]\to \eR\) muni de la norme uniforme, la somme de l'ensemble
    \begin{equation}
        \{ 1,-1,\pm\frac{ x^n }{ n! } \}_{n\in \eN}
    \end{equation}
    est zéro.

    Par contre la somme de l'ensemble \( \{ 1,\frac{ x^n }{ n! } \}_{n\in \eN}\) est l'exponentielle qui n'est pas un polynôme.
\end{example}

\begin{example}
    Au sens de la définition \ref{DefIkoheE} la famille
    \begin{equation}
        \frac{ (-1)^n }{ n }
    \end{equation}
    n'est pas sommable. En effet la somme des termes pairs est \( \infty\) alors que la somme des termes impairs est \( -\infty\). Quel que soit \( J_0\in \eN\), nous pouvons concocter, en ajoutant des termes pairs, un \( J\) avec \( J_0\subset J\) tel que \( \sum_{j\in J}(-1)^j/j\) soit arbitrairement grand. En ajoutant des termes négatifs, nous pouvons également rendre \( \sum_{j\in J}(-1)^j/j\) arbitrairement petit.
\end{example}

La définition générale de la somme \ref{DefIkoheE} est compatible avec la définition usuelle dans les cas où cette dernière s'applique.
\begin{proposition}[commutative sommabilité]\label{PropoWHdjw}
    Soit \( I\) un ensemble dénombrable et une bijection \( \tau\colon \eN\to I\). Soit \( (a_i)_{i\in I}\) une famille dans un espace vectoriel normé. Alors
    \begin{equation}
        \sum_{k=0}^{\infty}a_{\tau(k)}=\sum_{i\in I}a_i
    \end{equation}
    dès que le membre de droite existe. Le membre de gauche est définit par la limite usuelle.
\end{proposition}

\begin{proof}
    Nous posons \( a=\sum_{i\in I}a_i\). Soit \( \epsilon>0\) et \( J_0\) comme dans la définition. Nous choisissons
    \begin{equation}
        N>\max_{j\in J_0}\{ \tau^{-1}(j) \}.
    \end{equation}
    En tant que sommes sur des ensembles finis, nous avons l'égalité
    \begin{equation}
        \sum_{k=0}^Na_{\tau(k)}=\sum_{j\in J_0}a_j
    \end{equation}
    où \( J\) est un sous-ensemble de \( I\) contenant \( J_0\). Soit \( J\) fini dans \( I\) tel que \( J_0\subset J\). Nous avons alors
    \begin{equation}
        \| \sum_{k=0}^Na_{\tau(k)}-a \|=\| \sum_{j\in J}a_j-a \|<\epsilon.
    \end{equation}
    Nous avons prouvé que pour tout \( \epsilon\), il existe \( N\) tel que \( n>N\) implique \( \| \sum_{k=0}^na_{\tau(k)}-a\| <\epsilon\).
\end{proof}

\begin{corollary}
    Nous pouvons permuter une somme dénombrable et une fonction continue. C'est à dire que si \( f\) est une fonction continue sur l'espace vectoriel normé \( E\) et \( (a_i)_{i\in I}\) une famille sommable dans \( E\) alors
    \begin{equation}
        f\left( \sum_{i\in I}a_i \right)=\sum_{i\in I}f(a_i).
    \end{equation}
\end{corollary}

\begin{proof}
    En utilisant une bijection \( \tau\) entre \( I\) et \( \eN\) ainsi que le résultat connu à propos des sommes sur \( \eN\), nous avons
    \begin{equation}
        f\left( \sum_{i\in I}a_i \right)=f\left( \sum_{k=0}^{\infty}a_{\tau(k)} \right)=\sum_{k=0}^{\infty}f(a_{\tau(k)})=\sum_{i\in I}f(a_i).
    \end{equation}
\end{proof}

\begin{corollary}
    Si une série de fonctions continues converge normalement, alors la somme est continue.
\end{corollary}

\begin{proof}
    Soit \( I\) dénombrable et considérons une famille de fonctions continues \( (f_n)_{n\in I}\) telles que la famille \( (\| f_i \|_{\infty})_{i\in I}\) soit sommable. Utilisant une bijection entre \( I\) et \( \eN\), le théorème \ref{PropUEMoNF} s'applique.
\end{proof}


La proposition suivante nous enseigne que les sommes infinies peuvent être manipulée de façon usuelle.
\begin{proposition} \label{PropMpBStL}
    Soit \( I\) un ensemble dénombrable. Soient \( (a_i)_{i\in I}\) et \( (b_i)_{i\in I}\), deux familles de réels positifs telles que \( a_i<b_i\) et telles que \( (b_i)\) est sommable. Alors \( (a_i)\) est sommable.

    Si \( (a_i)_{i\in I}\) est une famille de complexes telle que \( (| a_i |)\) est sommable, alors \( (a_i)\) est sommable.
\end{proposition}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Complétude}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{proposition}[Inégalité de Minkowski]     \label{PropInegMinkKUpRHg}
    Si \( 1\leq p<\infty\) et si \( f,g\in L^p(\Omega,\tribA,\mu)\) alors
    \begin{enumerate}
        \item
            \( \| f+g \|_p\leq \| f \|_p+\| g_p \|\)
        \item
            Il y a égalité si et seulement si les vecteurs \( f(x)\) et \( g(x)\) sont presque partout colinéaires : il existe \( \alpha,\beta\) tels que \( \alpha f+\beta g=0\) presque partout.
    \end{enumerate}
\end{proposition}

\begin{theorem}
    Pour \( 1\leq p<\infty\), l'espace \( L^p(\Omega,\tribA,\mu)\) est complet.
\end{theorem}

\begin{proof}
    Cette preuve provient de \cite{SuquetFourierProba}, disponible aussi sous forme d'application du \wikipedia{fr}{théorème_de_Riesz-Fischer}{théorème de Riesz-Fischer} sur wikipedia. 
    
    Soit \( (f_n)_{n\in\eN}\) une suite de Cauchy dans \( L^p\). Pour tout \( i\), il existe \( N_i\in\eN\) tel que $\| f_p-f_q \|_p\leq 2^{-i}$ pour tout \( p,q\geq N_i\). Nous considérons la sous suite \( g_i=f_{N_i}\), de telle sorte qu'en particulier
    \begin{equation}    \label{EqJLoDID}
        \|g_i-g_{i-1}\|_p\leq 2^{-i}.
    \end{equation}
    Pour chaque \( j\) nous considérons la somme télescopique
    \begin{equation}
        g_j=g_0+\sum_{i=1}^j(g_i-g_{i-1})
    \end{equation}
    et l'inégalité
    \begin{equation}
        | g_j |\leq | g_0 |+\sum_{i=1}^j| g_i-g_{i-1} |.
    \end{equation}
    Nous allons noter
    \begin{equation}        \label{EqSomPaFPQOWC}
        h_j=| g_0 |+\sum_{i=1}^j| g_i-g_{i-1} |.
    \end{equation}
    La suite de fonctions \( (h_j)\) ainsi définie est une suite croissante de fonctions positive qui converge donc (ponctuellement) vers une fonction \( h\) qui peut éventuellement valoir l'infini en certains points. Par continuité de la fonction \( x\mapsto x^p\) nous avons
    \begin{equation}
        \lim_{j\to \infty} h_j^p=h^p,
    \end{equation}
    puis par le théorème de la convergence monotone (théorème \ref{ThoConvMonFtBoVh}) nous avons
    \begin{equation}
        \lim_{j\to \infty} \int_{\Omega}h_j^pd\mu=\int_{\Omega}h^pd\mu.
    \end{equation}
    Utilisant à présent la continuité de la fonction \( x\mapsto x^{1/p}\) nous trouvons
    \begin{equation}
        \lim_{j\to \infty} \left( \int h_j^p \right)^{1/p}=\left( \int | h |^p \right)^{1/p}.
    \end{equation}
    Nous avons donc déjà montré que
    \begin{equation}
        \lim_{j\to \infty} \| h_j \|_p=\left( \int | h |^p \right)^{1/p}
    \end{equation}
    où, encore une fois, rien ne garantit à ce stade que l'intégrale à droite soit un nombre fini. En utilisant l'inégalité de Minkowski (proposition \ref{PropInegMinkKUpRHg}) et l'inégalité \eqref{EqJLoDID} nous trouvons
    \begin{equation}
        \|h_j\|_p\leq \|g_0\|_p+\sum_{i=1}^j\|g_i-g_{i-1}\|_p\leq \|g_0\|_p+1.
    \end{equation}
    En passant à la limite,
    \begin{equation}
        \left( \int| h |^p \right)^{1/p}=\lim_{j\to \infty}\|h_j\|_p \leq \|g_0\|_p+1<\infty.
    \end{equation}
    Par conséquent \( \int| h |^p\) est finie et
    \begin{equation}    \label{EqgLpdUPOBP}
        h\in L^p(\Omega,\tribA,\mu).
    \end{equation}
    En particulier, l'intégrale \( \int h\) est finie (parce que \( p\geq 1\)) et donc que \( h(x)<\infty\) pour presque tout \( x\in\Omega\).

    Nous savons que \( h(x)\) est la limite des sommes partielles \eqref{EqSomPaFPQOWC}, en particulier la série
    \begin{equation}
        \sum_{j=1}^{\infty}| g_i-g_{i-1} |
    \end{equation}
    converge ponctuellement. En vertu du corollaire \ref{CorCvAbsNormwEZdRc}, la série de terme général \( g_i-g_{i-1}\) converge ponctuellement. La suite \( g_i\) converge donc vers une fonction que nous notons \( g\). Par ailleurs la suite \( g_i\) est dominée par \( h\in L^p\), le théorème de la convergence dominée (théorème \ref{ThoConvDomLebVdhsTf}) implique que
    \begin{equation}
        \lim_{j\to \infty} \|g_j-g\|_p=0.
    \end{equation}
    Nous allons maintenant prouver que \( \lim_{n\to \infty\|f_n-g\|_p} =0\). Soit \( \epsilon>0\). Pour tout \( n\) et \( i\) nous avons
    \begin{equation}
        \|f_n-g\|_p=\|f_n-f_{N_i}+f_{N_i}-g\|_p\leq\|f_n-f_{N_i}\|_p+\|f_{N_i}-g\|_p.
    \end{equation}
    Pour rappel, \( f_{N_i}=g_i\). Si \(i\) et \( n\) sont suffisamment grands nous pouvons obtenir que chacun des deux termes est plus petit que \( \epsilon/2\).

    Il nous reste à prouver que \( g\in L^p(\Omega,\tribA,\mu)\). Nous avons déjà vu (équation \eqref{EqgLpdUPOBP}) que \( h\in L^p\), mais \( | g_i |\leq h^p\), par conséquent  \( g\in L^p\).

    Nous avons donc montré que la suite de Cauchy \( (f_n)\) converge vers une fonction de \( L^p\), ce qui signifie que \( L^p\) est complet.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{L'espace \texorpdfstring{$L^2$}{$L^2$}}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit \( (\Omega,\tribA,\mu)\) un espace mesuré. Nous considérons l'opération
\begin{equation}    \label{DefProdScalLubrgTj}
    \langle f, g\rangle =\int_{\Omega}f(\omega)\overline{ g(\omega)}d\mu(\omega)
\end{equation}
et la norme associée
\begin{equation}
    \| f \|_2=\sqrt{\langle f, f\rangle }.
\end{equation}
Nous considérons l'ensemble
\begin{equation}
    \mL^2(\Omega,\mu)=\{ f\colon \Omega\to \eR\tq \| f \|_2<\infty \}
\end{equation}
et la relation d'équivalence \( f\sim g\) si et seulement si \( f(x)=g(x)\) pour \( \mu\)-presque tout \( x\). L'espace que nous considérons est
\begin{equation}
    L^2=\mL^2/\sim.
\end{equation}

\begin{lemma}
    La formule \eqref{DefProdScalLubrgTj} définit un produit scalaire sur \( L^2\).
\end{lemma}

\begin{proof}
    Nous devons d'abord montrer que la formule passe au quotient. Pour cela, nous considérons des fonctions \( \alpha\) et \( \beta\) nulles presque partout et nous regardons le produit de \( f_1=f+\alpha\) par \( g_1=g+\beta\) :
    \begin{equation}
        \langle f_1, g_1\rangle =\int fg+\beta f+\alpha g+ \alpha\beta.
    \end{equation}
    Les fonction \( \beta f\), \( \alpha g\) et \( \alpha\beta\) étant nulles presque partout, leur intégrale est nulle et nous avons bien \( \langle f_1, g_1\rangle =\langle f,g \rangle \). Nous pouvons donc considérer le produit sur l'ensemble des classes.

    Pour vérifier que la formule est un produit scalaire, le seul point non évidement est de prouver que \( \langle f, f\rangle =0\) implique \( f=0\). Cela découle du fait que
    \begin{equation}
        \langle f, f\rangle =\int_{\Omega}| f |^2.
    \end{equation}
    La fonction \( x\mapsto | f(x) |^2\) vérifie les hypothèses du lemme \ref{Lemfobnwt}. Par conséquent \( | f(x) |^2\) est presque partout nulle.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Espaces de Hilbert}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
    Un espace vectoriel muni d'un produit scalaire est une espace \defe{préhilbertien}{préhilbertien}. Si il est complet pour la norme induite par le produit scalaire alors il est de \defe{Hilbert}{Hilbert}.

    Dans les deux cas nous considérons la topologie métrique dérivant du produit scalaire.
\end{definition}

Les espaces de Hilbert sont des cas particuliers des \defe{espaces de Banach}{espace!Banach}\index{Banach!espace} qui sont les espaces vectoriels normés complets pour la topologie de la norme. La différence avec les espaces de Hilbert sont que l'espace de Banach ne demande pas que la norme dérive d'un produit scalaire.

\begin{proposition}     \label{PropTdupIG}
    Si \( \hH\) est un espace de Hilbert réel, alors
    \begin{equation}
        \| x+y \|^2=\| x \|^2+\| y \|^2+2\langle x, y\rangle .
    \end{equation}
    Si \( \hH\) est un espace de Hilbert complexe alors
    \begin{equation}        \label{EqrbBlkK}
        \| x+y \|^2=\| x \|^2+\| y \|^2+2\Reel\langle x, y\rangle .
    \end{equation}
    Dans les deux cas nous avons l'inégalité de Cauchy-Schwarz\index{inégalité!Cauchy-Schwarz}\index{Cauchy-Schwarz} :
    \begin{equation}
        | \langle x, y\rangle  |\leq \| x \|\| y \|.
    \end{equation}
\end{proposition}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de la projection}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Sources : \cite{ProbCOndutetz} et \wikipedia{en}{Hilbert_projection_theorem}{théorème de projection} sur wikipédia.

\begin{theorem}[Projection sur partie fermée convexe]\index{théorème!projection!partie fermée convexe}
    \label{ThoProjOrthuzcYkz}
    Soit \( \hH\) un espace de Hilbert, et \( C\) un sous ensemble fermé convexe de \( \hH\). Pour chaque \( x\in \hH\), il existe un unique \( y\in C\) tel que
    \begin{enumerate}
        \item
            \( \| x-y \|=\inf\{ \| x-z \|\tq z\in C \}\),
        \item
            pour tout \( z\in C\), \( \langle x-y, z\rangle =0\).
    \end{enumerate}
\end{theorem}

\begin{proof}
    Nous nommons \( d\) l'infimum en question. 
    \begin{description}
        \item[Existence] 
    Soit \( (y_n)\) une suite dans \( C\) telle que 
    \begin{equation}
        \lim_{n\to \infty} \| x-y_n \|=\inf\{ \| x-y \|\tq z\in C \}=d.
    \end{equation}
    Nous allons montrer que cette suite peut être choisie de Cauchy. Elle convergera donc dans \( \hH\) parce que ce dernier est complet. Mais \( C\) étant supposé fermé dans \( \hH\), la limite appartiendra à \( C\). Soient \( r,s\in \eN\). D'abord nous avons
    \begin{subequations}
        \begin{align}
            \| y_r-y_r \|^2&=\langle y_r-y_s+x-x, y_r-y_s+x-x\rangle \\
            &=\| y_r-x \|^2+\| y_s-x \|^2-2\langle y_r-x, y_s-x\rangle .
        \end{align}
    \end{subequations}
    Ensuite,
    \begin{subequations}
        \begin{align}
            4\left\| \frac{ y_r+y_s }{2}-x \right\|^2&=\langle y_r+y_s-2x, y_r-y_s-2x\rangle \\
            &=\| y_r-x \|^2+\| y_s-x \|^2+2\langle y_r-x, y_s-x\rangle .
        \end{align}
    \end{subequations}
    Si nous égalisons les valeurs de \( 2\langle y_r-x, y_s-x\rangle \) nous trouvons
    \begin{equation}    \label{EqiqCyUa}
        \| y_r-y_s \|^2=-4\left\| \frac{ y_r+y_s }{2}-x \right\|^2+2\| y_r-x \|^2+2\| y_s-x \|^2.
    \end{equation}
    La distance infimum étant \( d\), nous pouvons choisir \( y_n\) de telle façon à avoir 
    \begin{equation}
        \| y_n-x \|\leq d+\frac{1}{ n }.
    \end{equation}
    D'autre part étant donné que \( C\) est convexe, \( (y_r+y_s)/2\) est dans \( C\) et nous avons
    \begin{equation}
        \left\| \frac{ y_r+y_s }{2}-x \right\| \leq d.
    \end{equation}
    En mettant ces majorations dans \eqref{EqiqCyUa} nous trouvons
    \begin{equation}
        \| y_r-y_s \|^2\leq -4d+2\left( d+\frac{1}{ r } \right)+2\left( d+\frac{1}{ s } \right)=\frac{1}{ r }+\frac{1}{ s }.
    \end{equation}
    La suite \( (y_n)\) est donc de Cauchy et la limite est un élément de \( C\). Prouvons que cet élément \( y\) réalise l'infimum. Pour cela nous avons les inégalités
    \begin{equation}
        d\leq \| x-y \|\leq\| x-y_n \|+\| y_n-y \|.
    \end{equation}
    En prenant le limite \( n\to\infty\) nous trouvons
    \begin{equation}
        d\leq \| x-y \|\leq d.
    \end{equation}
    
        \item[Unicité]
            Si \( y_1\) et \( y_2\) sont deux éléments de \( C\) qui minimisent la distance avec \( x\), nous avons
            \begin{equation}
                \| y_1-y_2 \|^2=-4\left\| \frac{ y_1+y_2j-x }{2} \right\|^2+2\| y_1-x \|^2+2\| y_2-x \|^2\leq -4d+2d+2d=0.
            \end{equation}
            Par conséquent \( y_1=y_2\).

    \end{description}
\end{proof}

\begin{lemma}       \label{LemGheBQz}
    Soit \( C\) une partie convexe et fermée de l'espace de Hilbert \( \hH\). Soit \( x\in \hH\). Un élément \( y\in C\) minimise la distance avec \( x\) si et seulement si
    \begin{equation}        \label{EqQCKubx}
        \Reel\langle x-y,z-y, \rangle \leq 0
    \end{equation}
    pour tout \( z\in C\).
\end{lemma}

\begin{proof}
    Considérons d'abord \( y=\pr_C(x)\). Par convexité de \( C\), si \( z\in C\) nous avons \( (1-t)y+tz\in C\) et par conséquent
    \begin{equation}
        \| x-(1-t)y-tz \|^2\geq \| x-y \|^2.
    \end{equation}
    Si nous développons complètement les deux membres de cette expression en utilisant la formule \eqref{EqrbBlkK} nous tombons sur
    \begin{equation}
        (-2t+t^2)\| y \|^2+2t\Reel\langle x, y\rangle +t^2\| y \|^2-2t\Reel\langle x, z\rangle +2t(1-t)\Reel\langle y, z\rangle \geq 0.
    \end{equation}
    En divisant par \( t\) et en faisant \( t\to 0\) nous trouvons le résultat \( \Reel\langle z-y, x-y\rangle \leq 0\).

    Réciproquement si \( y\) vérifie la relation \eqref{EqQCKubx} alors nous avons pour chaque \( z\in C\) 
    \begin{subequations}
        \begin{align}
            \| x-y \|^2&=\| (x-y)+(y-z) \|^2\\
            &=\| x-y \|^2+\| y-z \|^2+2\Reel\langle x-y,y-z \rangle \\
            \geq&\| x-y \|^2.
        \end{align}
    \end{subequations}
\end{proof}

\begin{proposition}     \label{PropAXJpCe}
    Soit \( C\) une partie convexe et fermée de l'espace de Hilbert \( \hH\). Alors pour tout \( x_1,x_2\in\hH\) nous avons
    \begin{equation}
        \| \pr_C(x_1)-\pr_C(x_2) \|\leq \| x_1-x_2 \|.
    \end{equation}
    En particulier la projection est une application continue.
\end{proposition}

\begin{proof}
    Nous posons \( y_1=\pr_C(x_1)\) et \( y_2=\pr_C(x_2)\). Par le lemme \ref{LemGheBQz} nous avons, pour tout \( z,z'\in C\) les inégalités
    \begin{subequations}
        \begin{align}
            \Reel\langle x_1-y_1, z-y_1\rangle \leq 0\\
            \Reel\langle x_2-y_2, z'-y_2\rangle \leq 0.
        \end{align}
    \end{subequations}
    En prenant \( z=y_2\) et \( z'=y_1\) et en sommant nous trouvons
    \begin{equation}
        \Reel\langle (x_1-y_1)+(y_2-x_2), y_2-y_1\rangle \leq 0.
    \end{equation}
    Nous pouvons maintenant calculer
    \begin{equation}
        \begin{aligned}[]
            \| y_1-y_2 \|^2&=\Reel\| y_1-y_2 \|\\
            &=\Reel\langle y_1-y_2, (y_1-x_1)+x_1-x_2+(x_2-y_2)\rangle \\
            &=\Reel\langle y_1-y_2, x_1-x_2\rangle +\Reel\langle y_2-y_1, (x_1-y_1)+(y_2-x_2)\rangle \\
            &\leq\langle y_1-y_2, x_1-x_2\rangle \\
            &\leq\big\| \langle y_1-y_2, x_1-x_2\rangle  \big\|\\
            &=\leq \| y_1-y_2 \|\| x_1-x_2 \|.
        \end{aligned}
    \end{equation}
    En simplifiant par \( \| y_1-y_2 \|\)\footnote{Si c'est nul, alors la preuve est évidente.} nous trouvons le résultat
    \begin{equation}
        \| y_1-y_2 \|\leq \| x_1-x_2 \|.
    \end{equation}
\end{proof}

\begin{theorem}[Projection orthogonale]\index{projection!orthogonale}   \index{théorème!projection!cas vectoriel}   \label{ThoMXwOjb}
    Soit \( \hH\) un espace de Hilbert et \( K\), un sous-espace vectoriel fermé non réduit à \( \{ 0 \}\) et \( x\in\hH\). L'élément \( \pr_K(x)\) est l'unique élément de \( K\) tel que
    \begin{equation}
        x-y\in K^{\perp}.
    \end{equation}
    De plus l'application \( x\mapsto\pr_K(x)\) est linéaire, continue et de norme \( 1\).
\end{theorem}

    L'élément \( y\) ainsi définit est la \defe{projection orthogonale}{projection!orthogonale} de \( x\) sur \( K\) et sera noté \( \pr_K(f)\).\nomenclature[Y]{\( \pr_K(x)\)}{projection orthogonale de \( x\) sur \( y\)}

\begin{proof}

    La continuité de la projection est donné par la proposition \ref{PropAXJpCe}.

            Soit \( z\) un élément de \( K\) tel que \( \langle z-x, a\rangle =0\) pour tout \( a\in K\). Nous avons
            \begin{subequations}
                \begin{align}
                    \| x-a \|^2&=\| z-x \|^2+\| a-z \|^2+2\underbrace{\langle z-x, a-z\rangle}_{=0}\\
                    &\geq \| z-x \|^2.
                \end{align}
            \end{subequations}
            Le produit scalaire est nul parce que \( a-z\in K\). La distance \( \| z-x \|\) est donc bien la plus petite distance entre \( x\) et les éléments de \( K\).

            Dans l'autre sens, nous supposons que \( y\in K\) minimise la distance à \( x\) dans \( K\). Par hypothèse pour tout \( a\) et pour tout \( \lambda\in \eR\), la différence
            \begin{equation}
                \| (y+\lambda a)-x \|^2-\| y-x \|^2
            \end{equation}
            est positive. En développant les produits scalaires nous trouvons la conditions suivante
            \begin{equation}
                \lambda^2\| a \|^2+2\lambda\langle a, y-x\rangle \geq 0
            \end{equation}
            qui doit être vraie pour tout \( \lambda\in\eR\). En tant que polynôme du second degré en \( \lambda\), cela n'aura pas deux racines réelles distinctes uniquement si \( \langle a, y-x\rangle =0\).
    
            Nous montrons maintenant la linéarité de la projection orthogonale. Soient \( x_1,x_2\in\hH\). L'élément \( y=\pr_Kx_1+\pr_Kx_2\) satisfait à la condition d'orthogonalité : pour tout \( z\in K\),
    \begin{equation}
        \langle x_1+x_2-\pr_Kx_1-\pr_Kx_2, z\rangle =\langle x_1-\pr_Kx_1, z\rangle +\langle x_2-\pr_Kx_2, z\rangle =0.
    \end{equation}
    Étant donné que \( K\) est un sous-espace vectoriel, la condition de minimalité est automatiquement vérifiée (seconde partie du théorème \ref{ThoProjOrthuzcYkz}).

    En ce qui concerne la norme opérateur de \( \pr_K\), la décomposition de \( x\in\hH\) en composantes dans \( K\) et \( K^{\perp}\) est
    \begin{equation}
        x=x+(x-\pr_Kx).
    \end{equation}
    Étant deux parties orthogonales nous avons
    \begin{equation}
        \| \pr_Kx \|^2=\| x \|^2-\| x-\pr_Kx \|^2.
    \end{equation}
    En prenant \( \| x \|=1\) nous trouvons \( \| \pr_Kx \|^2\leq 1\) et par conséquent \( \| \pr_K \|\leq 1\). Mais d'autre part en prenant \( x\in K\) nous avons automatiquement \( \| \pr_K \|\geq 1\).
\end{proof}

\begin{proposition}
    Soit \( \hH=L^2(\Omega,\tribA,\mu)\), \( \tribF\) une sous tribu de \( \tribA\) et \( K\) l'ensemble de fonctions \( \tribF\)-mesurables dans \( L^2(\Omega,\tribA,\mu)\). Si \( f\in L^2(\Omega,\tribA,\mu)\) est positive, alors \( \pr_Kf\) est positive (presque partout).
\end{proposition}

\begin{proof}
    L'ensemble \( A=\{ \pr_Kf<0 \}\) est dans \( \tribF\). En effet 
    \begin{equation}
        A=(\pr_Kf)^{-1}\big( \mathopen] -\infty , 0 \mathclose[\big)
    \end{equation}
    alors que, par construction, \( \pr_Kf\) est \( \tribF\)-mesurable. La conséquent la fonction indicatrice \( \mtu_A\) est \( \tribF\)-mesurable (c'est à dire \( 1_A\in K\)) et nous avons
    \begin{equation}
        0\leq\int_{\Omega}f\mtu_A=\int_{\Omega}\pr_Kf\mtu_A\leq 0.
    \end{equation}
    Étant donné que nous avons supposé \( f\geq 0\) nous avons alors \( \mu(A)=0\). D'où le fait que \( \pr_Kf\) est presque partout positive.
\end{proof}


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Systèmes orthogonaux et bases}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Sources : \cite{HilbertLi}. Dans cette partie nous noterons \( \eK\) le corps de base de l'espace \( \hH\). Seuls deux cas sont envisagés : \( \eK=\eC\) ou \( \eK=\eR\).

Pour chaque \( x\in\hH\) nous considérons l'application
\begin{equation}
    \begin{aligned}
        \Phi_x\colon \hH&\to \eK \\
        y&\mapsto \langle x, y\rangle . 
    \end{aligned}
\end{equation}

\begin{lemma}       \label{LemjYVcHE}
    L'application \( y\mapsto\Phi_y\) est une isométrie : nous avons \( \| \Phi_y \|=\| y \|\). De plus pour chaque \( y\), l'application \( \Phi_y\) est continue.
\end{lemma}

\begin{proof}
    En utilisant la définition de la norme opérateur et l'inégalité de Cauchy-Schwarz,
    \begin{equation}
        \| \Phi_y \|=\sup_{\| x \| =1}\| \Phi_y(x) \|=\sup| \langle x, y\rangle  |\leq\sup\| x \|\| y \|=\| y \|.
    \end{equation}
    Par conséquent \( \| \Phi_y \|\leq\| y \|\). Mais d'autre part le fait que \( \Phi_y(y)=\| y \|^2\) montre que \( \| \Phi_y \|\geq \| y \|\).

    En ce qui concerne la continuité de \( \Phi_y\), elle est garantie par le fait que c'est une application linéaire bornée via la proposition \ref{PropmEJjLE}.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Orthogonalité}
%---------------------------------------------------------------------------------------------------------------------------

Si \( A\) est une partie de \( \hH\) alors nous notons\nomenclature[Y]{\( A^{\perp}\)}{orthogonal d'une partie}
\begin{equation}
    A^{\perp}=\{ y\in\hH\tq y\perp c\forall x\in A \}.
\end{equation}
cet ensemble est l'\defe{orthogonal}{orthogonal} de \( A\).

\begin{proposition}     \label{PropdpaMpH}
    Si \( \hH\) est une préhilbert et si \( A\subset \hH\), alors l'ensemble \( A^{\perp}\) est un sous-espace fermé de \( \hH\).
\end{proposition}

\begin{proof}
    Par définition l'application \( \Phi_x\) est continue pour chaque \( x\in\hH\) et par conséquent l'ensemble \( \ker\Phi_x=\Phi_x^{-1}(\{ 0 \})\) est fermé. L'ensemble
    \begin{equation}
        A^{\perp}=\bigcap_{x\in A}\ker\Phi_x
    \end{equation}
    est donc fermé.    
\end{proof}

\begin{proposition}[\wikipedia{fr}{Supplémentaire_topologique}{wikipédia}]     \label{PropKZDqTR}
    Soit \( V\) un espace vectoriel normé et une décomposition en somme directe \( V=F\oplus G\). Alors les trois conditions suivantes sont équivalentes.
    \begin{enumerate}
        \item
            L'isomorphisme naturel \( F\times G\to v\) est un homéomorphisme.
        \item
            \( F\) et \( G\) sont fermés et la restriction à \( G\) de la projection \( V\to V/F\) est un homéomorphisme.
        \item
            \( F\) et \( G\) sont fermés et la projection de \( E\) sur \( F\) est continue.
    \end{enumerate}
\end{proposition}
Lorsqu'une décomposition en somme directe vérifie la proposition \ref{PropKZDqTR}, nous disons que la décomposition est \defe{topologique}{topologique!somme directe}.

\begin{theorem}     \label{ThowZyaiz}
    Soit \( \hH\) un espace de Hilbert et \( F\) un sous-espace fermé de \( \hH\). Alors
    \begin{enumerate}
        \item
            Nous avons la décomposition
            \begin{equation}        \label{EqxXIvrG}
                \hH=F\oplus F^{\perp}.
            \end{equation}
        \item       \label{ItemThowZyaizii}
            La projection sur \( F\) par rapport à la somme directe \eqref{EqxXIvrG} est la projection \( \pr_F\) du théorème de projection.
        \item
            La décomposition \eqref{EqxXIvrG} est topologique.
    \end{enumerate}
\end{theorem}

\begin{proposition}
    Si \( F\) est un sous-espace de l'espace de Hilbert \( \hH\) alors on a \( F^{\perp\perp}=\bar F\).
\end{proposition}

\begin{proof}
    Nous savons par la proposition \ref{PropdpaMpH} que \( F^{\perp}\) est fermé, par conséquent le théorème \ref{ThowZyaiz} donne la somme directe
    \begin{equation}
        \hH=F^{\perp}\oplus F^{\perp\perp}.
    \end{equation}
    Mais \( \bar F\) étant également fermé nous avons la somme directe
    \begin{equation}
        \hH=\bar F\oplus(\bar F)^{\perp}.
    \end{equation}
    Montrons que \( (\bar F)^{\perp}=F^{\perp}\). En effet si \( x\in F^{\perp}\) et si \( y\in \bar F\), alors il existe une suite \( y_n\) dans \( F\) qui converge vers \( y\). Pour chaque \( n\) nous avons \( \langle x, y_n\rangle =0\) et dons \( \langle x, y\rangle =0\) par continuité du produit scalaire.

    Nous avons donc
    \begin{equation}
        \hH=F^{\perp}\oplus F^{\perp\perp}=\bar F\oplus F^{\perp}.
    \end{equation}
    Mais \( \bar F\subset F^{\perp\perp}\) (prendre une suite). Les espaces \( \bar F\) et \( F^{\perp\perp}\) étant tous deux des supplémentaires de \( F^{\perp}\), nous déduisons qu'ils doivent être égaux.
\end{proof}

\begin{proposition}     \label{PropqiWonByiBmc}
    Soit \( \hH\) un espace de Hilbert et \( F\) un sous-espace vectoriel de \( \hH\). Alors \( F\) est dense si et seulement si \( F^{\perp}=\{ 0 \}\).
\end{proposition}

\begin{proof}
    Nous savons que
    \begin{equation}
        \hH=F^{\perp}\oplus \bar F.
    \end{equation}
    Donc nous avons \( H=\bar F\) si et seulement si \( F^{\perp}=\{ 0 \}\).
\end{proof}
Pour vérifier si un sous-espace vectoriel d'un espace de Hilbert est dense, il suffit donc de montrer que son orthogonal est réduit à zéro.

\begin{lemma}[Théorème fondamental d'approximation \cite{TribuLi}]      \label{LempTBaUw}
    Soit \( \Omega\) un espace mesurable et \( f\colon \Omega\to \mathopen[ 0 , \infty \mathclose]\) une application mesurable. Alors il existe une suite croissante d'applications étagées \( \varphi_n\colon \Omega\to \eR^+\) dont la limite est \( f\).

    De plus si \( f\) est bornée, la convergence est uniforme.
\end{lemma}

\begin{theorem}[\cite{HilbertLi}]       \label{ThoJsBKir}
    Soit \( I\) un intervalle de \( \eR\). L'espace \( C_c(I)\)\nomenclature[Y]{\( C_c(I)\)}{fonctions continues à support compact dans \( I\)} des fonctions continues à support compact sur \( I\) est dense dans \( L^2(I)\).
\end{theorem}

\begin{proof}
    Soit \( g\in L^2(I)\) une fonction telle que \( g\perp f\) pour toute fonction \( f\in C_c(I)\). Nous avons donc
    \begin{equation}
        \langle f, g\rangle =\int_If\bar g=0.
    \end{equation}
    En passant éventuellement aux composantes réelles et imaginaires nous pouvons supposer que les fonctions sont toutes réelles. Nous décomposons \( g\) en parties positives et négatives : \( g=g^+-g^-\). Notre but est de montrer que \( g^+=g^-\), c'est à dire que \( g\) est nulle. La proposition \ref{PropqiWonByiBmc} conclura que \( C_c(I)\) est dense dans \( L^2(I)\).

    Soit un intervalle \( \mathopen[ a , b \mathclose]\subset I\) et une suite croissante de fonctions \( f_n\in C_c(I)\) convergent vers \( \mtu_{\mathopen[ a , b \mathclose]}\). Par hypothèse pour chaque \( n\) nous avons
    \begin{equation}
        \int_If_ng^+=\int_I f_ng^-.
    \end{equation}
    La suite étant croissante, le théorème de la convergence monotone (théorème \ref{ThoConvMonFtBoVh}) s'applique et nous avons
    \begin{equation}
        \lim_{n\to \infty} \int_I f_ng^+=\int_a^bg^+,
    \end{equation}
    de telle sorte que nous ayons, pour tout intervalle \( \mathopen[ a , b \mathclose]\subset I\) l'égalité
    \begin{equation}        \label{EqYlErAM}
        \int_a^bg^+=\int_a^bg^-.
    \end{equation}
    De plus ces intégrales sont finies parce que
    \begin{equation}
        \int_a^b g^+\leq\int_a^b| g |=\int_I| g |\mtu_{\mathopen[ a , b \mathclose]}=\langle | g |, \mtu_{\mathopen[ a , b \mathclose]}\rangle \leq \| g \|_{L^2}\sqrt{b-a}<\infty
    \end{equation}
    par l'inégalité de Cauchy-Schwarz.

    Soit maintenant un ensemble mesurable \( A\subset I\). La fonction caractéristique \( \mtu_A\) est mesurable et il existe une suite croissante de fonctions étagées \( (\varphi_n)\) convergente vers \( a\) par le lemme \ref{LempTBaUw}. À multiples près, les fonctions \( \varphi_n\) sont des sommes de fonctions caractéristiques du type \( \mtu_{\mathopen[ a , b \mathclose]}\), par conséquent, en vertu de \eqref{EqYlErAM} nous avons
    \begin{equation}
        \int_I\varphi_ng^+=\int_I\varphi_ng^-.
    \end{equation}
    Une fois de plus nous pouvons utiliser le théorème de la convergence monotone et obtenir
    \begin{equation}
        \int_Ag^+=\int_A g^-
    \end{equation}
    pour tout ensemble mesurable \( A\subset I\). Si nous notons \( dx\) la mesure de Lebesgue, les mesures \( g^+dx\) et \( g^-dx\) sont par conséquent égales et dominées par \( dx\). Par le corollaire \ref{CorZDkhwS} du théorème de Radon Nikodym, les fonctions \( g^+\) et \( g^-\) sont égales.
\end{proof}
 
%---------------------------------------------------------------------------------------------------------------------------
\subsection{Dual}
%---------------------------------------------------------------------------------------------------------------------------

Le \defe{dual}{dual} de l'espace de Hilbert \( \hH\) est l'ensemble\nomenclature[Y]{\( \hH^*\)}{dual}
\begin{equation}
    H^*=\{ \Phi\colon \hH\to \eK\text{ linéaire et continue} \}.
\end{equation}
Notons que dans le contexte des espaces linéaires nous demandons la continuité des éléments du dual parce qu'elle n'est pas automatique par la linéarité dans les cas de dimensions infinies.

\begin{theorem}[Fréchet-Riesz]\index{théorème!Fréchet-Riesz}        \label{ThoQgTovL}
    L'application
    \begin{equation}
        \begin{aligned}
            J\colon \hH&\to \hH^* \\
            y&\mapsto \Phi_y 
        \end{aligned}
    \end{equation}
    est une bijection isométrique.
\end{theorem}

\begin{proof}
    Nous savons du lemme \ref{LemjYVcHE} que \(J\) est une isométrique. Nous devons seulement montrer que \( J\) est surjective. Soit \( \Phi\in \hH^*\). Par continuité nous savons que \( F=\ker\Phi\) est fermé, donc
    \begin{equation}
        \hH=\ker\Phi\oplus(\ker\Phi)^{\perp}
    \end{equation}
    par le théorème \ref{ThowZyaiz}. Nous considérons une base de \( H\) adaptée à cette décomposition, c'est à dire
    \begin{itemize}
        \item \( (u_s)_{s\in S}\) une base de \( \ker\Phi\),
        \item
            \( (v_t)_{t\in T}\) une base de \( (\ker\Phi)^{\perp}\).
    \end{itemize}
    Il se fait que \( T\) se réduit à un seul élément parce que si \( v\in (\ker\Phi)^{\perp}\), alors \( \Phi(v)\neq 0\), et par conséquent \( \{ \Phi(v) \}\) est déjà une base de \( \Image\Phi=\eK\). Le théorème du rang (théorème \ref{ThoGkkffA}) assure alors que
    \begin{equation}
        \{ v \}\cup\{ u_s \}_{s\in S}
    \end{equation}
    est une base de \( \hH\) avec \( v\in(\ker\Phi)^{\perp}\) et \( u_s\in \ker\Phi\). Nous choisissons \( v\) pour avoir \( \| v \|=1\).

    Nous pouvons maintenant prouver l'existence de \( y\) tel que \( \Phi_y=\Phi\). En effet si nous posons \( y=\overline{ \Phi(v) }v\) nous avons \( \Phi_y=\Phi\), en effet
    \begin{subequations}
        \begin{align}
            \Phi_y(v)=\langle v, y\rangle =\Phi(v)\langle v, v\rangle =\Phi(v)\\
            \Phi_y(u_s)=\langle u_s, y\rangle =0.
        \end{align}
    \end{subequations}
    Par conséquent \( \Phi_y\) et \( \Phi\) coïncident sur une base de \( \hH\).

    En ce qui concerne l'unicité, d'abord si \( \Phi_y=\Phi\) alors nous devons avoir \( y\in(\ker\Phi)^{\perp}\) et par conséquent \( y=\lambda v\) pour un certain \( \lambda\in \eK\). Nous avons alors
    \begin{equation}
        \Phi_y(v)=\bar\lambda\langle v, v\rangle =\bar\lambda.
    \end{equation}
    Pour que cela soit égal à \( \Phi(v)\), nous fixons \( \lambda=\overline{ \Phi(v) }\).
    
\end{proof}
Notons que nous avons réellement utilisé le théorème du rang pour l'unicité. Si nous ne demandions pas l'unicité, alors nous n'avions pas besoin du fait que \( \dim(\ker\Phi)^{\perp}=1\), et nous aurons donc pu parler de formes plus générales à valeurs dans \( \eK^n\).

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Séparabilité}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
    Un espace topologique est \defe{séparable}{séparable} si il possède une partie dénombrable dense.

    Si \( E\) est un espace vectoriel normé nous disons que \( \Delta\) est une partie \defe{totale}{totale}\index{partie!totale} de \( E\) si \( \Span\Delta\) est dense dans \( E\).
\end{definition}

\begin{proposition}
    Un espace vectoriel normé est séparable si et seulement si il possède une partie totale dénombrable.
\end{proposition}

\begin{proof}
    Si \( \Delta\) est une partie dénombrable de \( E\), alors le \( \eQ\)-espace vectoriel \( \Span_{\eQ}\Delta\) est dénombrable, et sa fermeture est la même que celle de \( \Span_{\eK}\Delta\).
\end{proof}

\begin{definition}
    Une famille \( (u_i)_{i\in I}\) d'éléments de \( \hH\) indicée par un ensemble quelconque \( I\) est un \defe{système orthonormé}{orthonormé!système}\index{système orthonormé} si
    \begin{enumerate}
        \item
            \( \| u_i \|=1\) pour tout \( i\in I\),
        \item
            \( u_i\perp u_j\) pour tout \( i\neq j\).
    \end{enumerate}
\end{definition}
Notons que si \( (u_n)_{n\in \eN}\) est un système orthonormé dénombrable alors en utilisant les formules de la proposition \ref{PropTdupIG}, nous avons
\begin{equation}    \label{EqCLQbMy}
    \big\| \sum_{k=1}^n\xi_ku_k \big\|^2=\sum_{k=1}^n| \xi_k |^2.
\end{equation}

% TODO : cohérence. Je devrais poser e_n(t)=exp(int), puis aussi faire attention aux conventions pour les intervalles non 2pi.
% Ceci est à vérifier un peu partout où on parle de série de Fourier.
\begin{example}
    Dans l'ensemble \( L^2(a,b)\) avec \( b-a=L\) l'ensemble des fonctions
    \begin{equation}        \label{EqxNXguH}
        e_n(t)=\frac{1}{ \sqrt{b-a} }\exp(\frac{ 2\pi }{ L }int)
    \end{equation}
    avec \( n\in \eZ\) forme un système orthonormé. En effet
    \begin{equation}
        \langle e_n, e_n\rangle =\frac{1}{ b-a }\int_a^b\exp(\frac{ 2\pi }{ L }int)\exp(-\frac{ 2\pi }{ L }int)=1
    \end{equation}
    et
    \begin{equation}
        \langle e_n, e_m\rangle =\frac{1}{ b-a }\int_a^b e^{\frac{ 2\pi }{ L }(n-m)t}dt=0.
    \end{equation}
    Dans cette intégrale nous utilisons le fait que \( b=a+(b-a)\) pour simplifier les expressions en cours de calcul.

    La famille \eqref{EqxNXguH} est le \defe{système trigonométrique}{système!trigonométrique} de \( L^2(a,b)\). On en parle aussi dans \cite{KuttlerTopInAl}.
\end{example}

\begin{proposition}
    Un système orthonormé est libre.
\end{proposition}

\begin{proof}
    Soit \( (u_i)_{i\in I}\) un système orthonormé de \( \hH\) et une combinaison linéaire \emph{finie} nulle :
    \begin{equation}
        \sum_{k=1}^{n}a_ku_k=0.
    \end{equation}
    Nous développons la somme en utilisant les formules de la proposition \ref{PropTdupIG} :
    \begin{equation}
        0=\| \sum_ka_ku_k \|^2=\sum_k| a_k |^2\| u_k \|^2+2\sum_{k<l}\langle a_ku_k, a_lu_l\rangle .
    \end{equation}
    Le système étant orthonormé, les choses se simplifient en
    \begin{equation}
        \sum_k| a_k |^2=0,
    \end{equation}
    ce qui signifie que \( a_k=0\) pour tout \( k\).
\end{proof}

Avant de continuer nous devons définir comment nous calculons des sommes sur des ensembles quelconques. Si \( I\) est un ensemble et si pour chaque \( i\in I\) nous avons un nombre réel positif \( a_i\), alors nous définissons
\begin{equation}
    \sum_{i\in I}a_i=\sup_{\substack{J\subset I\\\text{ \( J\) fini }}}\sum_{j\in J} a_j.
\end{equation}

\begin{proposition}[Inégalités de Bessel]\index{Bessel!inégalités}\index{inégalités!Bessel} \label{PropHKqVHj}
    Soit \( \hH\) un préhilbert. Si \( (u_i)_{i\in I}\) est un système orthonormé et si \( x\in \hH\), alors
    \begin{equation}
        \sum_{i\in I}\big| \langle x, u_i\rangle  \big|^2\leq \| x \|^2.
    \end{equation}
\end{proposition}

\begin{proof}
    Les éléments de la somme étant des réels positifs, la notion de somme à utiliser est celle de la définition \ref{DefHYgkkA}.

    Posons \( c_i(x)=\langle x, u_i\rangle \). Pour toute partie finie \( J\subset I\) nous avons
    \begin{equation}
        0\leq \big\| x-\sum_{j\in J}c_j(x)u_j \big\|^2=\| x \|^2-2\Reel\sum_{j}\langle x, c_j(x)u_j\rangle +\sum_j| c_j(x) |^2.
    \end{equation}
    Mais en tenant compte du fait que 
    \begin{equation}
        \langle x, c_j(x)u_j\rangle =\overline{  c_j(x)}\langle x, u_j\rangle =| c_j(x) |^2,
    \end{equation}
    nous restons avec
    \begin{equation}    \label{EqvwXWEA}
        \| x-\sum_{j\in J}c_j(x)u_j \|=\| x \|^2-\sum_{j\in J}| c_j(x) |^2.
    \end{equation}
    Finalement,
    \begin{equation}
        \sum_{j\in J}| c_j(x) |^2\leq \| x \|^2.
    \end{equation}
    Ayant cette inégalité pour toute partie finie de \( I\), nous l'avons encore pour le supremum.
\end{proof}

\begin{remark}  \label{RemfdJcQF}
    À mon avis il doit exister un théorème de complétion de base hilbertienne disant que si on a une famille orthonormée, alors elle se prolonge en base. Utilisant cela, nous trouvons une nouvelle démonstration de la proposition \ref{PropHKqVHj} en disant que la somme sur la «partie de base» est plus petite que la somme sur la «base complète».
\end{remark}

%TODO : trouver un tel théorème.

Dans la suite les systèmes orthonormés dénombrables vont jouer un rôle important. Nous allons conventionnellement les indicer par \( \eN\).
\begin{proposition}
    Soit \( \hH\) un préhilbert et un système orthonormé dénombrable \( (u_n)_{n\in \eN}\). Si 
    \begin{equation}        \label{EqitrzXi}
        x=\sum_{n=1}^{\infty}\xi_nu_n,
    \end{equation}
    alors \( \xi_n=\langle x, u_n\rangle \).
\end{proposition}

\begin{proof}
    Nous appliquons \( \Phi_{u_k}\) à l'équation \eqref{EqitrzXi}. Étant donné que le produit scalaire est continu, nous pouvons permuter avec la somme infinie et obtenir
    \begin{equation}
        \langle x, u_k\rangle =\sum_{n=0}^{\infty}\langle u_n, u_k\rangle =\xi_k.
    \end{equation}
\end{proof}

La proposition suivante explique que la notion de projection est compatible avec la décomposition d'un vecteur dans un système orthonormé.
\begin{proposition}
    Soit \( (u_k)_{k\geq 1}\) un système orthonormé d'un préhilbert \( \hH\). Soient 
    \begin{equation}
        x=\sum_{k=1}^{\infty}\xi_ku_k
    \end{equation}
    et
    \begin{equation}
        F=\Span\{ u_1,\ldots, u_n \}.
    \end{equation}
    Alors 
    \begin{equation}
        \pr_F(x)=\sum_{k=1}^n\xi_ku_k.
    \end{equation}
\end{proposition}

\begin{proof}
    Nous allons dans un premier temps montrer que 
    \begin{equation}
        y=x-\sum_{k=1}^n\xi_ku_k
    \end{equation}
    est dans \( F^{\perp}\). Pour cela nous calculons
    \begin{equation}
        \langle x-\sum_{k=1}^n\xi_ku_k,u_j, \rangle =\langle \sum_{k=n+1}^{\infty}\xi_ku_k, u_j\rangle =0
    \end{equation}
    où nous avons utilisé la continuité du produit scalaire pour permuter la somme (infinie) et le produit. Étant donné que \( y\in F^{\perp}\) nous avons \( \pr_Fy=0\) par le point \ref{ItemThowZyaizii} du théorème \ref{ThowZyaiz}.

    D'autre part \( \pr_Fy\) peut être calculé selon
    \begin{equation}
        \pr_Fy=\pr_Fx-\sum_{k=1}^n\xi_k\pr_Fu_k
    \end{equation}
    tandis que \( \pr_Fu_k=u_k\) lorsque \( 1\leq k\leq n\). Par conséquent l'annulation de \( \pr_Fy\) donne
    \begin{equation}
        \pr_Fx=\sum_{k=1}^n\xi_ku_k,
    \end{equation}
    donc le résultat.
\end{proof}

\begin{theorem}[Meillere approximation] \label{ThooRArDp}
    Soit \( \{ u_i \}_{i\in I}\) une famille orthonormé de l'espace de Hilbert \( \hH\). Alors pour tout \( x\in \hH\) et pour tout \( J\) fini dans \( I\) et pour toute famille de nombres complexes  \( (a_j)_{j\in J}\) nous avons
    \begin{equation}
        \| \sum_{j\in J}\langle x, u_j\rangle u_j-x \|\leq \| \sum_{j\in J}a_ju_j-x \|.
    \end{equation}
\end{theorem}
Ce théorème exprime le fait que les nombres \( \langle x, u_i\rangle \) sont les meilleurs coefficients à mettre devant les \( u_i\) pour approximer \( x\).

\begin{corollary}
    Soit \( \{ u_i \}_{i\in I}\) une famille orthonormé de \( \hH\). Pour tout \( x\in \hH\) et pour toutes parties finies \( J,K\) de \( I\) avec \( J\subset K\) nous avons
    \begin{equation}
        \| \sum_{j\in K}\langle x, u_j\rangle u_j-x \|\leq \| \sum_{j\in J}\langle x, u_j\rangle u_j-x \|.
    \end{equation}
\end{corollary}
Ce corollaire exprime le fait que plus on prend de termes de la forme \( \langle , u_i\rangle u_i\), mieux c'est.

\begin{proposition}     \label{PropzaKXHq}
    Soit \( \hH\) un espace de Hilbert et \( (u_n)\) un système orthonormé dans \( \hH\). Si \( (\xi_n)_{n\in \eN}\) est une suite dans \( \ell^2\) alors la série 
    \begin{equation}
        \sum_{n=1}^{\infty}\xi_nu_n
    \end{equation}
    converge dans \( \hH\).

    Autrement dit l'application
    \begin{equation}
        \begin{aligned}
            S\colon \hH&\to \ell^2 \\
            x&\mapsto \big( \langle x, u_n\rangle  \big)_{n\geq 1} 
        \end{aligned}
    \end{equation}
    est surjective.
\end{proposition}

\begin{proof}
    Nous allons montrer que la série \( \sum_{n=1}^{\infty}\xi_nu_n\) est de Cauchy, c'est à dire que la limite
    \begin{equation}
        \lim_{n\to \infty} \big\| \sum_{k=n}^{n+p}\xi_ku_k \big\|=0
    \end{equation}
    est uniforme en \( p\). Cela est un corollaire de la formule \eqref{EqCLQbMy} parce que
    \begin{equation}
        \big\| \sum_{k=n}^{n+p}\xi_ku_k \big\|^2=\sum_{k=n}^{n+p}| x_k |^2.
    \end{equation}
    Mais si \( (\xi_n)\) est dans \( \ell^2\), pour tout \( \epsilon\), il existe \( N\) tel que si \( n>N\) alors le membre de droite est inférieur à \( \epsilon\) indépendamment de \( p\).
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Bases d'espaces de Hilbert}
%---------------------------------------------------------------------------------------------------------------------------
\label{SubsecDxkjut}

\begin{definition}
    Une \defe{base orthonormée}{base!espace préhilbertien} est une famille dénombrable orthonormé et totale.
\end{definition}
Notons que cela n'est pas la même notion de base qu'en algèbre. En effet pour avoir une base algébrique d'un espace vectoriel, nous demandons que les éléments soient des combinaisons linéaires \emph{finies} des éléments de la base, tandis qu'ici en demandant que la partie soit totale nous demandons simplement que les combinaisons linéaires finies soient denses.

Nous allons voir qu'un espace de Hilbert est généré par les sommes \emph{infinies} de vecteurs d'une base orthonormé avec des coefficients qui forment une suite dans \( \ell^2\).

Étant donné une base hilbertienne de \( \hH\), nous notons
\begin{equation}
    c_k(x)=\langle x, u_k\rangle .
\end{equation}
Dans le théorème suivant (et d'ailleurs partout), les sommes sur \( I\) sont prises au sens de la définition \ref{DefIkoheE}.


\begin{theorem}[Décomposition dans une base orthogonale]     \label{ThoyAjoqP}
    Soit \( \hH\) un espace de Hilbert séparable \( \{ u_i \}_{i\in I}\) une base orthonormée (\( I\) est un ensemble dénombrable quelconque). 

    \begin{enumerate}
        \item
            Pour tout \( x\in \hH\) nous avons
            \begin{equation}        \label{EqPUPTXJ}
                x=\sum_{i\in I}\langle x, u_i\rangle u_i
            \end{equation}
            où la somme est prise au sens de la définition \ref{DefIkoheE}. En particulier, la somme converge de façon commutative.

        \item

            Si \( \{ e_i \}_{i\in I}\) est une famille orthonormée qui satisfait la décomposition \eqref{EqPUPTXJ} pour tout \( x\in \hH\) alors \( \{ e_i \}\) est une base hilbertienne.
        \item
            Nous avons l'identité de \defe{Plancherel}{Plancherel}
            \begin{equation}
                \| x \|^2=\sum_{i\in I}| \langle x, u_i\rangle  |^2.
            \end{equation}
            Le point \ref{ItemQGwoIx} nous indiquera que cette égalité est en fait suffisante pour dire que nous avons une base.
        \item
            Nous avons l'identité de \defe{Parseval}{Parseval}
            \begin{equation}
                \langle x, y\rangle =\sum_{i\in I}\langle x, u_i\rangle \overline{ \langle y, u_i\rangle  }.
            \end{equation}
        \item   \label{ItemQGwoIx}
            Si \( \{ e_i \}\) est une famille de vecteurs unitaires vérifiant l'identité de Plancherel, alors c'est une base hilbertienne.
        \item
            Si \( \{ u_i \}_{i\in I}\) est une base hilbertienne, la suite \( n\mapsto| \langle x, e_n\rangle  |\) appartient à \( \ell^2(I)\).
    \end{enumerate}
\end{theorem}

\begin{proof}
    \begin{enumerate}
        \item
            Étant donné que le système \( \{ u_i \}_{i\in I}\) est total, nous pouvons considérer une suite de combinaisons linéaires finies des \( u_i\) qui converge vers \( x\). Nous écrivons
            \begin{equation}
                x_n=\sum_{x\in J_n}a_{n,k}u_j
            \end{equation}
            et \( x_n\to x\) dans \( \hH\). Les ensembles \( J_n\) sont des sous-ensembles finis de \( I\). Nous pouvons les choisir de telle sorte que \( J_n\subset J_{n+1}\) et \( \bigcup_{n\in \eN}J_n=I\). Ce choix correspond à éventuellement prendre \( a_{n,j}=0\) pour toutes les valeurs de \( j\) «en trop».

            Soit \( \epsilon>0\) et \( N\) tel que \( \| x_n-x \|<\epsilon\) pour tout \( n\geq N\). Nous allons montrer que pour tout \( J\) fini tel que \( J_N\subset J\) nous avons \( \| \sum_{j\in J}\langle x, u_j\rangle u_j-x \|<\epsilon\). Étant donné que
            \begin{equation}
                \sum_{j\in J_N}\langle x, u_j\rangle u_j=\sum_{j\in J}a_ju_j
            \end{equation}
            avec
            \begin{equation}
                a_j=\begin{cases}
                    \langle x, u_j\rangle     &   \text{si \( j\in J_N\)}\\
                    0    &    \text{sinon},
                \end{cases}
            \end{equation}
            le théorème de meilleure approximation \ref{ThooRArDp} nous enseigne que
            \begin{equation}
                \| \sum_{j\in J}\langle x, u_j\rangle u_j-x \|\leq\| \sum_{j\in J_N}\langle x, u_j\rangle u_j-x \|<\epsilon
            \end{equation}
            par conséquent la somme \( \sum_{i\in I}\langle x, u_i\rangle u_i\) converge vers \( x\) au sens général, et en particulier commutativement.

    Les sommes étant commutatives (en particulier \( x=\sum_{i\in I}\langle x, u_i\rangle u_i\)), et les bases hilbertiennes étant dénombrables, nous ne perdons aucune généralité en ne considérant que des bases indexées par \( \eN\).

        \item
            Nous devons montrer que l'ensemble des combinaisons linéaires finies est dense dans \( \hH\). Par hypothèse, pour tout \( \epsilon\), il existe un ensemble fini \( J\) tel que
            \begin{equation}
                \| \sum_{j\in J}\langle x, u_j\rangle u_j-x \|<\epsilon.
            \end{equation}
            Cela prouve la densité dont nous avions besoin.
        \item
            La norme étant une fonction continue, elle commute avec les sommes infinies, de telle sorte que l'égalité de Plancherel donne
            \begin{equation}
                \| x \|^2=\| \sum_{i\in I}\langle x, u_i\rangle u_i \|^2.
            \end{equation}
            Le système des \( u_i\) étant orthonormé,
            \begin{equation}
                \| x \|^2=\| \sum_{i\in I}\langle x, u_i\rangle u_i \|^2=\sum_{i\in I}| \langle x, u_i\rangle  |^2.
            \end{equation}
        \item
            Au tour de \wikipedia{fr}{Perceval}{Parseval}. Nous commençons par prouver que la somme du membre de droite converge. En utilisant l'inégalité \( | zz' |\leq | z |^2+| z' |^2\) (valable pour \( z,z'\in \eC\)) et Plancherel, nous avons
            \begin{equation}
                \begin{aligned}[]
                    \sum_{i\in I}| \langle x, u_i\rangle \overline{ \langle y, u_i\rangle  } |&\leq\sum_{i\in I}| \langle x, u_i\rangle  |^2+| \langle y, u_i\rangle  |^2\\
                    &\leq \| x \|^2+\| y \|^2.
                \end{aligned}
            \end{equation}
            Nous en déduisons que la famille \( \langle x, u_i\rangle \overline{ \langle y, u_i\rangle  }\) est (commutativement) sommable en utilisant la proposition \ref{PropMpBStL}. Par ailleurs nous savons que
            \begin{subequations}
                \begin{align}
                    x=\sum_{i\in I}c_i(x)u_i\\
                    y=\sum_{i\in I}c_i(y)u_i,
                \end{align}
            \end{subequations}
           et le produit scalaire étant une forme bilinéaire continue,
           \begin{subequations}
               \begin{align}
                   \langle x, y\rangle &=\sum_{i\in I}\sum_{j\in I}\langle c_i(x)u_i, \overline{ c_j(y)u_j }\rangle \\
                   &=\sum_{i\in I}\sum_{j\in J}c_i(x)\overline{ c_j(y) }\delta_{ij}\\
                   &=\sum_{i\in I}c_i(x)\overline{ c_j(y) }.
               \end{align}
           \end{subequations}
       \item
            Nous utilisons l'égalité de Plancherel avec \( x=u_j\) :
            \begin{equation}
                \| u_j \|^2=\| u_j \|+\sum_{i\in I\setminus\{ j \}}| \langle u_j, u_i\rangle  |^2.
            \end{equation}
            Par conséquent \( \langle u_j, u_i\rangle =0\) dès que \( i\neq j\). Cela prouve que le système \( \{ u_i \}_{i\in I}\) est orthonormé.

            Nous devons encore prouver que le système est total. Pour cela nous repartons de l'équation \eqref{EqvwXWEA} que nous avions déduites dans la démonstration de l'inégalité de Bessel :
    \begin{equation}
        \| x-\sum_{j\in J}c_j(x)u_j \|=\| x \|^2-\sum_{j\in J}| c_j(x) |^2.
    \end{equation}
    Par hypothèse le membre de droite peut être rendu aussi petit que l'on veut en prenant \( J\) grand (mais fini) dans \( I\). Le membre de gauche indique alors que le système \( \{ u_i \}_{i\in I}\) est total.

\item
    L'identité de Plancherel signifie entre autres que si \( x\in \hH\) alors \( \sum_{i\in I}| \langle x, u_i\rangle  |^2\) converge. Du coup la suite \( (\langle x, u_i\rangle )_{i\in I}\) est dans \( \ell^2(I)\).
    \end{enumerate}
\end{proof}

    
\begin{remark}
    Nous avons décidé d'indexer les bases hilbertiennes par \( \eN\); cela est légitime parce que les sommes sont commutatives. Il ne faut cependant pas perdre de vue qu'en pratique l'ensemble naturel avec lequel on indexe une base est parfois \( \eZ\). Un tel cas est donné par la base trigonométrique de \( L^2\). Indexer cette dernière par \( \eN\) plutôt que par \( \eZ\) serait une contorsion inutile.
\end{remark}

\begin{remark}
    L'égalité de Parseval est la raison pour laquelle les physiciens écrivent souvent
    \begin{equation}
        \id=\sum_{n=1}^{\infty}|u_n\rangle\langle u_n|
    \end{equation}
    dans les livres de mécanique quantique par exemple. Dans \cite{SchomblondQEDQCD}, nous lisons même 
    \begin{equation}
        \int_{-\infty}^{+\infty}dq|q\rangle\langle q| =\hat I.
    \end{equation}
    Notons que ces personnes travaillent avec un espace de Hilbert dont la base n'est pas dénombrable. Pour dire que la physique, ça n'utilise pas des mathématiques pour rire !
\end{remark}

% TODO : cette remarque devrait être plus haut.
\begin{remark}
    Par définition une base orthonormée est donc une partie dénombrable dont l'espace vectoriel engendré est dense. Un espace de Hilbert possédant une base orthonormée est donc séparable. C'est ce fait qui nous pousse à ne considérer que des espaces de Hilbert séparables; nous n'allons donc pas étudier ce qu'il se passerait par exemple en considérant l'espace vectoriel librement engendré par les éléments de \( \eR\).
\end{remark}

\begin{corollary}
    Soit \( \hH\) un espace de Hilbert et \( (u_n)\) une base orthonormée. L'application
    \begin{equation}
        \begin{aligned}
            S\colon \hH&\to \ell^2 \\
            x&\mapsto \big( \langle x, u_n\rangle  \big)_{n\in \eN} 
        \end{aligned}
    \end{equation}
    est un isomorphisme d'espaces de Hilbert.

    De plus l'isomorphisme réciproque est
    \begin{equation}
        \begin{aligned}
            S^{-1}\colon \ell^2&\to \hH \\
            (\xi_n)&\mapsto \sum_{n=1}^{\infty}\xi_nu_n. 
        \end{aligned}
    \end{equation}
\end{corollary}

\begin{proof}
    Nous devons prouver que l'application est bijective et qu'elle vérifie
    \begin{equation}
        S(x)\cdot S(y)=\langle x, y\rangle 
    \end{equation}
    où le point dénote le produit dans \( \ell^2\).

    Pour la surjectivité, si \( (\xi_n)\in \ell^2\) alors nous savons que la somme \( \sum_n\xi_nu_n\) converge par la proposition \ref{PropzaKXHq} et par conséquent \( (\xi_n)\) est l'image par \( S\) de ce vecteur de \( \hH\).

    Pour l'injectivité, si \( S(x)=S(y)\) alors
    \begin{equation}
        x=\sum_n\langle x, u_n\rangle u_n=\sum_n\langle y, u_n\rangle u_n=y
    \end{equation}
    en utilisant la décomposition \eqref{EqPUPTXJ}.

    Le fait que \( S\) soit une isométrie est contenu dans Parseval.
\end{proof}

\begin{proposition}
    Tout espace de Hilbert séparable possède des bases orthonormées.
\end{proposition}

\begin{proof}
    Soit \( (v_n)_{n\in \eN}\) une partie totale et séparable. Quitte à supprimer les \( v_i\) qui sont combinaisons linéaires des précédents, nous pouvons supposer que cette partie est libre. Nous considérons l'espace vectoriel
    \begin{equation}
        F_n=\Span\{ v_1,\ldots, v_n \}.
    \end{equation}
    Sur \( F_n\) nous pouvons appliquer un procédé de Gram-Schmidt pour construire une base orthonormée \( \{ u_1,\ldots, u_n \}\) de \( F_n\) au sens usuel. En considérant \( F_{n+1}\) et en recommençant, les vecteurs \( u_1,\ldots, u_n\) ne changent pas, mais nous obtenons un vecteur \( u_{n+1}\).

    Nous construisons ainsi une suite \( (u_n)\) qui est alors orthonormée au sens des espaces de Hilbert. Nous devons encore prouver qu'il s'agit d'un ensemble total. Cela est simplement dû au fait que tout élément de \( \Span\{ v_n \}\) est contenu dans \( \Span\{ u_n \}\) parce que \( \Span\) ne considère que des combinaisons linéaires finies.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Digression sur les normes opérateurs}
%---------------------------------------------------------------------------------------------------------------------------
\label{subsecaeSywF}

Le théorème \ref{ThoyAjoqP} nous indique que si \( \{ u_i \}_{i\in I}\) est une base hilbertienne, alors pour tout \( x\in \hH\) nous avons
\begin{equation}
    \pr_{u_i}(x)=\langle x, u_i\rangle u_i,
\end{equation}
et donc
\begin{equation}
    \sum_{i\in I}\pr_{u_i}x=x.
\end{equation}
Nous ne pouvons cependant pas conclure que
\begin{equation}    \label{EqvKDzNl}
    \sum_{i\in I}\pr_{u_i}=\id
\end{equation}
au sens de la norme opérateur de la section \ref{SeckwyQjK}. En effet en prenant \( I=\eN\), l'égalité \eqref{EqvKDzNl} demanderait d'avoir
\begin{equation}
    \lim_{N\to \infty} \left\| \sum_{i=1}^N\pr_{u_i}-\id \right\|_{\infty}=0,
\end{equation}
or pour tout \( N\), le vecteur \( u_{N+1}\) réalise
\begin{equation}
    \sum_{i=1}^N\pr_{u_i}(u_{N+1})-u_{N+1}=-u_{N+1}.
\end{equation}
Par conséquent pour tout \( N\) nous avons
\begin{equation}
    \sup_{\| x \|=1}\left\| \sum_{i=1}^N\pr_{u_i}x-x \right\|\geq 1.
\end{equation}
Nous ne pouvons donc pas dire
\begin{equation}
    \sum_{n=1}^{\infty}\pr_{u_i}=\id
\end{equation}
au sens de la norme opérateur \eqref{EqThUCEJ}. 

Nous avons cependant la convergence au sens faible.
\begin{proposition}
    Soit \( \hH\) un espace de Hilbert et \( \{ u_i \}_{i\in \eN}\) une base hilbertienne de \( \hH\). Au sens de la topologie faible sur l'espace des opérateurs nous avons
    \begin{equation}
        \sum_{i=1}^{\infty}\pr_{u_i}=\id.
    \end{equation}
\end{proposition}

\begin{proof}
    Pour chaque \( N\in \eN\) et \( x\in\hH\), en vertu de la décomposition \eqref{EqPUPTXJ} nous avons
    \begin{equation}
        \sum_{i=1}^N\pr_{u_i}(x)-x=\sim_{i=N+1}^{\infty}\langle x, u_i\rangle u_i.
    \end{equation}
    Par l'orthonormalité de la base nous avons
    \begin{equation}
        \sum_{i=N+1}^{\infty}\| \langle x, u_i\rangle u_i \|=\sum_{i=N+1}^{\infty}| \langle x, u_i\rangle  |,
    \end{equation}
    dont la limite \( N\to \infty\) est zéro étant donné que la suite \( i\mapsto| \langle x, u_i\rangle  |\) est dans \( \ell^2(\eR)\) par le théorème \ref{ThoyAjoqP}.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de Kochen-Specker}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Le théorème suivant est \wikipedia{fr}{Variable_cachée}{central en mécanique quantique}. La démonstration provient de \cite{BainKochen} et de \wikipedia{en}{Kochen-Specker_theorem}{Wikipédia}. Nous allons démontrer complètement le théorème seulement pour les espaces de Hilbert de dimension plus grande ou égale à \( 4\).

\begin{theorem}[Kochen-Specker]
    Soit \( \hH\) un espace de Hilbert de dimension plus grande ou égale à \( 3\). Une fonction \( v\) sur l'ensemble des opérateurs de \( \hH\) ne peut pas satisfaire aux conditions suivantes :
    \begin{enumerate}
        \item
            Si \( A\) et \( B\) sont compatibles, alors \( v(A+B)=v(A)+v(B)\),
        \item
            Si \( A\) et \( B\) sont compatibles, alors \( v(AB)=v(A)v(B)\).
    \end{enumerate}
    Ici nous disons que deux opérateurs sont \defe{compatibles}{opérateurs!compatibles} lorsqu'ils possèdent une base hilbertienne commune de vecteurs propres.
\end{theorem}

\begin{proof}
    Soit \( \{ u_n \}_{n\in \eN}\) une base hilbertienne de \( \hH\). Nous notons \( \pr_i\) l'opérateur de projection sur l'espace (fermé) engendré par \( u_i\). Ce sont des opérateurs compatibles deux à deux parce que la base \( \{ u_n \}_{n\in \eN}\) est une base commune de vecteurs propres\footnote{Pour les besoins de la physique, nous remarquons que ces opérateurs sont des opérateurs hermitiens qui commutent, mais ça ne joue pas ici.}.

    D'abord nous devons avoir \( v(\mtu)=1\). En effet pour tout opérateur \( A\), nous avons
    \begin{equation}
        v(A)=v(A\mtu)=v(A)v(\mtu).
    \end{equation}
    Pour peu que \( v(A)\neq 0\), cela nous fait \( v(\mtu)=1\).

    En vertu du théorème \ref{ThoyAjoqP}, un vecteur \( x\in\hH\) se décompose en \( x=\sum_n\langle x, u_n\rangle u_n\), et nous avons
    \begin{equation}    \label{EqFFuXvq}
        \pr_ix=\langle x, u_i\rangle u_i.
    \end{equation}
    En effet le théorème de la projection orthogonale \ref{ThoMXwOjb} nous enseigne que \( \pr_ix\) serait l'unique vecteur de la forme \( \lambda u_i\) tel que \( \lambda u_i-x\perp u_i\). Il est facile de vérifier que le vecteur proposé par \eqref{EqFFuXvq} vérifie cette propriété.

    Une conséquence est que
    \begin{equation}
        \left( \sum_{i=0}^{\infty}\pr_i \right)(x)=x.
    \end{equation}
    Par conséquent, par hypothèse du théorème nous devons avoir
    \begin{equation}    \label{EqUeZHJH}
        \sum_iv(\pr_i)=v(\mtu)=1.
    \end{equation}
    Étant donné que les projections sont idempotentes,
    \begin{equation}
        v(\pr_i)=v(\pr_i^2)=v(\pr_i)^2
    \end{equation}
    et donc \( v(\pr_i)\) doit valoir zéro ou un. Mais la relation \eqref{EqUeZHJH} donne une forte contrainte sur le choix de \( 0\) et de \( 1\). En effet, parmi les \( v(\pr_i)\), un et un seul doit valoir \( 1\), les autres doivent valoir \( 0\).

    Refaisant le raisonnement pour une autre base orthonormale hilbertienne, nous trouvons que les valeurs de \( v\) sur les opérateurs de projection sur les différentes directions doivent être choisies de telle façon à ce que tout choix de base hilbertienne orthogonale contienne exactement un \( 1\) et les reste de zéros.

    Nous voudrions maintenant insister sur un point. Le problème de déterminer de façon cohérente les valeurs \( 0\) ou \( 1\) pour tous les \( v(\pr_i)\) revient à attacher \( 0\) ou \( 1\) à tous les \emph{rayons} de \( \hH\) de façon à ce que toute base orthogonale de \( \hH\) contienne exactement un \( 1\). Un rayon est une direction, c'est à dire une classe d'équivalence \( x\sim \lambda x\). Si nous décidons de nommer «blanc»  les rayons attachés à la valeur \( 0\) et «noirs»  ceux attachés à la valeur \( 1\), le problème se réduit à colorer la boule unité de façon compatible.

    Soit \( \{ u_i \}_{i\in \eN}\) une base orthogonale de \( \hH\) numérotée de telle sorte que \( v(u_0)=1\) et \( v(u_k)=0\) pour \( k\neq 0\). Nous allons maintenant nous particulariser au cas de dimension supérieure ou égale à \( 4\). Si \( R\) est une rotation dans le plan \( \Span\{ u_0,u_1,u_2,u_3 \}\), alors l'ensemble
    \begin{equation}
        \{ Ru_0,Ru_1,Ru_2,Ru_3,u_k \}_{k\geq 3}
    \end{equation}
    est encore une base orthogonale de \( \hH\) et nous avons encore \( v(u_k)=0\) pour \( k\geq 4\). Par conséquent un et un seul des vecteurs \( Ru_0\), \( Ru_1\), \( Ru_2\) ou \( Ru_3\) est colorié en noir; les trois autres étant blancs. Le problème est maintenant complètement réduit à la dimension \( 4\). Note : pour réduire à la dimension \( 3\), on procède de même, mais pour conclure, il faut travailler plus.

    Nous allons construire \( 9\) base orthogonales de \( \eR^4\) à partir de \( 18\) vecteurs, chacun arrivant dans exactement deux des bases. Ils sont donnés dans le tableau suivant\ :


    \begin{tabular}{c|c|c|c|c|c|c|c|c}
    $\begin{matrix}
        0    &   1    \\ 
        0    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   0    \\ 
        1    &   0
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   0    \\ 
        0    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
        1    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   -1    \\ 
        1    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   -1    \\ 
        -1    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        -1    &   1    \\ 
        1    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
        -1    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
        1    &   -1    
    \end{matrix}$\\
    \hline      
$\begin{matrix}
        0    &   0    \\ 
        0    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   1    \\ 
        0    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   0    \\ 
        1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   -1    \\ 
        1    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   -1    \\ 
        -1    &   1
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
        1    &   1
    \end{matrix}$
    &
    $\begin{matrix}
          1  &   1    \\ 
        1    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        -1    &   1    \\ 
        1    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
        -1    &   1    
    \end{matrix}$\\
    \hline     
$\begin{matrix}
        1    &   0    \\ 
        1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   0    \\ 
        0    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
         0   &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   0    \\ 
        -1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   1    \\ 
        0    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   0    \\ 
        0    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   0    \\ 
        0    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   0    \\ 
        1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   -1    \\ 
        0    &   0    
    \end{matrix}$\\
    \hline     
$\begin{matrix}
        1    &   0    \\ 
        -1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   0    \\ 
        0    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        1    &   -1    \\ 
        0    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   1    \\ 
        0    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   0    \\ 
        1    &   1    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   1    \\ 
       -1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   1    \\ 
        -1    &   0    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   1    \\ 
        0    &   -1    
    \end{matrix}$
    &
    $\begin{matrix}
        0    &   0    \\ 
        1    &   1    
    \end{matrix}$\\
    \hline     
    \end{tabular}

    Chaque case de ce table représente un rayon de \( \eR^4\); il y en a \( 18\) différents, chacun écris deux fois. Une simple vérification montre que chaque colonne est un système orthogonal. La preuve du théorème de Kochen-Specker revient à montrer que nous ne pouvons pas colorier ce tableau de façon cohérente. En effet, étant donné que chaque vecteur est écrit deux fois, le tableau doit contenir un nombre pair de cases blanches et un nombre pair de cases noires.

    Par ailleurs chaque colonne étant un système orthogonal, chaque colonne contient exactement une case noire; il y a donc exactement neuf cases noires dans le tableau, ce qui est impossible.

\end{proof}

% Tiens, tu lis mes sources ? Je croyais que personne ne lirait jamais ;)
% Bon, alors c'est que tu es un gars bien. Je vais te confier mon plan secret.
% Mon plan est que le théorème de Kochen-Specker et le Karmack's reverse deviennent
% des classiques de l'agreg. Ce sont certainement les deux meilleurs trucs 
% inconnus de niveau agreg.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Espaces de Bergman}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Source : \cite{ytMOpe}.

Soit \( \Omega\) un borné dans \( \eC\) et \( D\) le disque unité ouvert de \( \eC\).

\begin{definition}
    L'\defe{espace de Bergman}{espace!de Bergman}\index{Bergman (espace)} sur \( \Omega\), noté \( A^2(\Omega)\)\nomenclature[Y]{\( A^2(\Omega)\)}{espace de Bergman} est l'espace des fonctions holomorphes sur \( \Omega\) qui sont en même temps dans \( L^2(\Omega)\).
\end{definition}
Nous mettons sur \( A^2(\Omega)\) le produit scalaire usuel hérité de \( L^2\) :
\begin{equation}
    \langle f, g\rangle =\int_{\Omega}f(z)\overline{ g(z) }dz.
\end{equation}

\begin{lemma}   \label{LemIZxKfB}
    Soit \( K\subset \Omega\) un compact et \( f\in A^2(\Omega)\). Alors
    \begin{equation}
        \max_{z\in K}| f(z) |\leq \frac{1}{ \sqrt{\pi} }\frac{1}{ d(K,\partial \Omega) }\| f \|_2.
    \end{equation}
\end{lemma}

\begin{proof}
    Soient \( a\in \Omega\) et \( r>0\) tels que \( B(a,r)\subset\Omega\). Nous considérons aussi \( \rho\leq r\). La formule de Cauchy \eqref{EqPzUABM} nous donne   
    \begin{equation}
        f(a)=\frac{1}{ 2\pi i }\int_{B(a,\rho)}\frac{ f(\xi) }{ \xi-a }f\xi=\frac{1}{ 2\pi }\int_0^{2\pi}f(a+\rho e^{i\theta})d\theta
    \end{equation}
    où nous avons utilisé le chemin \( \gamma(\theta)=a+\rho e^{i\theta}\), \( \gamma'(\theta)=i\rho e^{i\theta}\) et \( \rho=| \xi-a |\). Maintenant une astuce est d'écrire
    \begin{equation}
        \frac{ r^2 }{2}f(a)=\int_0^rf(a)\rho d\rho,
    \end{equation}
    et d'y substituer la valeur de \( f(a)\) que nous venons de calculer :
    \begin{subequations}
        \begin{align}
            \frac{ r^2 }{2}f(a)&=\int_0^r\frac{1}{ 2\pi }\int_0^{2\pi}f(a+\rho e^{i\theta})d\theta\rho d\rho\\
            &=\frac{1}{ 2\pi }\int_{B(a,r)}f(z)dz   &   \text{passage aux polaires}\\
            &=\frac{1}{ 2\pi }\langle 1, f\rangle_B   &   \text{produit scalaire sur \( B(a,r)\)}\\
            &\leq\frac{1}{ 2\pi }\sqrt{\langle 1, 1\rangle_B\langle f, f\rangle_B }\\
        \end{align}
    \end{subequations}
    Nous avons donc
    \begin{equation}
        r^2f(a)\leq \frac{1}{ \pi }\sqrt{\langle 1, 1\rangle_B\langle f, f\rangle_B},
    \end{equation}
    et donc
    \begin{equation}
        \pi r^2 f(a)\leq \sqrt{\pi r^2}\| f \|_2,
    \end{equation}
    parce que \( \langle f, f\rangle_B\leq \| f \|_2^2\). En effet le produit scalaire \( \| . \|_2\) est donné par une intégrale sur \( \Omega\) alors que \( B(a,r)\subset \Omega\) et que la fonction qu'on y intègre est positive (c'est \( | f(z) |^2\)). En simplifiant,
    \begin{equation}
        f(a)\leq \frac{1}{ \sqrt{\pi}r }\| f \|_2.
    \end{equation}
    Mais \( r\) a été choisit pour avoir \( B(a,r)\subset\Omega\), donc \( r\leq d(a,\partial \Omega)\) et
    \begin{equation}
        | f(a) |\leq \frac{1}{ d(a,\partial\Omega)\sqrt{\pi} }\| f \|_2.
    \end{equation}
    
    Maintenant si nous prenons \( a\in K\), nous avons encore la minoration \( d(a,\partial K)\leq d(a,\partial \Omega)\) et donc
    \begin{equation}
        | f(a) |\leq\frac{1}{ d(a,\partial K)\sqrt{\pi} }\| f \|_2.
    \end{equation}

\end{proof}

\begin{theorem}
    Soit \( \Omega\) un ouvert de \( \eC\).
    \begin{enumerate}
        \item
            L'espace \( A^2(\Omega)\) est un espace de Hilbert.
        \item
            Si \( D\) est la boule unité dans \( \eC\), une base hilbertienne de \( A^2(D)\) est donnée par les fonctions
            \begin{equation}
                e_n(z)=\sqrt{\frac{ n+1 }{ \pi }}z^n
            \end{equation}
            pour \( n\geq 0\).
    \end{enumerate}
\end{theorem}

\begin{proof}
    Nous commençons par montrer que \( A^2(\Omega)\) est complet. Pour cela nous considérons une suite de Cauchy \( (f_n)\) dans \( A^2(\Omega)\) et un compact \( K\subset \Omega\). Nous savons par le lemme \ref{LemIZxKfB} que
    \begin{equation}
        \max_{z\in K}\big| f_n(z)-f_m(z) \big|\leq \frac{1}{ \sqrt{\pi}d(K,\partial\Omega) }\| f_n-f_m \|_2.
    \end{equation}
    Donc \( f_n\) converge uniformément sur \( K\). Par le théorème de Weierstrass \ref{ThoArYtQO}, la fonction \( f\) est holomorphe. Il existe donc une fonction holomorphe \( f\) qui est limite uniforme sur tout compact de \( \Omega\) de la suite \( (f_n)\).

    Mais \( L^2(\Omega)\) étant complet, la suite \( (f_n)\) a une limite \( g\in L^2(\Omega)\). Ce que nous voudrions faire est prouver que \( f=g\). Notons que tel quel, ce n'est pas vrai parce que \( f\) est une vraie fonction alors que \( g\) est une classe. Ce que nous enseigne la proposition \ref{PropWoywYG} est qu'il existe une sous-suite (qu'on note \( (g_n)\)) qui converge vers \( g\) presque partout. Dans cette dernière phrase, \( g_n\) et \( g\) sont de vraies fonctions, des représentants des classes dans \( L^2\).

    Nous déduisons que \( f=g\) presque partout (ici \( f\) et \( g\) sont les fonctions) parce que la sous-suite converge uniformément vers \( f\) en même temps que presque partout vers \( g\). Donc \( f=g\) dans \( L^2(\Omega)\) (ici \( f\) et \( g\) sont les classes). Donc \( f\in L^2(\Omega)\) et l'espace \( A^2(\Omega)\) est de Hilbert.

    Il nous faut encore prouver que \( (e_n)_{n\geq 0}\) est une base orthonormale. En ce qui concerne les produits scalaires,
    \begin{subequations}
        \begin{align}
            \langle e_m, e_n\rangle &=\sqrt{\frac{ (m+1)(n+1) }{ \pi }}\int_Dz^n\overline{ z^m }dz\\
            &=\sqrt{\frac{ (m+1)(n+1) }{ \pi^2 }}\int_0^1\rho\,d\rho\int_0^{2\pi}d\theta \rho^{m+n} e^{i\theta(n-m)}\\
            &=\sqrt{\frac{ (m+1)(n+1) }{ \pi^2 }}\frac{1}{ m+n+2 }\underbrace{\int_{0}^{2\pi} e^{i\theta(n-m)}d\theta}_{2\pi \delta_{mn}}\\
            &=\sqrt{\frac{ (n+1)^2 }{ \pi^2 }}\frac{1}{ 2n+2 }2\pi \delta_{nm}\\
            &=\delta_{nm}.
        \end{align}
    \end{subequations}
    Donc les fonctions données sont bien orthonormales. Nous devons montrer qu'elles sont denses dans \( A^2(D)\). Soit \( f\in A^2(D)\) et \( c_n(f)=\langle f, e_n\rangle \); nous allons montrer que
    \begin{equation}
        \| f \|_2^2=\sum_{n=0}^{\infty}| \langle f, e_n\rangle  |^2,
    \end{equation}
    parce que le point \ref{ItemQGwoIx} du théorème \ref{ThoyAjoqP} nous indique que ce sera suffisant pour avoir une base hilbertienne.

    Étant donné que \( f\) est holomorphe sur \( D\), le théorème \ref{ThoUHztQe} nous développe \( f\) en série entière :
    \begin{equation}    \label{EqObkbPK}
        f(z)=\sum_{k=0}^{\infty}a_kz^k.
    \end{equation}
    En permutant la somme avec le produit scalaire,
    \begin{equation}
        c_n(f)=\int_Df(z)\bar e_n(z)=\sqrt{\frac{ n+1 }{ \pi }}\int_Df(z)\bar z^ndz.
    \end{equation}
    Afin de profiter de la convergence uniforme de la série \eqref{EqObkbPK} à l'intérieur de \( D\), nous allons exprimer l'intégrale sur \( D\) comme une intégrale sur \( | z |<r\) en faisant tendre \( r\) vers \( 1\) (par le bas). Pour ce faire nous considérons les fonctions
    \begin{equation}
        g_k(z)=\begin{cases}
            f(z)\bar z^n    &   \text{si \( | z |<1-1/k\)}\\
            0    &    \text{sinon.}
        \end{cases}
    \end{equation}
    Ces fonctions sont intégrables sur \( D\) et dominées par \( f(z)\bar z^n\) qui est intégrable sans dépendre de \( k\). Mais nous avons évidemment \( g_k(z)\to f(z)\bar z^n\). Le théorème de la convergence dominée permet alors de permuter l'intégrale et la limite \( k\to \infty\). Cela nous permet d'écrire
    \begin{equation}
        c_n(f)=\sqrt{\frac{ n+1 }{ \pi }}\lim_{r\to 1^-}\int_{| z |<r}\bar z^nf(z)dz=\sqrt{\frac{ n+1 }{ \pi }}\lim_{r\to 1^-}\int_{| z |<r}\sum_{k=0}^{\infty}a_kz^k\bar z^n.
    \end{equation}
    Par la convergence uniforme de la série entière \emph{à l'intérieur} du disque \( D\) nous pouvons permuter l'intégrale et la somme (proposition \ref{PropfeFQWr}) :
    \begin{equation}
        c_n(f)=\sqrt{\frac{ n+1 }{ \pi }}\lim_{r\to 1^-}\sum_{k=0}^{\infty}a_k\int_{| z |<r}z^k\bar z^ndz.
    \end{equation}
    L'intégrale proprement dite est vite calculée et vaut
    \begin{equation}
        \int_{| z |<1}\bar z^nz^kdz=\frac{ \pi r^{2n+2} }{ n+1 }\delta_{kn}.
    \end{equation}
    Nous pouvons donc continuer le calcul de \( c_n(f)\) en effectuant la somme sur \( k\) qui se réduit à changer \( k\) en \( n\) puis en effectuant la limite :
    \begin{equation}
        c_n(f)=\sqrt{\frac{ n+1 }{ \pi }}\lim_{r\to 1^-}\sum_ka_k\frac{ \pi r^{2n+2} }{ n+1 }\delta_{kn}=\sqrt{\frac{ \pi }{ n+1 }}a_n.
    \end{equation}
    
    Nous effectuons le même genre de calculs pour évaluer \( \| f \|^2_2\) :
    \begin{subequations}
        \begin{align}
            \| f \|_2^2&=\int_D| f(z) |^2dz\\
            &=\lim_{r\to 1^-}\int_{| z |<r}f(z)\sum_{k=0}^{\infty}\bar a_k\bar z_kdz\\
            &=\lim_{r\to 1^-}\sum_{k=0}^{\infty}\bar a_k\int_{| z |<r}f(z)\bar z^kdz&\text{permuter \( \sum\) et \( \int\)}\\
            &=\lim_{r\to 1^-}\sum_{k=0}^{\infty}\bar a_ka_k\frac{ \pi r^{2k+2} }{ k+1 }&\text{intégrale déjà faite}.
        \end{align}
    \end{subequations}
    Mais nous savons déjà que \( c_n(f)=\sqrt{\pi/(n+1)}\), donc ce qui est dans la somme est \( \pi\bar a_ka_k/(n+1)=| c_k(f) |^2\). Nous avons donc
    \begin{equation}
        \| f \|^2_2=\lim_{r\to 1^-}\sum_{k=0}^{\infty}| c_k(f) |^2 r^{2k+2}.
    \end{equation}
    La fonction (de \( r\)) constante \( | c_k(f) |^2\) domine \( | c_k(f)r^{2k+2} |\) tout en ayant une somme (sur \( k\)) qui converge; en effet la proposition \ref{PropHKqVHj} nous indique que \( \sum_j| c_k(f) |^2\leq \| f \|_2^2\). Le théorème de la convergence dominée nous permet d'inverser la limite et la somme pour obtenir le résultat attendu :
    \begin{equation}
        \| f \|_2^2=\sum_{k=0}^{\infty}| c_k(f) |^2.
    \end{equation}
\end{proof}
