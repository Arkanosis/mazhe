% This is part of Mes notes de mathématique
% Copyright (c) 2011-2012
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Complétude}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{proposition}[Inégalité de Minkowski]     \label{PropInegMinkKUpRHg}
    Si \( 1\leq p<\infty\) et si \( f,g\in L^p(\Omega,\tribA,\mu)\) alors
    \begin{enumerate}
        \item
            \( \| f+g \|_p\leq \| f \|_p+\| g_p \|\)
        \item
            Il y a égalité si et seulement si les vecteurs \( f(x)\) et \( g(x)\) sont presque partout colinéaires : il existe \( \alpha,\beta\) tels que \( \alpha f+\beta g=0\) presque partout.
    \end{enumerate}
\end{proposition}

\begin{theorem}
    Pour \( 1\leq p<\infty\), l'espace \( L^p(\Omega,\tribA,\mu)\) est complet.
\end{theorem}

\begin{proof}
    Cette preuve provient de \cite{SuquetFourierProba}, disponible aussi sous forme d'application du \wikipedia{fr}{théorème_de_Riesz-Fischer}{théorème de Riesz-Fischer} sur wikipedia. 
    
    Soit \( (f_n)_{n\in\eN}\) une suite de Cauchy dans \( L^p\). Pour tout \( i\), il existe \( N_i\in\eN\) tel que $\| f_p-f_q \|_p\leq 2^{-i}$ pour tout \( p,q\geq N_i\). Nous considérons la sous suite \( g_i=f_{N_i}\), de telle sorte qu'en particulier
    \begin{equation}    \label{EqJLoDID}
        \|g_i-g_{i-1}\|_p\leq 2^{-i}.
    \end{equation}
    Pour chaque \( j\) nous considérons la somme télescopique
    \begin{equation}
        g_j=g_0+\sum_{i=1}^j(g_i-g_{i-1})
    \end{equation}
    et l'inégalité
    \begin{equation}
        | g_j |\leq | g_0 |+\sum_{i=1}^j| g_i-g_{i-1} |.
    \end{equation}
    Nous allons noter
    \begin{equation}        \label{EqSomPaFPQOWC}
        h_j=| g_0 |+\sum_{i=1}^j| g_i-g_{i-1} |.
    \end{equation}
    La suite de fonctions \( (h_j)\) ainsi définie est une suite croissante de fonctions positive qui converge donc (ponctuellement) vers une fonction \( h\) qui peut éventuellement valoir l'infini en certains points. Par continuité de la fonction \( x\mapsto x^p\) nous avons
    \begin{equation}
        \lim_{j\to \infty} h_j^p=h^p,
    \end{equation}
    puis par le théorème de la convergence monotone (théorème \ref{ThoConvMonFtBoVh}) nous avons
    \begin{equation}
        \lim_{j\to \infty} \int_{\Omega}h_j^pd\mu=\int_{\Omega}h^pd\mu.
    \end{equation}
    Utilisant à présent la continuité de la fonction \( x\mapsto x^{1/p}\) nous trouvons
    \begin{equation}
        \lim_{j\to \infty} \left( \int h_j^p \right)^{1/p}=\left( \int | h |^p \right)^{1/p}.
    \end{equation}
    Nous avons donc déjà montré que
    \begin{equation}
        \lim_{j\to \infty} \| h_j \|_p=\left( \int | h |^p \right)^{1/p}
    \end{equation}
    où, encore une fois, rien ne garantit à ce stade que l'intégrale à droite soit un nombre fini. En utilisant l'inégalité de Minkowski (proposition \ref{PropInegMinkKUpRHg}) et l'inégalité \eqref{EqJLoDID} nous trouvons
    \begin{equation}
        \|h_j\|_p\leq \|g_0\|_p+\sum_{i=1}^j\|g_i-g_{i-1}\|_p\leq \|g_0\|_p+1.
    \end{equation}
    En passant à la limite,
    \begin{equation}
        \left( \int| h |^p \right)^{1/p}=\lim_{j\to \infty}\|h_j\|_p \leq \|g_0\|_p+1<\infty.
    \end{equation}
    Par conséquent \( \int| h |^p\) est finie et
    \begin{equation}    \label{EqgLpdUPOBP}
        h\in L^p(\Omega,\tribA,\mu).
    \end{equation}
    En particulier, l'intégrale \( \int h\) est finie (parce que \( p\geq 1\)) et donc que \( h(x)<\infty\) pour presque tout \( x\in\Omega\).

    Nous savons que \( h(x)\) est la limite des sommes partielles \eqref{EqSomPaFPQOWC}, en particulier la série
    \begin{equation}
        \sum_{j=1}^{\infty}| g_i-g_{i-1} |
    \end{equation}
    converge ponctuellement. En vertu du corollaire \ref{CorCvAbsNormwEZdRc}, la série de terme général \( g_i-g_{i-1}\) converge ponctuellement. La suite \( g_i\) converge donc vers une fonction que nous notons \( g\). Par ailleurs la suite \( g_i\) est dominée par \( h\in L^p\), le théorème de la convergence dominée (théorème \ref{ThoConvDomLebVdhsTf}) implique que
    \begin{equation}
        \lim_{j\to \infty} \|g_j-g\|_p=0.
    \end{equation}
    Nous allons maintenant prouver que \( \lim_{n\to \infty\|f_n-g\|_p} =0\). Soit \( \epsilon>0\). Pour tout \( n\) et \( i\) nous avons
    \begin{equation}
        \|f_n-g\|_p=\|f_n-f_{N_i}+f_{N_i}-g\|_p\leq\|f_n-f_{N_i}\|_p+\|f_{N_i}-g\|_p.
    \end{equation}
    Pour rappel, \( f_{N_i}=g_i\). Si \(i\) et \( n\) sont suffisamment grands nous pouvons obtenir que chacun des deux termes est plus petit que \( \epsilon/2\).

    Il nous reste à prouver que \( g\in L^p(\Omega,\tribA,\mu)\). Nous avons déjà vu (équation \eqref{EqgLpdUPOBP}) que \( h\in L^p\), mais \( | g_i |\leq h^p\), par conséquent  \( g\in L^p\).

    Nous avons donc montré que la suite de Cauchy \( (f_n)\) converge vers une fonction de \( L^p\), ce qui signifie que \( L^p\) est complet.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{L'espace \texorpdfstring{$L^2$}{$L^2$}}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit \( (\Omega,\tribA,\mu)\) un espace mesuré. Nous considérons l'opération
\begin{equation}    \label{DefProdScalLubrgTj}
    \langle f, g\rangle =\int_{\Omega}f(\omega)g(\omega)d\mu(\omega)
\end{equation}
et la norme associée
\begin{equation}
    \| f \|_2=\sqrt{\langle f, f\rangle }.
\end{equation}
Nous considérons l'ensemble
\begin{equation}
    \mL^2(\Omega,\mu)=\{ f\colon \Omega\to \eR\tq \| f \|_2<\infty \}
\end{equation}
et la relation d'équivalence \( f\sim g\) si et seulement si \( f(x)=g(x)\) pour \( \mu\)-presque tout \( x\). L'espace que nous considérons est
\begin{equation}
    L^2=\mL^2/\sim.
\end{equation}

\begin{lemma}
    La formule \eqref{DefProdScalLubrgTj} définit un produit scalaire sur \( L^2\).
\end{lemma}

\begin{proof}
    Nous devons d'abord montrer que la formule passe au quotient. Pour cela, nous considérons des fonctions \( \alpha\) et \( \beta\) nulles presque partout et nous regardons le produit de \( f_1=f+\alpha\) par \( g_1=g+\beta\) :
    \begin{equation}
        \langle f_1, g_1\rangle =\int fg+\beta f+\alpha g+ \alpha\beta.
    \end{equation}
    Les fonction \( \beta f\), \( \alpha g\) et \( \alpha\beta\) étant nulles presque partout, leur intégrale est nulle et nous avons bien \( \langle f_1, g_1\rangle =\langle f,g \rangle \). Nous pouvons donc considérer le produit sur l'ensemble des classes.

    Pour vérifier que la formule est un produit scalaire, le seul point non évidement est de prouver que \( \langle f, f\rangle =0\) implique \( f=0\). Cela découle du fait que
    \begin{equation}
        \langle f, f\rangle =\int_{\Omega}| f |^2.
    \end{equation}
    La fonction \( x\mapsto | f(x) |^2\) vérifie les hypothèses du lemme \ref{Lemfobnwt}. Par conséquent \( | f(x) |^2\) est presque partout nulle.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Espaces de Hilbert}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{proposition}     \label{PropTdupIG}
    Si \( \hH\) est un espace de Hilbert réel, alors
    \begin{equation}
        \| x+y \|^2=\| x \|^2+\| y \|^2+2\langle x, y\rangle .
    \end{equation}
    Si \( \hH\) est un espace de Hilbert complexe alors
    \begin{equation}        \label{EqrbBlkK}
        \| x+y \|^2=\| x \|^2+\| y \|^2+2\Reel\langle x, y\rangle .
    \end{equation}
    Dans les deux cas nous avons l'inégalité de Cauchy-Schwarz\index{inégalité!Cauchy-Schwarz}\index{Cauchy-Schwarz} :
    \begin{equation}
        | \langle x, y\rangle  |\leq \| x \|\| y \|.
    \end{equation}
\end{proposition}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de la projection}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Sources : \cite{ProbCOndutetz} et \wikipedia{en}{Hilbert_projection_theorem}{théorème de projection} sur wikipédia.

\begin{theorem}[Projection sur partie fermée convexe]\index{théorème!projection!partie fermée convexe}
    \label{ThoProjOrthuzcYkz}
    Soit \( \hH\) un espace de Hilbert, et \( C\) un sous ensemble fermé convexe de \( \hH\). Pour chaque \( x\in \hH\), il existe un unique \( y\in C\) tel que
    \begin{enumerate}
        \item
            \( \| x-y \|=\inf\{ \| x-z \|\tq z\in C \}\),
        \item
            pour tout \( z\in C\), \( \langle x-y, z\rangle =0\).
    \end{enumerate}
\end{theorem}

\begin{proof}
    Nous nommons \( d\) l'infimum en question. 
    \begin{description}
        \item[Existence] 
    Soit \( (y_n)\) une suite dans \( C\) telle que 
    \begin{equation}
        \lim_{n\to \infty} \| x-y_n \|=\inf\{ \| x-y \|\tq z\in C \}=d.
    \end{equation}
    Nous allons montrer que cette suite peut être choisie de Cauchy. Elle convergera donc dans \( \hH\) parce que ce dernier est complet. Mais \( C\) étant supposé fermé dans \( \hH\), la limite appartiendra à \( C\). Soient \( r,s\in \eN\). D'abord nous avons
    \begin{subequations}
        \begin{align}
            \| y_r-y_r \|^2&=\langle y_r-y_s+x-x, y_r-y_s+x-x\rangle \\
            &=\| y_r-x \|^2+\| y_s-x \|^2-2\langle y_r-x, y_s-x\rangle .
        \end{align}
    \end{subequations}
    Ensuite,
    \begin{subequations}
        \begin{align}
            4\left\| \frac{ y_r+y_s }{2}-x \right\|^2&=\langle y_r+y_s-2x, y_r-y_s-2x\rangle \\
            &=\| y_r-x \|^2+\| y_s-x \|^2+2\langle y_r-x, y_s-x\rangle .
        \end{align}
    \end{subequations}
    Si nous égalisons les valeurs de \( 2\langle y_r-x, y_s-x\rangle \) nous trouvons
    \begin{equation}    \label{EqiqCyUa}
        \| y_r-y_s \|^2=-4\left\| \frac{ y_r+y_s }{2}-x \right\|^2+2\| y_r-x \|^2+2\| y_s-x \|^2.
    \end{equation}
    La distance infimum étant \( d\), nous pouvons choisir \( y_n\) de telle façon à avoir 
    \begin{equation}
        \| y_n-x \|\leq d+\frac{1}{ n }.
    \end{equation}
    D'autre part étant donné que \( C\) est convexe, \( (y_r+y_s)/2\) est dans \( C\) et nous avons
    \begin{equation}
        \left\| \frac{ y_r+y_s }{2}-x \right\| \leq d.
    \end{equation}
    En mettant ces majorations dans \eqref{EqiqCyUa} nous trouvons
    \begin{equation}
        \| y_r-y_s \|^2\leq -4d+2\left( d+\frac{1}{ r } \right)+2\left( d+\frac{1}{ s } \right)=\frac{1}{ r }+\frac{1}{ s }.
    \end{equation}
    La suite \( (y_n)\) est donc de Cauchy et la limite est un élément de \( C\). Prouvons que cet élément \( y\) réalise l'infimum. Pour cela nous avons les inégalités
    \begin{equation}
        d\leq \| x-y \|\leq\| x-y_n \|+\| y_n-y \|.
    \end{equation}
    En prenant le limite \( n\to\infty\) nous trouvons
    \begin{equation}
        d\leq \| x-y \|\leq d.
    \end{equation}
    
        \item[Unicité]
            Si \( y_1\) et \( y_2\) sont deux éléments de \( C\) qui minimisent la distance avec \( x\), nous avons
            \begin{equation}
                \| y_1-y_2 \|^2=-4\left\| \frac{ y_1+y_2j-x }{2} \right\|^2+2\| y_1-x \|^2+2\| y_2-x \|^2\leq -4d+2d+2d=0.
            \end{equation}
            Par conséquent \( y_1=y_2\).

    \end{description}
\end{proof}

\begin{lemma}       \label{LemGheBQz}
    Soit \( C\) une partie convexe et fermée de l'espace de Hilbert \( \hH\). Soit \( x\in \hH\). Un élément \( y\in C\) minimise la distance avec \( x\) si et seulement si
    \begin{equation}        \label{EqQCKubx}
        \Reel\langle x-y,z-y, \rangle \leq 0
    \end{equation}
    pour tout \( z\in C\).
\end{lemma}

\begin{proof}
    Considérons d'abord \( y=\pr_C(x)\). Par convexité de \( C\), si \( z\in C\) nous avons \( (1-t)y+tz\in C\) et par conséquent
    \begin{equation}
        \| x-(1-t)y-tz \|^2\geq \| x-y \|^2.
    \end{equation}
    Si nous développons complètement les deux membres de cette expression en utilisant la formule \eqref{EqrbBlkK} nous tombons sur
    \begin{equation}
        (-2t+t^2)\| y \|^2+2t\Reel\langle x, y\rangle +t^2\| y \|^2-2t\Reel\langle x, z\rangle +2t(1-t)\Reel\langle y, z\rangle \geq 0.
    \end{equation}
    En divisant par \( t\) et en faisant \( t\to 0\) nous trouvons le résultat \( \Reel\langle z-y, x-y\rangle \leq 0\).

    Réciproquement si \( y\) vérifie la relation \eqref{EqQCKubx} alors nous avons pour chaque \( z\in C\) 
    \begin{subequations}
        \begin{align}
            \| x-y \|^2&=\| (x-y)+(y-z) \|^2\\
            &=\| x-y \|^2+\| y-z \|^2+2\Reel\langle x-y,y-z \rangle \\
            \geq&\| x-y \|^2.
        \end{align}
    \end{subequations}
\end{proof}

\begin{proposition}     \label{PropAXJpCe}
    Soit \( C\) une partie convexe et fermée de l'espace de Hilbert \( \hH\). Alors pour tout \( x_1,x_2\in\hH\) nous avons
    \begin{equation}
        \| \pr_C(x_1)-\pr_C(x_2) \|\leq \| x_1-x_2 \|.
    \end{equation}
    En particulier la projection est une application continue.
\end{proposition}

\begin{proof}
    Nous posons \( y_1=\pr_C(x_1)\) et \( y_2=\pr_C(x_2)\). Par le lemme \ref{LemGheBQz} nous avons, pour tout \( z,z'\in C\) les inégalités
    \begin{subequations}
        \begin{align}
            \Reel\langle x_1-y_1, z-y_1\rangle \leq 0\\
            \Reel\langle x_2-y_2, z'-y_2\rangle \leq 0.
        \end{align}
    \end{subequations}
    En prenant \( z=y_2\) et \( z'=y_1\) et en sommant nous trouvons
    \begin{equation}
        \Reel\langle (x_1-y_1)+(y_2-x_2), y_2-y_1\rangle \leq 0.
    \end{equation}
    Nous pouvons maintenant calculer
    \begin{equation}
        \begin{aligned}[]
            \| y_1-y_2 \|^2&=\Reel\| y_1-y_2 \|\\
            &=\Reel\langle y_1-y_2, (y_1-x_1)+x_1-x_2+(x_2-y_2)\rangle \\
            &=\Reel\langle y_1-y_2, x_1-x_2\rangle +\Reel\langle y_2-y_1, (x_1-y_1)+(y_2-x_2)\rangle \\
            &\leq\langle y_1-y_2, x_1-x_2\rangle \\
            &\leq\big\| \langle y_1-y_2, x_1-x_2\rangle  \big\|\\
            &=\leq \| y_1-y_2 \|\| x_1-x_2 \|.
        \end{aligned}
    \end{equation}
    En simplifiant par \( \| y_1-y_2 \|\)\footnote{Si c'est nul, alors la preuve est évidente.} nous trouvons le résultat
    \begin{equation}
        \| y_1-y_2 \|\leq \| x_1-x_2 \|.
    \end{equation}
\end{proof}

\begin{theorem}[Projection orthogonale]\index{projection!orthogonale}   \index{théorème!projection!cas vectoriel}
    Soit \( K\) un sous espace vectoriel fermé non réduit à \( \{ 0 \}\) et \( x\in\hH\). L'élément \( \pr_K(x)\) est l'unique élément de \( K\) tel que
    \begin{equation}
        x-y\in K^{\perp}.
    \end{equation}
    De plus l'application \( x\mapsto\pr_K(x)\) est linéaire, continue et de norme \( 1\).
\end{theorem}

    L'élément \( y\) ainsi définit est la \defe{projection orthogonale}{projection!orthogonale} de \( x\) sur \( K\) et sera noté \( \pr_K(f)\).\nomenclature[Y]{\( \pr_K(x)\)}{projection orthogonale de \( x\) sur \( y\)}

\begin{proof}

    La continuité de la projection est donné par la proposition \ref{PropAXJpCe}.

            Soit \( z\) un élément de \( K\) tel que \( \langle z-x, a\rangle =0\) pour tout \( a\in K\). Nous avons
            \begin{subequations}
                \begin{align}
                    \| x-a \|^2&=\| z-x \|^2+\| a-z \|^2+2\underbrace{\langle z-x, a-z\rangle}_{=0}\\
                    &\geq \| z-x \|^2.
                \end{align}
            \end{subequations}
            Le produit scalaire est nul parce que \( a-z\in K\). La distance \( \| z-x \|\) est donc bien la plus petite distance entre \( x\) et les éléments de \( K\).

            Dans l'autre sens, nous supposons que \( y\in K\) minimise la distance à \( x\) dans \( K\). Par hypothèse pour tout \( a\) et pour tout \( \lambda\in \eR\), la différence
            \begin{equation}
                \| (y+\lambda a)-x \|^2-\| y-x \|^2
            \end{equation}
            est positive. En développant les produits scalaires nous trouvons la conditions suivante
            \begin{equation}
                \lambda^2\| a \|^2+2\lambda\langle a, y-x\rangle \geq 0
            \end{equation}
            qui doit être vraie pour tout \( \lambda\in\eR\). En tant que polynôme du second degré en \( \lambda\), cela n'aura pas deux racines réelles distinctes uniquement si \( \langle a, y-x\rangle =0\).
    
            Nous montrons maintenant la linéarité de la projection orthogonale. Soient \( x_1,x_2\in\hH\). L'élément \( y=\pr_Kx_1+\pr_Kx_2\) satisfait à la condition d'orthogonalité : pour tout \( z\in K\),
    \begin{equation}
        \langle x_1+x_2-\pr_Kx_1-\pr_Kx_2, z\rangle =\langle x_1-\pr_Kx_1, z\rangle +\langle x_2-\pr_Kx_2, z\rangle =0.
    \end{equation}
    Étant donné que \( K\) est un sous espace vectoriel, la condition de minimalité est automatiquement vérifiée (seconde partie du théorème \ref{ThoProjOrthuzcYkz}).

    En ce qui concerne la norme opérateur de \( \pr_K\), la décomposition de \( x\in\hH\) en composantes dans \( K\) et \( K^{\perp}\) est
    \begin{equation}
        x=x+(x-\pr_Kx).
    \end{equation}
    Étant deux parties orthogonales nous avons
    \begin{equation}
        \| \pr_Kx \|^2=\| x \|^2-\| x-\pr_Kx \|^2.
    \end{equation}
    En prenant \( \| x \|=1\) nous trouvons \( \| \pr_Kx \|^2\leq 1\) et par conséquent \( \| \pr_K \|\leq 1\). Mais d'autre part en prenant \( x\in K\) nous avons automatiquement \( \| \pr_K \|\geq 1\).
\end{proof}

\begin{proposition}
    Soit \( \hH=L^2(\Omega,\tribA,\mu)\), \( \tribF\) une sous tribu de \( \tribA\) et \( K\) l'ensemble de fonctions \( \tribF\)-mesurables dans \( L^2(\Omega,\tribA,\mu)\). Si \( f\in L^2(\Omega,\tribA,\mu)\) est positive, alors \( \pr_Kf\) est positive (presque partout).
\end{proposition}

\begin{proof}
    L'ensemble \( A=\{ \pr_Kf<0 \}\) est dans \( \tribF\). En effet 
    \begin{equation}
        A=(\pr_Kf)^{-1}\big( \mathopen] -\infty , 0 \mathclose[\big)
    \end{equation}
    alors que, par construction, \( \pr_Kf\) est \( \tribF\)-mesurable. La conséquent la fonction indicatrice \( \mtu_A\) est \( \tribF\)-mesurable (c'est à dire \( 1_A\in K\)) et nous avons
    \begin{equation}
        0\leq\int_{\Omega}f\mtu_A=\int_{\Omega}\pr_Kf\mtu_A\leq 0.
    \end{equation}
    Étant donné que nous avons supposé \( f\geq 0\) nous avons alors \( \mu(A)=0\). D'où le fait que \( \pr_Kf\) est presque partout positive.
\end{proof}


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Systèmes orthogonaux et bases}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Sources : \cite{HilbertLi}. Dans cette partie nous noterons \( \eK\) le corps de base de l'espace \( \hH\). Seuls deux cas sont envisagés : \( \eK=\eC\) ou \( \eK=\eR\).

Pour chaque \( x\in\hH\) nous considérons l'application
\begin{equation}
    \begin{aligned}
        \Phi_x\colon \hH&\to \eK \\
        y&\mapsto \langle x, y\rangle . 
    \end{aligned}
\end{equation}

\begin{lemma}       \label{LemjYVcHE}
    L'application \( y\mapsto\Phi_y\) est une isométrie : nous avons \( \| \Phi_y \|=\| y \|\).
\end{lemma}

\begin{proof}
    En utilisant la définition de la norme opérateur et l'inégalité de Cauchy-Schwarz,
    \begin{equation}
        \| \Phi_y \|=\sup_{\| x \| =1}\| \Phi_y(x) \|=\sup| \langle x, y\rangle  |\leq\sup\| x \|\| y \|=\| y \|.
    \end{equation}
    Par conséquent \( \| \Phi_y \|\leq\| y \|\). Mais d'autre part le fait que \( \Phi_y(y)=\| y \|^2\) montre que \( \| \Phi_y \|\geq \| y \|\).
\end{proof}


%---------------------------------------------------------------------------------------------------------------------------
\subsection{Orthogonalité}
%---------------------------------------------------------------------------------------------------------------------------


\begin{definition}
    Un espace vectoriel muni d'un produit scalaire est une espace \defe{préhilbertien}{préhilbertien}. Si il est complet pour la norme induite par le produit scalaire alors il est de \defe{Hilbert}{Hilbert}.
\end{definition}

Si \( A\) est une partie de \( \hH\) alors nous notons\nomenclature[Y]{\( A^{\perp}\)}{orthogonal d'une partie}
\begin{equation}
    A^{\perp}=\{ y\in\hH\tq y\perp c\forall x\in A \}.
\end{equation}
cet ensemble est l'\defe{orthogonal}{orthogonal} de \( A\).

\begin{proposition}     \label{PropdpaMpH}
    L'ensemble \( A^{\perp}\) est un sous espace fermé de \( \hH\).
\end{proposition}

\begin{proof}
    Par définition l'application \( \Phi_x\) est continue pour chaque \( x\in\hH\) et par conséquent l'ensemble \( \ker\Phi_x=\Phi_x^{-1}(\{ 0 \})\) est fermé. L'ensemble
    \begin{equation}
        A^{\perp}=\bigcap_{x\in A}\ker\Phi_x
    \end{equation}
    est donc fermé.    
\end{proof}

L'énoncé suivant provient de \wikipedia{fr}{Supplémentaire_topologique}{wikipédia}.
\begin{proposition}     \label{PropKZDqTR}
    Soit \( V\) un espace vectoriel normé et une décomposition en somme directe \( V=F\oplus G\). Alors les trois conditions suivantes sont équivalentes.
    \begin{enumerate}
        \item
            L'isomorphisme naturel \( F\times G\to v\) est un homéomorphisme.
        \item
            \( F\) et \( G\) sont fermés et la restriction à \( G\) de la projection \( V\to V/F\) est un homéomorphisme.
        \item
            \( F\) et \( G\) sont fermés et la projection de \( E\) sur \( F\) est continue.
    \end{enumerate}
\end{proposition}
Lorsqu'une décomposition en somme directe vérifie la proposition \ref{PropKZDqTR}, nous disons que la décomposition est \defe{topologique}{topologique!somme directe}.

\begin{theorem}     \label{ThowZyaiz}
    Soit \( \hH\) un espace de Hilbert et \( F\) un sous espace fermé de \( \hH\). Alors
    \begin{enumerate}
        \item
            Nous avons la décomposition
            \begin{equation}        \label{EqxXIvrG}
                \hH=F\oplus F^{\perp}.
            \end{equation}
        \item
            La projection sur \( F\) par rapport à la somme directe \eqref{EqxXIvrG} est la projection \( \pr_F\) du théorème de projection.
        \item
            La décomposition \eqref{EqxXIvrG} est topologique.
    \end{enumerate}
\end{theorem}

\begin{proposition}
    Si \( F\) est un sous espace de l'espace de Hilbert \( \hH\) alors on a \( F^{\perp\perp}=\bar F\).
\end{proposition}

\begin{proof}
    Nous savons par la proposition \ref{PropdpaMpH} que \( F^{\perp}\) est fermé, par conséquent le théorème \ref{ThowZyaiz} donne la somme directe
    \begin{equation}
        \hH=F^{\perp}\oplus F^{\perp\perp}.
    \end{equation}
    Mais \( \bar F\) étant également fermé nous avons la somme directe
    \begin{equation}
        \hH=\bar F\oplus(\bar F)^{\perp}.
    \end{equation}
    Montrons que \( (\bar F)^{\perp}=F^{\perp}\). En effet si \( x\in F^{\perp}\) et si \( y\in \bar F\), alors il existe une suite \( y_n\) dans \( F\) qui converge vers \( y\). Pour chaque \( n\) nous avons \( \langle x, y_n\rangle =0\) et dons \( \langle x, y\rangle =0\) par continuité du produit scalaire.

    Nous avons donc
    \begin{equation}
        \hH=F^{\perp}\oplus F^{\perp\perp}=\bar F\oplus F^{\perp}.
    \end{equation}
    Mais \( \bar F\subset F^{\perp\perp}\) (prendre une suite). Les espaces \( \bar F\) et \( F^{\perp\perp}\) étant tous deux des supplémentaires de \( F^{\perp}\), nous déduisons qu'ils doivent être égaux.
\end{proof}

\begin{proposition}     \label{PropqiWonByiBmc}
    Soit \( \hH\) un espace de Hilbert et \( F\) un sous espace vectoriel de \( \hH\). Alors \( F\) est dense si et seulement si \( F^{\perp}=\{ 0 \}\).
\end{proposition}

\begin{proof}
    Nous savons que
    \begin{equation}
        \hH=F^{\perp}\oplus \bar F.
    \end{equation}
    Donc nous avons \( H=\bar F\) si et seulement si \( F^{\perp}=\{ 0 \}\).
\end{proof}
Pour vérifier si un sous espace vectoriel d'un espace de Hilbert est dense, il suffit donc de montrer que son orthogonal est réduit à zéro.

\begin{lemma}[Théorème fondamental d'approximation \cite{TribuLi}]      \label{LempTBaUw}
    Soit \( \Omega\) un espace mesurable et \( f\colon \Omega\to \mathopen[ 0 , \infty \mathclose]\) une application mesurable. Alors il existe une suite croissante d'applications étagées \( \varphi_n\colon \Omega\to \eR^+\) dont la limite est \( f\).

    De plus si \( f\) est bornée, la convergence est uniforme.
\end{lemma}

\begin{theorem}[\cite{HilbertLi}]       \label{ThoJsBKir}
    Soit \( I\) un intervalle de \( \eR\). L'espace \( C_c(I)\)\nomenclature[Y]{\( C_c(I)\)}{fonctions continues à support compact dans \( I\)} des fonctions continues à support compact sur \( I\) est dense dans \( L^2(I)\).
\end{theorem}

\begin{proof}
    Soit \( g\in L^2(I)\) une fonction telle que \( g\perp f\) pour toute fonction \( f\in C_c(I)\). Nous avons donc
    \begin{equation}
        \langle f, g\rangle =\int_If\bar g=0.
    \end{equation}
    En passant éventuellement aux composantes réelles et imaginaires nous pouvons supposer que les fonctions sont toutes réelles. Nous décomposons \( g\) en parties positives et négatives : \( g=g^+-g^-\). Notre but est de montrer que \( g^+=g^-\), c'est à dire que \( g\) est nulle. La proposition \ref{PropqiWonByiBmc} conclura que \( C_c(I)\) est dense dans \( L^2(I)\).

    Soit un intervalle \( \mathopen[ a , b \mathclose]\subset I\) et une suite croissante de fonctions \( f_n\in C_c(I)\) convergent vers \( \mtu_{\mathopen[ a , b \mathclose]}\). Par hypothèse pour chaque \( n\) nous avons
    \begin{equation}
        \int_If_ng^+=\int_I f_ng^-.
    \end{equation}
    La suite étant croissante, le théorème de la convergence monotone (théorème \ref{ThoConvMonFtBoVh}) s'applique et nous avons
    \begin{equation}
        \lim_{n\to \infty} \int_I f_ng^+=\int_a^bg^+,
    \end{equation}
    de telle sorte que nous ayons, pour tout intervalle \( \mathopen[ a , b \mathclose]\subset I\) l'égalité
    \begin{equation}        \label{EqYlErAM}
        \int_a^bg^+=\int_a^bg^-.
    \end{equation}
    De plus ces intégrales sont finies parce que
    \begin{equation}
        \int_a^b g^+\leq\int_a^b| g |=\int_I| g |\mtu_{\mathopen[ a , b \mathclose]}=\langle | g |, \mtu_{\mathopen[ a , b \mathclose]}\rangle \leq \| g \|_{L^2}\sqrt{b-a}<\infty
    \end{equation}
    par l'inégalité de Cauchy-Schwarz.

    Soit maintenant un ensemble mesurable \( A\subset I\). La fonction caractéristique \( \mtu_A\) est mesurable et il existe une suite croissante de fonctions étagées \( (\varphi_n)\) convergente vers \( a\) par le lemme \ref{LempTBaUw}. À multiples près, les fonctions \( \varphi_n\) sont des sommes de fonctions caractéristiques du type \( \mtu_{\mathopen[ a , b \mathclose]}\), par conséquent, en vertu de \eqref{EqYlErAM} nous avons
    \begin{equation}
        \int_I\varphi_ng^+=\int_I\varphi_ng^-.
    \end{equation}
    Une fois de plus nous pouvons utiliser le théorème de la convergence monotone et obtenir
    \begin{equation}
        \int_Ag^+=\int_A g^-
    \end{equation}
    pour tout ensemble mesurable \( A\subset I\). Si nous notons \( dx\) la mesure de Lebesgue, les mesures \( g^+dx\) et \( g^-dx\) sont par conséquent égales et dominées par \( dx\). Par le corollaire \ref{CorZDkhwS} du théorème de Radon Nikodym, les fonctions \( g^+\) et \( g^-\) sont égales.
\end{proof}
 
%---------------------------------------------------------------------------------------------------------------------------
\subsection{Dual}
%---------------------------------------------------------------------------------------------------------------------------

Le \defe{dual}{dual} de l'espace de Hilbert \( \hH\) est l'ensemble\nomenclature[Y]{\( \hH^*\)}{dual}
\begin{equation}
    H^*=\{ \Phi\colon \hH\to \eK\text{ linéaire et continue} \}.
\end{equation}
Notons que dans le contexte des espaces linéaires nous demandons la continuité des éléments du dual parce qu'elle n'est pas automatique par la linéarité dans les cas de dimensions infinies.

\begin{theorem}[Fréchet-Riesz]\index{théorème!Fréchet-Riesz}        \label{ThoQgTovL}
    L'application
    \begin{equation}
        \begin{aligned}
            J\colon \hH&\to \hH^* \\
            y&\mapsto \Phi_y 
        \end{aligned}
    \end{equation}
    est une bijection isométrique.
\end{theorem}

\begin{proof}
    Nous savons du lemme \ref{LemjYVcHE} que \(J\) est une isométrique. Nous devons seulement montrer que \( J\) est surjective. Soit \( \Phi\in \hH^*\). Par continuité nous savons que \( F=\ker\Phi\) est fermé, donc
    \begin{equation}
        \hH=\ker\Phi\oplus(\ker\Phi)^{\perp}
    \end{equation}
    par le théorème \ref{ThowZyaiz}. Nous considérons une base de \( H\) adaptée à cette décomposition, c'est à dire
    \begin{itemize}
        \item \( (u_s)_{s\in S}\) une base de \( \ker\Phi\),
        \item
            \( (v_t)_{t\in T}\) une base de \( (\ker\Phi)^{\perp}\).
    \end{itemize}
    Il se fait que \( T\) se réduit à un seul élément parce que si \( v\in (\ker\Phi)^{\perp}\), alors \( \Phi(v)\neq 0\), et par conséquent \( \{ \Phi(v) \}\) est déjà une base de \( \Image\Phi=\eK\). Le théorème du rang (théorème \ref{ThoGkkffA}) assure alors que
    \begin{equation}
        \{ v \}\cup\{ u_s \}_{s\in S}
    \end{equation}
    est une base de \( \hH\) avec \( v\in(\ker\Phi)^{\perp}\) et \( u_s\in \ker\Phi\). Nous choisissons \( v\) pour avoir \( \| v \|=1\).

    Nous pouvons maintenant prouver l'existence de \( y\) tel que \( \Phi_y=\Phi\). En effet si nous posons \( y=\overline{ \Phi(v) }v\) nous avons \( \Phi_y=\Phi\), en effet
    \begin{subequations}
        \begin{align}
            \Phi_y(v)=\langle v, y\rangle =\Phi(v)\langle v, v\rangle =\Phi(v)\\
            \Phi_y(u_s)=\langle u_s, y\rangle =0.
        \end{align}
    \end{subequations}
    Par conséquent \( \Phi_y\) et \( \Phi\) coïncident sur une base de \( \hH\).

    En ce qui concerne l'unicité, d'abord si \( \Phi_y=\Phi\) alors nous devons avoir \( y\in(\ker\Phi)^{\perp}\) et par conséquent \( y=\lambda v\) pour un certain \( \lambda\in \eK\). Nous avons alors
    \begin{equation}
        \Phi_y(v)=\bar\lambda\langle v, v\rangle =\bar\lambda.
    \end{equation}
    Pour que cela soit égal à \( \Phi(v)\), nous fixons \( \lambda=\overline{ \Phi(v) }\).
    
\end{proof}
Notons que nous avons réellement utilisé le théorème du rang pour l'unicité. Si nous ne demandions pas l'unicité, alors nous n'avions pas besoin du fait que \( \dim(\ker\Phi)^{\perp}=1\), et nous aurons donc pu parler de formes plus générales à valeurs dans \( \eK^n\).

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Séparabilité}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
    Un espace topologique est \defe{séparable}{séparable} si il possède une partie dénombrable dense.

    Si \( E\) est un espace vectoriel normé nous disons que \( \Delta\) est une partie \defe{totale}{totale}\index{partie!totale} de \( E\) si \( \Span\Delta\) est dense dans \( E\).
\end{definition}

\begin{proposition}
    Un espace vectoriel normé est séparable si et seulement si il possède une partie totale dénombrable.
\end{proposition}

\begin{proof}
    Si \( \Delta\) est une partie dénombrable de \( E\), alors le \( \eQ\)-espace vectoriel \( \Span_{\eQ}\Delta\) est dénombrable, et sa fermeture est la même que celle de \( \Span_{\eK}\Delta\).
\end{proof}

\begin{definition}
    Une famille \( (u_i)_{i\in I}\) d'éléments de \( \hH\) indicée par un ensemble quelconque \( I\) est un \defe{système orthonormé}{orthonormé!système}\index{système orthonormé} si
    \begin{enumerate}
        \item
            \( \| u_i \|=1\) pour tout \( i\in I\),
        \item
            \( u_i\perp u_j\) pour tout \( i\neq j\).
    \end{enumerate}
\end{definition}

\begin{example}
    Dans l'ensemble \( L^2(a,b)\) avec \( b-a=L\) l'ensemble des fonctions
    \begin{equation}        \label{EqxNXguH}
        e_n(t)=\frac{1}{ \sqrt{b-a} }\exp(\frac{ 2\pi }{ L }int)
    \end{equation}
    avec \( n\in \eZ\) forme un système orthonormé. En effet
    \begin{equation}
        \langle e_n, e_n\rangle =\frac{1}{ b-a }\int_a^b\exp(\frac{ 2\pi }{ L }int)\exp(-\frac{ 2\pi }{ L }int)=1
    \end{equation}
    et
    \begin{equation}
        \langle e_n, e_m\rangle =\frac{1}{ b-a }\int_a^b e^{\frac{ 2\pi }{ L }(n-m)t}dt=0.
    \end{equation}
    Dans cette intégrale nous utilisons le fait que \( b=a+(b-a)\) pour simplifier les expressions en cours de calcul.

    La famille \eqref{EqxNXguH} est le \defe{système trigonométrique}{système!trigonométrique} de \( L^2(a,b)\).
\end{example}

\begin{proposition}
    Un système orthonormé est libre.
\end{proposition}

\begin{proof}
    Soit \( (u_i)_{i\in I}\) un système orthonormé de \( \hH\) et une combinaison linéaire \emph{finie} nulle :
    \begin{equation}
        \sum_{k=1}^{n}a_ku_k=0.
    \end{equation}
    Nous développons la somme en utilisant les formules de la proposition \ref{PropTdupIG} :
    \begin{equation}
        0=\| \sum_ka_ku_k \|^2=\sum_k| a_k |^2\| u_k \|^2+2\sum_{k<l}\langle a_ku_k, a_lu_l\rangle .
    \end{equation}
    Le système étant orthonormé, les choses se simplifient en
    \begin{equation}
        \sum_k| a_k |^2=0,
    \end{equation}
    ce qui signifie que \( a_k=0\) pour tout \( k\).
\end{proof}

Avant de continuer nous devons définir comment nous calculons des sommes sur des ensembles quelconques. Si \( I\) est un ensemble et si pour chaque \( i\in I\) nous avons un nombre réel positif \( a_i\), alors nous définissons
\begin{equation}
    \sum_{i\in I}a_i=\sup_{\substack{J\subset I\\\text{ \( J\) fini }}}\sum_{j\in J} a_j.
\end{equation}

\begin{proposition}[Inégalités de Bessel]\index{Bessel!inégalités}\index{Inégalités!Bessel}
    Soit \( \hH\) un préhilbert. Si \( (u_i)_{i\in I}\) est un système orthonormé et si \( x\in \hH\), alors
    \begin{equation}
        \sum_{i\in I}\big| \langle x, u_i\rangle  \big|^2\leq \| x \|^2.
    \end{equation}
\end{proposition}

\begin{proof}
    Posons \( \xi_i=\langle x, u_i\rangle \). Pour toute partie finie \( J\subset I\) nous avons
    \begin{equation}
        0\leq \big\| x-\sum_{j\in J}\xi_ju_j \big\|^2=\| x \|^2-2\Reel\sum_{j}\langle x, \xi_ju_j\rangle +\sum_j| \xi_j |^2.
    \end{equation}
    Mais en tenant compte du fait que 
    \begin{equation}
        \langle x, \xi_ju_j\rangle =\bar \xi_j\langle x, u_j\rangle =| \xi_j |^2,
    \end{equation}
    des choses se simplifient et nous restons avec
    \begin{equation}
        \sum_{j\in J}| \xi_j |^2\leq \| x \|^2.
    \end{equation}
    Ayant cette inégalité pour toute partie finie de \( I\), nous l'avons encore pour le supremum.
\end{proof}

Dans la suite les systèmes orthonormés dénombrables vont jouer un rôle important. Nous allons conventionnellement les indicer par \( \eN\).
\begin{proposition}
    Soit \( \hH\) un préhilbert et un système orthonormé dénombrable \( (u_n)_{n\in \eN}\). Si 
    \begin{equation}        \label{EqitrzXi}
        x=\sum_{n=1}^{\infty}\xi_nu_n,
    \end{equation}
    alors \( \xi_n=\langle x, u_n\rangle \).
\end{proposition}

\begin{proof}
    Nous appliquons \( \Phi_{u_k}\) à l'équation \eqref{EqitrzXi}. Étant donné que le produit scalaire est continu, nous pouvons permuter avec la somme infinie et obtenir
    \begin{equation}
        \langle x, u_k\rangle =\sum_{n=0}^{\infty}\langle u_n, u_k\rangle =\xi_k.
    \end{equation}
\end{proof}
<++>

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de Kochen-Specker}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Le théorème suivant\cite{BainKochen} est \wikipedia{en}{Kochen-Specker_theorem}{central en mécanique quantique}.
\begin{theorem}[Kochen-Specker]
   Soit \( \hH\) un espace de Hilbert de dimension plus grande ou égale à trois. Soit \( \mA\) une famille d'opérateurs hermitiens sur \( \hH\). Une fonction réelle sur \( \mA\) ne peut pas satisfaire les deux propriétés suivantes en même temps
    \begin{enumerate}
        \item
            \( f(A+B)=f(A)+f(B)\)
        \item
            \( f(AB)=f(A)f(B)\)
    \end{enumerate}
    pour tout opérateurs \( A,B\in\mA\) possédants une base commune de vecteurs propres.
\end{theorem}

%TODO : la preuve. Il faudra élucider des points comme le fait que si H est un Hilbert séparable, alors il a
%       une base dénombrable.


