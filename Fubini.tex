% This is part of Mes notes de mathématique
% Copyright (c) 2011-2012
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de Fubini}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{theorem}[Fubini-Tonelli]\index{Funibi-Tonelli}\index{théorème!Fubini-Tonelli}
    Soient \( (\Omega_i,\tribA_i,\mu_i)\) des espaces mesurés $\sigma$-finis. Si
    \begin{equation}
        f\colon \Omega_1\times\Omega_2\to \mathopen[ 0 , \infty \mathclose]
    \end{equation}
    est mesurable pour \( \mu_1\otimes \mu_2\), alors
    \begin{enumerate}
        \item
            Les fonctions
            \begin{subequations}
                \begin{align}
                    x&\mapsto\int_{\Omega_2}f(x,y)d\mu_2(y)\\
                    y&\mapsto\int_{\Omega_2}f(x,y)d\mu_1(x)
                \end{align}
            \end{subequations}
            sont mesurables
        \item
            Nous avons la formule pratique
            \begin{equation}
                \int_{\Omega_1\times\Omega_2}fd(\mu_1\otimes\mu_2)=\int_{\Omega_1}\left( \int_{\Omega_2}f(x,y)d\mu_2(y) \right)d\mu_1(x)
                =\int_{\Omega_2}\left( \int_{\Omega_1}f(x,y)d\mu_1(x) \right)d\mu_2(y).
            \end{equation}
    \end{enumerate}
\end{theorem}

\begin{theorem}     \label{ThoFubinioYLtPI}
    Soient \( \mu_i\) des mesures \( \sigma\)-finies sur les espaces mesurables \( (\Omega_i,\tribA_i)\) ($i=1,2$). Nous considérons une fonction \( f\colon \Omega_1\otimes\Omega_2\to \eR,\eC\) qui soit mesurable pour la tribu \( \tribA_1\otimes \tribA_2\) et intégrable pour la mesure \( \mu_1\otimes \mu_2\). Alors
    \begin{enumerate}
        \item
            La fonction \( x\mapsto f(x,y)\) est \( \mu_1\)-intégrable pour presque tout \( y\) (par rapport à \( \mu_2\)).
        \item
            La fonction
            \begin{equation}
                y\mapsto\int_{\Omega_1}f(x,y)d\mu_1(x)
            \end{equation}
            est \( \mu_2\)-intégrable. 
        \item
            Nous avons la formule de Fubini
            \begin{equation}
                \int_{\Omega_1\times\Omega_2}fd(\mu_1\otimes\mu_2)=\int_{\Omega_2}\left( \int_{\Omega_1}f(x,y)d\mu_1(x)\right)d\mu_2(y).
            \end{equation}
    \end{enumerate}
\end{theorem}

\begin{example}
    Nous montrons que le théorème ne tient pas si une des deux mesures n'est pas \( \sigma\)-finie. Soit \( I=\mathopen[ 0 , 1 \mathclose]\). Nous considérons l'espace mesuré
    \begin{equation}
        (I,\Borelien(I),\lambda)
    \end{equation}
    où \( \Borelien(I)\) est la tribu des boréliens sur \( I\) et \( \lambda\) est la mesure de Lebesgue (qui est $\sigma$-finie). D'autre part nous considérons l'espace mesuré
    \begin{equation}
        (I,\partP(I),m)
    \end{equation}
    où \( \partP(I)\) est l'ensemble des parties de \( I\) et \( m\) est la mesure de comptage. Cette dernière n'est pas $\sigma$-finie parce que les seuls ensembles de mesure finie pour la mesure de comptage sont des ensembles finis, or une union dénombrable d'ensemble finis ne peut pas recouvrir l'intervalle \( I\).

    Nous allons montrer que dans ce cadre, l'intégrale de la fonction indicatrice de la diagonale sur \( I^2\) ne vérifie pas le théorème de Fubini. Étant donné que \( \Borelien(I)\subset\partP(I)\) nous avons
    \begin{equation}
        \Borelien(I^2)\subset\Borelien(I)\otimes\partP(I).
    \end{equation}
    Soit \( \Delta=\{ (x,x)\tq x\in I \}\). La fonction
    \begin{equation}
        \begin{aligned}
            g\colon I^2&\to \eR \\
            (x,y)&\mapsto x-y 
        \end{aligned}
    \end{equation}
    est continue et \( \Delta=g^{-1}(\{ 0 \})\) est donc fermé dans \( I^2\). L'ensemble \( \Delta\) est donc un borélien de \( I^2\) et par conséquent un élément de la tribu \( \Borelien(I)\otimes\partP(I)\). La fonction indicatrice \( \mtu_{\Delta}\) est alors mesurable pour l'espace mesuré
    \begin{equation}
        (I\times I,\Borelien(I)\otimes\partP(I),\lambda\otimes m).
    \end{equation}
    Pour \( x\) fixé nous avons
    \begin{equation}
        \mtu_{\Delta}(x,y)=\begin{cases}
            1    &   \text{si \( y= x\)}\\
            1    &    \text{si \( y\neq x\)}
        \end{cases}=\mtu_{\{ x \}}(y),
    \end{equation}
    et donc
    \begin{subequations}
        \begin{align}
            A_1&=\int_I\left( \int_I\mtu_{\Delta}(x,y)dm(y) \right)d\lambda(x)\\
            &=\int_I\left( \int_I\mtu_{\{ x \}}(y)dm(y) \right)d\lambda(x)\\
            &=\int_I\Big( m(\{ x \}) \Big)d\lambda(x)\\
            &=\int_I 1d\lambda(x)\\
            &=1.
        \end{align}
    \end{subequations}
    Par contre le support de \( \mtu_{\Delta}\) étant de mesure nulle pour la mesure de Lebesgue, nous avons
    \begin{equation}
        \int_I\mtu_{\Delta}(x,y)d\lambda(x)=0
    \end{equation}
    et par conséquent
    \begin{equation}
        A_2=\int_I\left( \int_I\mtu_{\Delta}(x,y)d\lambda(x) \right)dm(y)=0.
    \end{equation}
    Nous voyons donc que le théorème de Fubini ne s'applique pas.
\end{example}

L'énoncé suivant est le théorème de Fubini pour les fonctions réelles.
\begin{theorem}[Théorème de Fubini]     \label{ThoTKZKwP}
    Soit \( \phi\colon \eR^2\to \eR\) une fonction borélienne sur \( \eR^2\). Alors
    \begin{enumerate}
        \item
            Pour tout \( x\in \eR\), la fonction \( y\mapsto \phi(x,y)\) est borélienne et pour tout \( y\in \eR\), la fonction \( x\mapsto \phi(x,y)\) est également borélienne.
        \item
            les fonctions
            \begin{equation}
                \begin{aligned}[]
                    x\mapsto\int_{\eR}| \phi(x,y) |&&\text{et}&&y\mapsto\int_{\eR}| \phi(x,y) |
                \end{aligned}
            \end{equation}
            sont boréliennes en tant que fonctions \( \eR\to \mathopen[ 0 , \infty \mathclose]\).
    \end{enumerate}
    
    De plus, si nous avons
    \begin{equation}
        \int_{\eR}\left( \int_{\eR}| \phi(x,y) |dy \right)dx<\infty
    \end{equation}
    ou
    \begin{equation}
        \int_{\eR}\left( \int_{\eR}| \phi(x,y) |dx \right)dy<\infty
    \end{equation}
    alors \( \phi\in L^1(\eR^2)\), les fonctions
    \begin{equation}
        \begin{aligned}[]
            x\mapsto\int_{\eR}\phi(x,y)dy&&\text{et}&&y\mapsto\int_{\eR}\phi(x,y)dx
        \end{aligned}
    \end{equation}
    définissent des éléments de \( L^1(\eR)\). De plus nous avons la formule
    \begin{equation}
        \int_{\eR}\left( \int_{\eR}\phi(x,y)dy \right)dx=\int_{\eR}\left( \int_{\eR}\phi(x,y)dx \right)dy=\iint_{\eR^2}\phi(x,y)dxdy.
    \end{equation}
\end{theorem}

\begin{example}
    Le théorème de Fubini est utilisé dans le calcul de l'intégrale gaussienne
    \begin{equation}
        G=\int_{\eR} e^{-x^2}dx.
    \end{equation}
    Par symétrie nous pouvons nous contenter de calculer
    \begin{equation}
        G_+=\int_0^{\infty} e^{-x^2}dx.
    \end{equation}
    L'astuce est de passer par l'intermédiaire
    \begin{subequations}
        \begin{align}
            H&=\int_{\eR^+\times\eR^+} e^{-(x^2+y^2)}dxdy       \label{EqIntFausasub}\\
            &=\int_{\eR^+}\left( \int_{\eR^+} e^{-x^2} e^{-y^2}dx \right)dy\\
            &=\left( \int_I e^{-x^2} dx\right)^2\\
            &=G_+^2
        \end{align}
    \end{subequations}
    L'intégrale \eqref{EqIntFausasub} se calcule en passant aux coordonnées polaires et le résultat est \( H=\frac{ \pi }{ 4 }\). Nous avons alors \( G=\frac{ \sqrt{\pi} }{ 2 }\) et
    \begin{equation}
        \int_{\eR} e^{-x^2}=\sqrt{\pi}.
    \end{equation}
\end{example}

\begin{example} \label{ExempInversSumIntFub}
    Le théorème de Fubini-Tonelli nous permet également d'inverser des sommes et des séries. En effet une somme n'est rien d'autre qu'une intégrale pour la mesure de comptage :
    \begin{equation}
        \sum_{n=0}^{\infty}a_n=\int_{\eN}a_ndm(n).
    \end{equation}
    Considérons une suite de fonctions \( f_n\colon \eR^d\to \eR\) \emph{positives}, la quantité
    \begin{equation}    \label{EqAcalculParFubIntSum}
        I=\sum_{n=0}^{\infty}\int_{\eR^n}f_n(x)dx
    \end{equation}
    et les espaces mesurés \( (\eN,\partP(\eN),m)\), \( (\eR^n,\Borelien(\eR^n),\lambda)\) où \( \lambda\) est la mesure de Lebesgue. En écrivant la formule \eqref{EqAcalculParFubIntSum}, nous supposons que pour chaque \( n\), la fonction \( f_n\) est intégrable sur \( \eR^d\) et que le résultat soit sommable. Nous pouvons la récrire sous la forme
    \begin{equation}
        \int_{\eN}\left( \int_{\eR^n}f(n,x)dx \right)dm(n)
    \end{equation}
    avec la notation évidente \( f(n,x)=f_n(x)\). Prouvons que la fonction \( f\colon \eN\times\eR^d\to \eR\) ainsi définie est une fonction mesurable pour l'espace mesuré
    \begin{equation}
        \big( \eN\times\eR^d,\partP(\eN)\otimes\Borelien(\eR^d),m\otimes\lambda \big).
    \end{equation}
    Si \( A\subset\eR\), nous avons
    \begin{equation}
        f^{-1}(A)=\bigcup_{n\in\eN}\{ n \}\times f_n^{-1}(A).
    \end{equation}
    Chacun des ensembles dans l'union appartient à la tribu \( \partP(\eN)\times\Borelien(\eR^d)\) tandis que les tribus sont stables sous les unions dénombrables. La fonction \( f\) est donc mesurable. La fonction \( f\) est donc mesurable. Comme nous avons supposé que \( f\) était positive, le théorème de Fubini-Tonelli s'applique et nous avons
    \begin{equation}
        I=\int_{\eR^d}\left( \int_{\eN}f(n,x)dm(n) \right)dx=\int_{\eR^d}\sum_{n\in \eN}f_n(x)dx.
    \end{equation}
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Convolution}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Le théorème qui permet de définir le produit de convolution est la suivant.

\begin{theorem}[\cite{MesIntProbb}]
    Soient \( f,g\in L^1(\eR^n)\). 
    \begin{enumerate}
        \item
            Pour presque tout \( x\in \eR^n\), la fonction
            \begin{equation}
                y\mapsto g(x-y)f(y)
            \end{equation}
            est dans \( L^1(\eR^n)\), et nous définissons le \defe{produit de convolution}{produit!de convolution} de \( f\) et \( g\) par
            \begin{equation}
                (f*g)(x)=\int_{\eR^n} f(y)g(x-y)dy.
            \end{equation}
        \item
            \( f*g\in L^1(\eR^n)\).
        \item
            \( \| f*g \|_1\leq \| f \|_1\| g \|_1\).
    \end{enumerate}
\end{theorem}

L'ensemble \( L^1(\eR^n)\) devient alors une algèbre de Banach.

\begin{lemma}
    Le produit de convolution est commutatif : \( f*g=g*f\).
\end{lemma}

\begin{proof}
    Le théorème de Fubini (théorème \ref{ThoFubinioYLtPI}) permet d'écrire
    \begin{equation}
        (f*g)(x)=\int_{\eR^n}f(y)g(x-y)dy=\int_{-\infty}^{\infty}dy_1\ldots \int_{-\infty}^{\infty}dy_nf(y)g(x-y).
    \end{equation}
    En effectuant le changement de variable \( z_i=x_i-y_i\) dans chacune des intégrales nous obtenons
    \begin{equation}
        (f*g)(x)=\int_{\eR^end}g(z)f(x-z)dz=(g*f)(x).
    \end{equation}
\end{proof}
